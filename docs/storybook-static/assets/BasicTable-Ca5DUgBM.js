import{i,x as x$1}from"./lit-element-C4bBeaiV.js";import{g as getDefaultExportFromCjs}from"./_commonjsHelpers-CqkleIqs.js";import{t,E as ExtendedLitElement}from"./element-BmCHZ0P_.js";import{n}from"./property-BacG-Vag.js";import{S as STORYBOOK}from"./constants-rkZZCW-e.js";function commonjsRequire(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var dist={exports:{}},jsuites$1={exports:{}},jsuites=jsuites$1.exports,hasRequiredJsuites;function requireJsuites(){return hasRequiredJsuites||(hasRequiredJsuites=1,function(r,c){(function(f,p){r.exports=p()})(jsuites,function(){var f;return function(){var p={195:function(j){(function(d,h){j.exports=h()})(this,function(){return function(Ue){function h(Ie,De){this.highOrder=Ie,this.lowOrder=De}var F=[new h(1779033703,4089235720),new h(3144134277,2227873595),new h(1013904242,4271175723),new h(2773480762,1595750129),new h(1359893119,2917565137),new h(2600822924,725511199),new h(528734635,4215389547),new h(1541459225,327033209)],V=[new h(1116352408,3609767458),new h(1899447441,602891725),new h(3049323471,3964484399),new h(3921009573,2173295548),new h(961987163,4081628472),new h(1508970993,3053834265),new h(2453635748,2937671579),new h(2870763221,3664609560),new h(3624381080,2734883394),new h(310598401,1164996542),new h(607225278,1323610764),new h(1426881987,3590304994),new h(1925078388,4068182383),new h(2162078206,991336113),new h(2614888103,633803317),new h(3248222580,3479774868),new h(3835390401,2666613458),new h(4022224774,944711139),new h(264347078,2341262773),new h(604807628,2007800933),new h(770255983,1495990901),new h(1249150122,1856431235),new h(1555081692,3175218132),new h(1996064986,2198950837),new h(2554220882,3999719339),new h(2821834349,766784016),new h(2952996808,2566594879),new h(3210313671,3203337956),new h(3336571891,1034457026),new h(3584528711,2466948901),new h(113926993,3758326383),new h(338241895,168717936),new h(666307205,1188179964),new h(773529912,1546045734),new h(1294757372,1522805485),new h(1396182291,2643833823),new h(1695183700,2343527390),new h(1986661051,1014477480),new h(2177026350,1206759142),new h(2456956037,344077627),new h(2730485921,1290863460),new h(2820302411,3158454273),new h(3259730800,3505952657),new h(3345764771,106217008),new h(3516065817,3606008344),new h(3600352804,1432725776),new h(4094571909,1467031594),new h(275423344,851169720),new h(430227734,3100823752),new h(506948616,1363258195),new h(659060556,3750685593),new h(883997877,3785050280),new h(958139571,3318307427),new h(1322822218,3812723403),new h(1537002063,2003034995),new h(1747873779,3602036899),new h(1955562222,1575990012),new h(2024104815,1125592928),new h(2227730452,2716904306),new h(2361852424,442776044),new h(2428436474,593698344),new h(2756734187,3733110249),new h(3204031479,2999351573),new h(3329325298,3815920427),new h(3391569614,3928383900),new h(3515267271,566280711),new h(3940187606,3454069534),new h(4118630271,4000239992),new h(116418474,1914138554),new h(174292421,2731055270),new h(289380356,3203993006),new h(460393269,320620315),new h(685471733,587496836),new h(852142971,1086792851),new h(1017036298,365543100),new h(1126000580,2618297676),new h(1288033470,3409855158),new h(1501505948,4234509866),new h(1607167915,987167468),new h(1816402316,1246189591)],m=new Array(64),l,v,w,b,A,T,S,P,_,I,H,K,U=8;function ue(Ie){return unescape(encodeURIComponent(Ie))}function je(Ie){for(var De=[],Pe=(1<<U)-1,qe=Ie.length*U,et=0;et<qe;et+=U)De[et>>5]|=(Ie.charCodeAt(et/U)&Pe)<<32-U-et%32;return De}function ce(Ie){for(var De="0123456789abcdef",Pe="",qe=Ie.length*4,et,rt=0;rt<qe;rt+=1)et=Ie[rt>>2]>>(3-rt%4)*8,Pe+=De.charAt(et>>4&15)+De.charAt(et&15);return Pe}function ye(Ie,De){var Pe,qe,et,rt;return Pe=(Ie.lowOrder&65535)+(De.lowOrder&65535),qe=(Ie.lowOrder>>>16)+(De.lowOrder>>>16)+(Pe>>>16),et=(qe&65535)<<16|Pe&65535,Pe=(Ie.highOrder&65535)+(De.highOrder&65535)+(qe>>>16),qe=(Ie.highOrder>>>16)+(De.highOrder>>>16)+(Pe>>>16),rt=(qe&65535)<<16|Pe&65535,new h(rt,et)}function Me(Ie,De,Pe,qe){var et,rt,at,pt;return et=(Ie.lowOrder&65535)+(De.lowOrder&65535)+(Pe.lowOrder&65535)+(qe.lowOrder&65535),rt=(Ie.lowOrder>>>16)+(De.lowOrder>>>16)+(Pe.lowOrder>>>16)+(qe.lowOrder>>>16)+(et>>>16),at=(rt&65535)<<16|et&65535,et=(Ie.highOrder&65535)+(De.highOrder&65535)+(Pe.highOrder&65535)+(qe.highOrder&65535)+(rt>>>16),rt=(Ie.highOrder>>>16)+(De.highOrder>>>16)+(Pe.highOrder>>>16)+(qe.highOrder>>>16)+(et>>>16),pt=(rt&65535)<<16|et&65535,new h(pt,at)}function xe(Ie,De,Pe,qe,et){var rt,at,pt,mt;return rt=(Ie.lowOrder&65535)+(De.lowOrder&65535)+(Pe.lowOrder&65535)+(qe.lowOrder&65535)+(et.lowOrder&65535),at=(Ie.lowOrder>>>16)+(De.lowOrder>>>16)+(Pe.lowOrder>>>16)+(qe.lowOrder>>>16)+(et.lowOrder>>>16)+(rt>>>16),pt=(at&65535)<<16|rt&65535,rt=(Ie.highOrder&65535)+(De.highOrder&65535)+(Pe.highOrder&65535)+(qe.highOrder&65535)+(et.highOrder&65535)+(at>>>16),at=(Ie.highOrder>>>16)+(De.highOrder>>>16)+(Pe.highOrder>>>16)+(qe.highOrder>>>16)+(et.highOrder>>>16)+(rt>>>16),mt=(at&65535)<<16|rt&65535,new h(mt,pt)}function le(Ie,De,Pe){return new h(Ie.highOrder&De.highOrder^Ie.highOrder&Pe.highOrder^De.highOrder&Pe.highOrder,Ie.lowOrder&De.lowOrder^Ie.lowOrder&Pe.lowOrder^De.lowOrder&Pe.lowOrder)}function ze(Ie,De,Pe){return new h(Ie.highOrder&De.highOrder^~Ie.highOrder&Pe.highOrder,Ie.lowOrder&De.lowOrder^~Ie.lowOrder&Pe.lowOrder)}function We(Ie,De){return De<=32?new h(Ie.highOrder>>>De|Ie.lowOrder<<32-De,Ie.lowOrder>>>De|Ie.highOrder<<32-De):new h(Ie.lowOrder>>>De|Ie.highOrder<<32-De,Ie.highOrder>>>De|Ie.lowOrder<<32-De)}function Ye(Ie){var De=We(Ie,28),Pe=We(Ie,34),qe=We(Ie,39);return new h(De.highOrder^Pe.highOrder^qe.highOrder,De.lowOrder^Pe.lowOrder^qe.lowOrder)}function Be(Ie){var De=We(Ie,14),Pe=We(Ie,18),qe=We(Ie,41);return new h(De.highOrder^Pe.highOrder^qe.highOrder,De.lowOrder^Pe.lowOrder^qe.lowOrder)}function dt(Ie){var De=We(Ie,1),Pe=We(Ie,8),qe=Ne(Ie,7);return new h(De.highOrder^Pe.highOrder^qe.highOrder,De.lowOrder^Pe.lowOrder^qe.lowOrder)}function W(Ie){var De=We(Ie,19),Pe=We(Ie,61),qe=Ne(Ie,6);return new h(De.highOrder^Pe.highOrder^qe.highOrder,De.lowOrder^Pe.lowOrder^qe.lowOrder)}function Ne(Ie,De){return De<=32?new h(Ie.highOrder>>>De,Ie.lowOrder>>>De|Ie.highOrder<<32-De):new h(0,Ie.highOrder<<32-De)}var Ue=ue(Ue),jt=Ue.length*U;Ue=je(Ue),Ue[jt>>5]|=128<<24-jt%32,Ue[(jt+128>>10<<5)+31]=jt;for(var _=0;_<Ue.length;_+=32){l=F[0],v=F[1],w=F[2],b=F[3],A=F[4],T=F[5],S=F[6],P=F[7];for(var I=0;I<80;I++)I<16?m[I]=new h(Ue[I*2+_],Ue[I*2+_+1]):m[I]=Me(W(m[I-2]),m[I-7],dt(m[I-15]),m[I-16]),H=xe(P,Be(A),ze(A,T,S),V[I],m[I]),K=ye(Ye(l),le(l,v,w)),P=S,S=T,T=A,A=ye(b,H),b=w,w=v,v=l,l=ye(H,K);F[0]=ye(l,F[0]),F[1]=ye(v,F[1]),F[2]=ye(w,F[2]),F[3]=ye(b,F[3]),F[4]=ye(A,F[4]),F[5]=ye(T,F[5]),F[6]=ye(S,F[6]),F[7]=ye(P,F[7])}for(var ot=[],_=0;_<F.length;_++)ot.push(F[_].highOrder),ot.push(F[_].lowOrder);return ce(ot)}})}},L={};function R(j){var d=L[j];if(d!==void 0)return d.exports;var h=L[j]={exports:{}};return p[j].call(h.exports,h,h.exports,R),h.exports}(function(){R.n=function(j){var d=j&&j.__esModule?function(){return j.default}:function(){return j};return R.d(d,{a:d}),d}})(),function(){R.d=function(j,d){for(var h in d)R.o(d,h)&&!R.o(j,h)&&Object.defineProperty(j,h,{enumerable:!0,get:d[h]})}}(),function(){R.o=function(j,d){return Object.prototype.hasOwnProperty.call(j,d)}}();var X={};(function(){R.d(X,{default:function(){return St}});var j=function(E){document.dictionary||(document.dictionary={});var M=null,u=Object.keys(E);for(M=0;M<u.length;M++)document.dictionary[u[M]]=E[u[M]]},d=function(E){return typeof document<"u"&&document.dictionary&&document.dictionary[E]||E},h={setDictionary:j,translate:d},V=function(E,M){if(M===!0)window.jSuitesStateControl=window.jSuitesStateControl.filter(function(a){return a!==null}),setTimeout(function(){window.jSuitesStateControl.push(E)},0);else{var u=window.jSuitesStateControl.indexOf(E);u>=0&&window.jSuitesStateControl.splice(u,1)}},m={};m.two=function(E){return E=""+E,E.length==1&&(E="0"+E),E},m.focus=function(E){if(E.innerText.length){var M=document.createRange(),u=window.getSelection(),a=E.childNodes[E.childNodes.length-1];M.setStart(a,a.length),M.collapse(!0),u.removeAllRanges(),u.addRange(M),E.scrollLeft=E.scrollWidth}},m.isNumeric=function(E){return typeof E=="string"&&(E=E.trim()),!isNaN(E)&&E!==null&&E!==""},m.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(E){var M=Math.random()*16|0,u=E=="x"?M:M&3|8;return u.toString(16)})},m.getNode=function(){var E=document.getSelection().anchorNode;return E?E.nodeType==3?E.parentNode:E:null},m.hash=function(E){var M=0,u,a;if(E.length===0)return M;for(u=0;u<E.length;u++)a=E.charCodeAt(u),a>32&&(M=(M<<5)-M+a,M|=0);return M},m.randomColor=function(E){var M=-.25,u=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");u.length<6&&(u=u[0]+u[0]+u[1]+u[1]+u[2]+u[2]);var a=[],z,ne;for(ne=0;ne<3;ne++)z=parseInt(u.substr(ne*2,2),16),z=Math.round(Math.min(Math.max(0,z+z*M),255)).toString(16),a.push(("00"+z).substr(z.length));return E==!0?"#"+m.two(a[0].toString(16))+m.two(a[1].toString(16))+m.two(a[2].toString(16)):a},m.getWindowWidth=function(){var E=window,M=document,u=M.documentElement,a=M.getElementsByTagName("body")[0],z=E.innerWidth||u.clientWidth||a.clientWidth;return z},m.getWindowHeight=function(){var E=window,M=document,u=M.documentElement,a=M.getElementsByTagName("body")[0],z=E.innerHeight||u.clientHeight||a.clientHeight;return z},m.getPosition=function(E){if(E.changedTouches&&E.changedTouches[0])var M=E.changedTouches[0].pageX,u=E.changedTouches[0].pageY;else var M=window.Event?E.pageX:E.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),u=window.Event?E.pageY:E.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[M,u]},m.click=function(E){if(E.click)E.click();else{var M=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});E.dispatchEvent(M)}},m.findElement=function(E,M){var u=!1;function a(z){z&&!u&&(typeof M=="function"?u=M(z):typeof M=="string"&&z.classList&&z.classList.contains(M)&&(u=z)),z.parentNode&&!u&&a(z.parentNode)}return a(E),u};var l=m;function v(E,M,u){if(E=E.split("."),E.length){let a=this,z=null;for(;E.length>1;)if(z=E.shift(),a.hasOwnProperty(z))a=a[z];else{if(typeof M>"u")return;a[z]={},a=a[z]}if(z=E.shift(),typeof M<"u")return u===!0?delete a[z]:a[z]=M,!0;if(a)return a[z]}return!1}function w(E,M){var u={};u.options={};var a={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},z=null;for(var ne in a)M&&M.hasOwnProperty(ne)?u.options[ne]=M[ne]:u.options[ne]=a[ne];E.classList.add("jsorting"),E.addEventListener("dragstart",function(N){let Y=N.target;if(Y.nodeType===3)if(Y.parentNode.getAttribute("draggable")==="true")Y=Y.parentNode;else{N.preventDefault(),N.stopPropagation();return}if(Y.getAttribute("draggable")==="true"){let J=Array.prototype.indexOf.call(Y.parentNode.children,Y);z={element:Y,o:J,d:J},Y.style.opacity="0.25",typeof u.options.ondragstart=="function"&&u.options.ondragstart(E,Y,N),N.dataTransfer.setDragImage(Y,0,0)}}),E.addEventListener("dragover",function(N){if(N.preventDefault(),z&&oe(N.target)&&N.target.getAttribute("draggable")=="true"&&z.element!=N.target){if(u.options.direction)var Y=N.target.clientWidth/2>N.offsetX;else var Y=N.target.clientHeight/2>N.offsetY;Y?N.target.parentNode.insertBefore(z.element,N.target):N.target.parentNode.insertBefore(z.element,N.target.nextSibling),z.d=Array.prototype.indexOf.call(N.target.parentNode.children,z.element)}}),E.addEventListener("dragleave",function(N){N.preventDefault()}),E.addEventListener("dragend",function(N){N.preventDefault(),z&&(typeof u.options.ondragend=="function"&&u.options.ondragend(E,z.element,N),z.o<z.d?N.target.parentNode.insertBefore(z.element,N.target.parentNode.children[z.o]):N.target.parentNode.insertBefore(z.element,N.target.parentNode.children[z.o].nextSibling),z.element.style.opacity="",z=null)}),E.addEventListener("drop",function(N){N.preventDefault(),z&&(z.o!==z.d&&typeof u.options.ondrop=="function"&&u.options.ondrop(E,z.o,z.d,z.element,N.target,N),z.element.style.opacity="",z=null)});for(var oe=function(N){var Y=!1;function J(ie){ie.className&&ie.classList.contains("jsorting")&&(Y=!0),Y||J(ie.parentNode)}return J(N),Y},k=0;k<E.children.length;k++)E.children[k].hasAttribute("draggable")||E.children[k].setAttribute("draggable","true");return E.val=function(){for(var N=null,Y=[],J=0;J<E.children.length;J++)(N=E.children[J].getAttribute("data-id"))&&Y.push(N);return Y},E}function b(E,M){var u={};(!M.loadUp||typeof M.loadUp!="function")&&(M.loadUp=function(){return!1}),(!M.loadDown||typeof M.loadDown!="function")&&(M.loadDown=function(){return!1}),M.timer||(M.timer=100);var a=null,z=function(ne){if(a==null){var oe=!1,k=E.scrollTop;E.scrollTop+E.clientHeight*2>=E.scrollHeight?M.loadDown()&&(k==E.scrollTop&&(E.scrollTop=E.scrollTop-E.clientHeight),oe=!0):E.scrollTop<=E.clientHeight&&M.loadUp()&&(k==E.scrollTop&&(E.scrollTop=E.scrollTop+E.clientHeight),oe=!0),a=setTimeout(function(){a=null},M.timer),oe&&typeof M.onupdate=="function"&&M.onupdate()}};return E.onscroll=function(ne){z()},E.onwheel=function(ne){z()},u}function A(){var E=function(M,u){if(Array.isArray(M)){var a={instance:[],complete:u};if(M.length>0)for(var z=0;z<M.length;z++)M[z].multiple=a,a.instance.push(E(M[z]));return a}if(M.data||(M.data={}),M.type&&(M.method=M.type),M.method||(M.method="GET"),M.dataType||(M.dataType="json"),M.data){var ne=function(ie,ge){var fe=[];if(ie){var he=Object.keys(ie);if(he.length)for(var Le=0;Le<he.length;Le++){if(ge)var Te=ge+"["+he[Le]+"]";else var Te=he[Le];if(ie[Te]instanceof FileList)fe[Te]=ie[he[Le]];else if(ie[he[Le]]===null||ie[he[Le]]===void 0)fe[Te]="";else if(typeof ie[he[Le]]=="object")for(var Fe=ne(ie[he[Le]],Te),Ge=Object.keys(Fe),Xe=0;Xe<Ge.length;Xe++)fe[Ge[Xe]]=Fe[Ge[Xe]];else fe[Te]=ie[he[Le]]}}return fe},oe=ne(M.data),k=Object.keys(oe);if(M.method=="GET"){if(k.length){for(var N=[],z=0;z<k.length;z++)N.push(k[z]+"="+encodeURIComponent(oe[k[z]]));M.url.indexOf("?")<0&&(M.url+="?"),M.url+=N.join("&")}}else for(var N=new FormData,z=0;z<k.length;z++)if(oe[k[z]]instanceof FileList){if(oe[k[z]].length)for(var Y=0;Y<oe[k[z]].length;Y++)N.append(k[z],oe[k[z]][Y],oe[k[z]][Y].name)}else N.append(k[z],oe[k[z]])}var J=new XMLHttpRequest;return J.open(M.method,M.url,!0),J.setRequestHeader("X-Requested-With","XMLHttpRequest"),M.contentType&&J.setRequestHeader("Content-Type",M.contentType),M.method==="POST"?J.setRequestHeader("Accept","application/json"):M.dataType==="blob"?J.responseType="blob":M.contentType||(M.dataType==="json"?J.setRequestHeader("Content-Type","text/json"):M.dataType==="html"&&J.setRequestHeader("Content-Type","text/html")),M.cache!==!0&&(J.setRequestHeader("pragma","no-cache"),J.setRequestHeader("cache-control","no-cache")),M.withCredentials===!0&&(J.withCredentials=!0),typeof M.beforeSend=="function"&&M.beforeSend(J),typeof E.beforeSend=="function"&&E.beforeSend(J),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(J),J.onload=function(){if(J.status>=200&&J.status<300)if(M.dataType==="json")try{var ie=JSON.parse(J.responseText);M.success&&typeof M.success=="function"&&M.success(ie)}catch(fe){M.error&&typeof M.error=="function"&&M.error(fe,ie)}else{if(M.dataType==="blob")var ie=J.response;else var ie=J.responseText;M.success&&typeof M.success=="function"&&M.success(ie)}else M.error&&typeof M.error=="function"&&M.error(J.responseText,J.status);if(E.queue&&E.queue.length>0&&E.send(E.queue.shift()),E.requests&&E.requests.length){var ge=E.requests.indexOf(J);if(E.requests.splice(ge,1),E.requests.length||M.complete&&typeof M.complete=="function"&&M.complete(ie),M.group&&E.oncomplete&&typeof E.oncomplete[M.group]=="function"&&(E.pending(M.group)||(E.oncomplete[M.group](),E.oncomplete[M.group]=null)),M.multiple&&M.multiple.instance){var ge=M.multiple.instance.indexOf(J);M.multiple.instance.splice(ge,1),M.multiple.instance.length||M.multiple.complete&&typeof M.multiple.complete=="function"&&M.multiple.complete(ie)}}},J.options=M,J.data=N,M.queue===!0&&E.requests.length>0?E.queue.push(J):E.send(J),J};return E.send=function(M){M.data?Array.isArray(M.data)?M.send(M.data.join("&")):M.send(M.data):M.send(),E.requests.push(M)},E.exists=function(M,u){var a=new XMLHttpRequest;a.open("HEAD",M,!1),a.send(),a.status&&u(a.status)},E.pending=function(M){var u=0,a=E.requests;if(a&&a.length)for(var z=0;z<a.length;z++)(!M||M==a[z].options.group)&&u++;return u},E.oncomplete={},E.requests=[],E.queue=[],E}var T=A();function S(){const E={loading:{}};return E.loading.show=function(M){E.loading.element||(E.loading.element=document.createElement("div"),E.loading.element.className="jloading"),document.body.appendChild(E.loading.element),M>0&&setTimeout(function(){E.loading.hide()},M*1e3)},E.loading.hide=function(){E.loading.element&&E.loading.element.parentNode&&document.body.removeChild(E.loading.element)},E.slideLeft=function(M,u,a){u==!0?(M.classList.add("jslide-left-in"),setTimeout(function(){M.classList.remove("jslide-left-in"),typeof a=="function"&&a()},400)):(M.classList.add("jslide-left-out"),setTimeout(function(){M.classList.remove("jslide-left-out"),typeof a=="function"&&a()},400))},E.slideRight=function(M,u,a){u===!0?(M.classList.add("jslide-right-in"),setTimeout(function(){M.classList.remove("jslide-right-in"),typeof a=="function"&&a()},400)):(M.classList.add("jslide-right-out"),setTimeout(function(){M.classList.remove("jslide-right-out"),typeof a=="function"&&a()},400))},E.slideTop=function(M,u,a){u===!0?(M.classList.add("jslide-top-in"),setTimeout(function(){M.classList.remove("jslide-top-in"),typeof a=="function"&&a()},400)):(M.classList.add("jslide-top-out"),setTimeout(function(){M.classList.remove("jslide-top-out"),typeof a=="function"&&a()},400))},E.slideBottom=function(M,u,a){u===!0?(M.classList.add("jslide-bottom-in"),setTimeout(function(){M.classList.remove("jslide-bottom-in"),typeof a=="function"&&a()},400)):(M.classList.add("jslide-bottom-out"),setTimeout(function(){M.classList.remove("jslide-bottom-out"),typeof a=="function"&&a()},100))},E.fadeIn=function(M,u){M.style.display="",M.classList.add("jfade-in"),setTimeout(function(){M.classList.remove("jfade-in"),typeof u=="function"&&u()},2e3)},E.fadeOut=function(M,u){M.classList.add("jfade-out"),setTimeout(function(){M.style.display="none",M.classList.remove("jfade-out"),typeof u=="function"&&u()},1e3)},E}var P=S();function _(){var E={};E.now=function(oe,k){var N=null,Y=null,J=null,ie=null,ge=null,fe=null;return Array.isArray(oe)?(N=oe[0],Y=oe[1],J=oe[2],ie=oe[3],ge=oe[4],fe=oe[5]):(oe||(oe=new Date),N=oe.getFullYear(),Y=oe.getMonth()+1,J=oe.getDate(),ie=oe.getHours(),ge=oe.getMinutes(),fe=oe.getSeconds()),k==!0?l.two(N)+"-"+l.two(Y)+"-"+l.two(J):l.two(N)+"-"+l.two(Y)+"-"+l.two(J)+" "+l.two(ie)+":"+l.two(ge)+":"+l.two(fe)},E.toArray=function(oe){var N=oe.split(oe.indexOf("T")!==-1?"T":" "),k=N[1],N=N[0].split("-"),Y=parseInt(N[0]),J=parseInt(N[1]),ie=parseInt(N[2]),ge=0,fe=0;return k&&(k=k.split(":"),ge=parseInt(k[0]),fe=parseInt(k[1])),[Y,J,ie,ge,fe,0]};var M=Date.UTC(1900,0,0),u=Date.UTC(1900,1,29),a=864e5;E.dateToNum=function(oe){typeof oe=="string"&&(oe=new Date(oe+"  GMT+0"));var k=oe.getTime();return k>=u&&(k+=a),k-=M,k/a},E.numToDate=function(oe){var k=M+oe*a;k>=u&&(k-=a);const N=new Date(k);var Y=[N.getUTCFullYear(),N.getUTCMonth()+1,N.getUTCDate(),N.getUTCHours(),N.getUTCMinutes(),N.getUTCSeconds()];return E.now(Y)};let z=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ne=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(E,"weekdays",{get:function(){return z.map(function(oe){return h.translate(oe)})}}),Object.defineProperty(E,"weekdaysShort",{get:function(){return z.map(function(oe){return h.translate(oe).substring(0,3)})}}),Object.defineProperty(E,"months",{get:function(){return ne.map(function(oe){return h.translate(oe)})}}),Object.defineProperty(E,"monthsShort",{get:function(){return ne.map(function(oe){return h.translate(oe).substring(0,3)})}}),E}var I=_();function H(){var E={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},M=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var C=0;this.date[4]&&(C=parseFloat(this.date[4]/60));var O=parseInt(this.date[3])+C;O/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?O=l.two(this.date[3])+":"+l.two(this.date[4])+":"+l.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),O=l.two(this.date[0])+"-"+l.two(this.date[1])+"-"+l.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(O+=" "+l.two(this.date[3])+":"+l.two(this.date[4])+":"+l.two(this.date[5])));return O},u=function(){var C="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)C=parseInt(this.date[3]);else{let Z=parseInt(this.date[3]);Z<13&&this.values.indexOf("PM")!==-1?C=(Z+12)%24:C=Z%24}this.date[4]&&(C+=parseFloat(this.date[4]/60)),this.date[5]&&(C+=parseFloat(this.date[5]/3600)),C/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var O=I.now(this.date);C=I.dateToNum(O),this.date[4]&&(C+=parseFloat(this.date[4]/60))}return isNaN(C)&&(C=""),C},a=function(C){return C===null||C===""||C===void 0},z=function(C){var O=(""+C)[0];return O=="="},ne=function(C){return C==="currency"||C==="percentage"||C==="scientific"||C==="numeric"},oe=function(C){if(C&&Number(C)==C)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var O=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=O[1]}else{C||(C=this.mask);var Z=new RegExp("0{1}(.{1})0+","ig"),O=Z.exec(C);if(O&&O[1]&&O[1].length==1)return this.options.decimal=O[1],O[1];var Z=new RegExp("#{1}(.{1})#+","ig"),O=Z.exec(C);O&&O[1]&&O[1].length==1?O[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},k=function(C,O){if(C=="")return"";O||(O=oe.call(this)),C=(""+C).split(O);var Z=C[0].match(/[-]+/g);if(Z&&Z.length?Z=!0:Z=!1,C[0]=C[0].match(/[0-9]+/g),C[0]?(Z&&C[0].unshift("-"),C[0]=C[0].join("")):Z&&(C[0]="-"),C[0]||C[1])C[1]!==void 0&&(C[1]=C[1].match(/[0-9]+/g),C[1]?C[1]=C[1].join(""):C[1]="");else return"";return C},N=function(C,O){if(C==="")return"";var Z=oe.call(this),se=this.options;if(C=k.call(this,C),C==="")return"";var ee=null;if(C[0]&&(se.style==="percent"?ee=parseFloat(C[0])/100:ee=parseFloat(C[0]+".1")),(C[0]==="-"||C[0]==="-00")&&!C[1]&&O&&O.inputType=="deleteContentBackward")return"";var de=new Intl.NumberFormat(this.locale,se).format(ee);if(de=de.split(Z),se.style==="percent"&&de[0].indexOf("%")!==-1&&(de[0]=de[0].replace("%",""),de[2]="%"),typeof de[1]<"u"){var be=de[1].replace(/[0-9]*/g,"");be&&(de[2]=be)}return C[1]!==void 0?de[1]=Z+C[1]:de[1]="",de.join("")},Y=function(C,O){var Z=ge.call(C);if(Z){var se=N.call(this,Z,O),ee=se.length-Z.length,de=ie.call(C)+ee;ge.call(C,se,de,!0)}},J=function(C){var O=k.call(this,C);return O?(O[0]==="-"&&(O[0]="-0"),parseFloat(O.join("."))):null},ie=function(C,O){if(C===void 0)if(this.tagName=="DIV"){var Z=0,se=window.getSelection();if(se&&se.rangeCount!==0){var ee=se.getRangeAt(0),de=ee.cloneRange();de.selectNodeContents(this),de.setEnd(ee.endContainer,ee.endOffset),Z=de.toString().length}return Z}else return this.selectionStart;else{var be=ge.call(this);if(O){for(var de=null,Oe=0;Oe<be.length;Oe++)(be[Oe].match(/[\-0-9]/g)||be[Oe]==="."||be[Oe]===",")&&(de=Oe);de===null&&(de=be.indexOf(" ")),C>=de&&(C=de+1)}if(C>be.length&&(C=be.length),C)if(this.tagName=="DIV"){var se=window.getSelection(),ee=document.createRange();this.childNodes[0]&&(ee.setStart(this.childNodes[0],C),se.removeAllRanges(),se.addRange(ee))}else this.selectionStart=C,this.selectionEnd=C}},ge=function(C,O,Z){if(this.tagName=="DIV")if(C===void 0){var C=this.innerText;return this.value&&this.value.length>C.length&&(C=this.value),C}else this.innerText!==C&&(this.innerText=C,O&&ie.call(this,O,Z));else{if(C===void 0)return this.value;this.value!==C&&(this.value=C,O&&ie.call(this,O,Z))}},fe=I.weekdays,he=I.weekdaysShort,Le=I.months,Te=I.monthsShort,Fe={YEAR:function(C,O){var Z=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(C)>=0&&parseInt(C)<=10&&this.values[this.index].length<O&&(this.values[this.index]+=C),this.values[this.index].length==O){if(O==2)var Z=Z.substr(0,2)+this.values[this.index];else if(O==3)var Z=Z.substr(0,1)+this.values[this.index];else if(O==4)var Z=this.values[this.index];this.date[0]=Z,this.index++}},YYYY:function(C){Fe.YEAR.call(this,C,4)},YYY:function(C){Fe.YEAR.call(this,C,3)},YY:function(C){Fe.YEAR.call(this,C,2)},FIND:function(C,O){if(a(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=C;return}for(var Z=0,se=0,ee=(this.values[this.index]+C).toLowerCase(),de=0;de<O.length;de++)O[de].toLowerCase().indexOf(ee)==0&&(Z=de,se++);if(se>1)this.values[this.index]+=C;else if(se==1){var be=O[Z].length-this.values[this.index].length-1;return this.position+=be,this.values[this.index]=O[Z],this.index++,Z}},MMM:function(C){var O=Fe.FIND.call(this,C,Te);O!==void 0&&(this.date[1]=O+1)},MON:function(C){Fe.MMM.call(this,C)},MMMM:function(C){var O=Fe.FIND.call(this,C,Le);O!==void 0&&(this.date[1]=O+1)},MONTH:function(C){Fe.MMMM.call(this,C)},MMMMM:function(C){a(this.values[this.index])&&(this.values[this.index]="");for(var O=(this.values[this.index]+C).toLowerCase(),Z=0;Z<Le.length;Z++)if(Le[Z][0].toLowerCase().indexOf(O)==0){this.values[this.index]=Le[Z][0],this.date[1]=Z+1,this.index++;break}},MM:function(C){a(this.values[this.index])?parseInt(C)>1&&parseInt(C)<10?(this.date[1]=this.values[this.index]="0"+C,this.index++):parseInt(C)<2&&(this.values[this.index]=C):this.values[this.index]==1&&parseInt(C)<3?(this.date[1]=this.values[this.index]+=C,this.index++):this.values[this.index]==0&&parseInt(C)>0&&parseInt(C)<10&&(this.date[1]=this.values[this.index]+=C,this.index++)},M:function(C){var O=!1;if(parseInt(C)>=0&&parseInt(C)<10)if(a(this.values[this.index]))this.values[this.index]=C,C>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(C)<3)this.date[1]=this.values[this.index]+=C,this.index++;else if(this.values[this.index]==0&&parseInt(C)>0)this.date[1]=this.values[this.index]+=C,this.index++;else var O=!0;else var O=!0;if(O==!0){var Z=parseInt(this.values[this.index]);Z>0&&Z<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(C){var O=!1;if(parseInt(C)>=0&&parseInt(C)<10)if(a(this.values[this.index]))this.values[this.index]=C,parseInt(C)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(C)<2)this.date[2]=this.values[this.index]+=C,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=C,this.index++;else if(this.values[this.index]==0&&parseInt(C)>0)this.date[2]=this.values[this.index]+=C,this.index++;else var O=!0;else var O=!0;if(O==!0){var Z=parseInt(this.values[this.index]);Z>0&&Z<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(C){a(this.values[this.index])?parseInt(C)>3&&parseInt(C)<10?(this.date[2]=this.values[this.index]="0"+C,this.index++):parseInt(C)<10&&(this.values[this.index]=C):this.values[this.index]==3&&parseInt(C)<2?(this.date[2]=this.values[this.index]+=C,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(C)<10?(this.date[2]=this.values[this.index]+=C,this.index++):this.values[this.index]==0&&parseInt(C)>0&&parseInt(C)<10&&(this.date[2]=this.values[this.index]+=C,this.index++)},DDD:function(C){Fe.FIND.call(this,C,he)},DY:function(C){Fe.DDD.call(this,C)},DDDD:function(C){Fe.FIND.call(this,C,fe)},DAY:function(C){Fe.DDDD.call(this,C)},HH12:function(C,O){a(this.values[this.index])?parseInt(C)>1&&parseInt(C)<10?(O&&(C=0+C),this.date[3]=this.values[this.index]=C,this.index++):parseInt(C)<10&&(this.values[this.index]=C):this.values[this.index]==1&&parseInt(C)<3?(this.date[3]=this.values[this.index]+=C,this.index++):this.values[this.index]<1&&parseInt(C)<10&&(this.date[3]=this.values[this.index]+=C,this.index++)},HH24:function(C,O){parseInt(C)>=0&&parseInt(C)<10&&(this.values[this.index]==null||this.values[this.index]==""?parseInt(C)>2&&parseInt(C)<10?(O&&(C=0+C),this.date[3]=this.values[this.index]=C,this.index++):parseInt(C)<10&&(this.values[this.index]=C):this.values[this.index]==2&&parseInt(C)<4?(!O&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=C,this.index++):this.values[this.index]<2&&parseInt(C)<10&&(!O&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=C,this.index++))},HH:function(C){Fe.HH24.call(this,C,1)},H:function(C){Fe.HH24.call(this,C,0)},"\\[H\\]":function(C){this.values[this.index]==null&&(this.values[this.index]=""),C.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=C:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(C,O){this.values[this.index]==null||this.values[this.index]==""?parseInt(C)>5&&parseInt(C)<10?(this.date[O]=this.values[this.index]="0"+C,this.index++):parseInt(C)<10&&(this.values[this.index]=C):parseInt(C)<10&&(this.date[O]=this.values[this.index]+=C,this.index++)},MI:function(C){Fe.N60.call(this,C,4)},SS:function(C){Fe.N60.call(this,C,5)},"AM/PM":function(C){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?C.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":C.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(C){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(C)>=0&&parseInt(C)<7&&(this.values[this.index]=C),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(C){var O=oe.call(this),Z=!1;a(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(Z=!0);var se=k.call(this,this.values[this.index],O);se&&(this.values[this.index]=se.join(O)),parseInt(C)>=0&&parseInt(C)<10?(this.values[this.index]=="0"&&C>0?this.values[this.index]="":this.values[this.index]=="-0"&&C>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||C==O)&&(this.values[this.index]+=C)):O&&C==O?this.values[this.index].indexOf(O)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=C):C=="-"&&(Z=!0),Z===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(C){Fe["0{1}(.{1}0+)?"].call(this,C)},"0{1}(.{1}0+)?%":function(C){Fe["0{1}(.{1}0+)?"].call(this,C),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(C){Fe["0{1}(.{1}0+)?"].call(this,C);var O=oe.call(this),Z=this.tokens[this.index].substr(1,1),se=this.values[this.index][0]==="-",ee=k.call(this,this.values[this.index],O);if(ee!==""){var de=ee[0].match(/[0-9]/g);if(de){de=de.join("");for(var be=[],Oe=0,we=de.length-1;we>=0;we--)be.push(de[we]),Oe++,Oe%3||be.push(Z);be=be.reverse(),ee[0]=be.join(""),ee[0].substr(0,1)==Z&&(ee[0]=ee[0].substr(1))}else ee[0]="";this.values[this.index]=ee.join(O),se&&(this.values[this.index]="-"+this.values[this.index])}},0:function(C){C.match(/[0-9]/g)&&(this.values[this.index]=C,this.index++)},"[0-9a-zA-Z$]+":function(C){a(this.values[this.index])&&(this.values[this.index]="");var O=this.tokens[this.index],Z=this.values[this.index],se=Z.length;O[se]==C?(this.values[this.index]+=C,this.values[this.index]==O&&this.index++):(this.values[this.index]=O,this.index++,C.match(/[\-0-9]/g)&&this.position--)},A:function(C){C.match(/[a-zA-Z]/gi)&&(this.values[this.index]=C,this.index++)},".":function(C){Fe["[0-9a-zA-Z$]+"].call(this,C)},"@":function(C){a(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=C}},Ge=function(C){if(this.type=="general")var O=[].concat(E.general);else var O=[].concat(E.currency,E.datetime,E.percentage,E.scientific,E.numeric,E.text,E.general);var Z=new RegExp(O.join("|"),"gi");return C.match(Z)},Xe=function(C){if(this.type)if(this.type=="text")var O=["text"];else if(this.type=="general")var O=["general"];else if(this.type=="datetime")var O=["numeric","datetime","general"];else var O=["currency","percentage","scientific","numeric","general"];else var O=Object.keys(E);for(var Z=0;Z<O.length;Z++)for(var se=O[Z],ee=0;ee<E[se].length;ee++){var de=new RegExp(E[se][ee],"gi"),be=C.match(de);if(be)return{type:se,method:E[se][ee]}}},te=function(C){for(var O=[],Z=0;Z<C.length;Z++){var se=Xe.call(this,C[Z]);se?O.push(se.method):O.push(null)}for(var Z=0;Z<O.length;Z++)O[Z]=="MM"&&(O[Z-1]&&O[Z-1].indexOf("H")>=0||O[Z-2]&&O[Z-2].indexOf("H")>=0||O[Z+1]&&O[Z+1].indexOf("S")>=0||O[Z+2]&&O[Z+2].indexOf("S")>=0)&&(O[Z]="MI");return O},me=function(C){var O=Xe.call(this,C);if(O)var Z=O.type;if(Z){for(var se=0,ee=Ge.call(this,C),de=0;de<ee.length;de++)O=Xe.call(this,ee[de]),O&&ne(O.type)&&se++;se>1&&(Z="general")}return Z},Ee=function(){typeof Fe[this.methods[this.index]]=="function"?(Fe[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},q=function(C){return(""+ +C).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(O,Z,se,ee,de){return de<0?Z+"0."+Array(1-de-se.length).join(0)+se+ee:Z+se+ee+Array(de-ee.length+1).join(0)})},Q=function(C,O,Z){var se=null,ee={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof C=="object"){if(ee.input=C.target,ee.value=ge.call(C.target),ee.caret=ie.call(C.target),(se=C.target.getAttribute("data-mask"))&&(ee.mask=se),(se=C.target.getAttribute("data-type"))&&(ee.type=se),C.target.mask?(C.target.mask.options&&(ee.options=C.target.mask.options),C.target.mask.locale&&(ee.locale=C.target.mask.locale)):(se=C.target.getAttribute("data-locale"))&&(ee.locale=se,ee.mask&&(ee.options.style=ee.mask)),C.target.attributes&&C.target.attributes.length)for(var de=0;de<C.target.attributes.length;de++){var be=C.target.attributes[de].name,Oe=C.target.attributes[de].value;be.substr(0,4)=="data"&&(ee.options[be.substr(5)]=Oe)}}else{if(typeof O=="string")ee.mask=O;else for(var be=Object.keys(O),de=0;de<be.length;de++)ee[be[de]]=O[be[de]];typeof C=="number"&&(oe.call(ee,ee.mask),C=(""+C).replace(".",ee.options.decimal)),ee.value=C,ee.input&&(ge.call(ee.input,C),l.focus(ee.input),ee.caret=ie.call(ee.input))}if(!z(ee.value)&&(ee.mask||ee.locale)){if(ee.mask){if(ee.mask=ee.mask.replace(new RegExp(/\[h]/),"|h|"),ee.mask=ee.mask.replace(new RegExp(/\[.*?\]/),""),ee.mask=ee.mask.replace(new RegExp(/\|h\|/),"[h]"),ee.mask.indexOf(";")!==-1){var se=ee.mask.split(";");ee.mask=se[0]}if(ee.mask.indexOf("##")!==-1){var we=ee.mask.split(";");we[0]&&(typeof C=="object"&&(we[0]=we[0].replace(new RegExp(/_\)/g),""),we[0]=we[0].replace(new RegExp(/_\(/g),"")),we[0]=we[0].replace("*","	"),we[0]=we[0].replace(new RegExp(/_-/g),""),we[0]=we[0].replace(new RegExp(/_/g),""),we[0]=we[0].replace(new RegExp(/"/g),""),we[0]=we[0].replace("##0.###","##0.000"),we[0]=we[0].replace("##0.##","##0.00"),we[0]=we[0].replace("##0.#","##0.0"),we[0]=we[0].replace("##0,###","##0,000"),we[0]=we[0].replace("##0,##","##0,00"),we[0]=we[0].replace("##0,#","##0,0")),ee.mask=we[0]}if(ee.mask.indexOf("\\")!==-1){var we=ee.mask.split(";");we[0]=we[0].replace(new RegExp(/\\/g),""),ee.mask=we[0]}ee.type||(ee.type=me.call(ee,ee.mask)),ee.tokens=Ge.call(ee,ee.mask)}if(typeof C!="object"||!C.inputType||!C.inputType.indexOf("insert")||!C.inputType.indexOf("delete"))if(ee.locale)if(ee.input)Y.call(ee,ee.input,C);else var Se=N.call(ee,ee.value);else{for(ee.methods=te.call(ee,ee.tokens),ee.event=C;ee.position<ee.value.length&&typeof ee.tokens[ee.index]<"u";)Ee.call(ee);var Se=ee.values.join("");if(ne(ee.type)&&Se!==""){for(;typeof ee.tokens[ee.index]<"u";){var se=Xe.call(ee,ee.tokens[ee.index]);se&&se.type=="general"&&(ee.values[ee.index]=ee.tokens[ee.index]),ee.index++}var Re=!0}else var Re=!1;if(Se=ee.values.join(""),ee.input){if(se=Se.length-ee.value.length,se>0)var Ke=ee.caret+se;else var Ke=ee.caret;ge.call(ee.input,Se,Ke,Re)}}if(ee.input){var re=null;if(ne(ee.type)){let ve=ge.call(ee.input);ee.number=J.call(ee,ve),ee.type=="percentage"&&(""+ve).indexOf("%")!==-1?re=Q.adjustPrecision(ee.number/100):re=ee.number}else ee.type=="datetime"&&(re=M.call(ee),ee.date[0]&&ee.date[1]&&ee.date[2]&&ee.input.setAttribute("data-completed",!0));re&&ee.input.setAttribute("data-value",re)}if(Se!==void 0)return Z?ee:Se}};return Q.adjustPrecision=function(C){if(typeof C=="number"&&!Number.isInteger(C)){const O=C.toString().split(".");if(O[1]&&O[1].length>10){let Z=0;const se=O[1][O[1].length-2];if(se==0||se==9){for(let ee=O[1].length-2;ee>0;ee--)if(Z>=0&&O[1][ee]==se){if(Z++,Z>6)break}else{Z=0;break}if(Z)return parseFloat(parseFloat(C).toFixed(O[1].length-1))}}}return C},Q.getType=me,Q.prepare=function(C,O){return O||(O={}),Ge.call(O,C)},Q.apply=function(C){var O=ge.call(C.target);C.key.length==1&&(O+=C.key),ge.call(C.target,Q(O,C.target.getAttribute("data-mask")))},Q.run=function(C,O,Z){return Q(C,{mask:O,decimal:Z})},Q.extract=function(C,O,Z){if(a(C)||typeof O!="object")return C;if(O=Object.assign({},O),O.options||(O.options={}),!O.mask&&O.format&&(O.mask=O.format),O.mask){if(O.mask.indexOf(";")!==-1){var se=O.mask.split(";");O.mask=se[0]}O.mask=O.mask.replace(new RegExp(/\[h]/),"|h|"),O.mask=O.mask.replace(new RegExp(/\[.*?\]/),""),O.mask=O.mask.replace(new RegExp(/\|h\|/),"[h]")}oe.call(O,O.mask);var ee=null,de=null;if(O.type=="percent"||O.options.style=="percent"?ee="percentage":O.mask&&(ee=me.call(O,O.mask)),ee==="general"){var be=Q(C,O,!0);de=C}else if(ee==="datetime"){C instanceof Date&&(C=Q.getDateString(C,O.mask));var be=Q(C,O,!0);l.isNumeric(C)?de=C:de=u.call(be)}else if(ee==="scientific"){de=C,typeof C=="string"&&(de=Number(de));var be=O}else{de=J.call(O,C),ee==="percentage"&&(""+C).indexOf("%")!==-1&&(de/=100);var be=O}return be.value=de,!be.type&&ee&&(be.type=ee),Z?be:de},Q.render=function(C,O,Z){if(a(C)||typeof O!="object")return C;if(O=Object.assign({},O),O.options||(O.options={}),!O.mask&&O.format&&(O.mask=O.format),O.mask){if(O.mask.indexOf(";")!==-1){var se=O.mask.split(";");Z||(se[0]=se[0].replace(new RegExp(/_\)/g),""),se[0]=se[0].replace(new RegExp(/_\(/g),"")),O.mask=se[0]}O.mask=O.mask.replace(new RegExp(/\[h]/),"|h|"),O.mask=O.mask.replace(new RegExp(/\[.*?\]/),""),O.mask=O.mask.replace(new RegExp(/\|h\|/),"[h]")}var ee=null;O.type=="percent"||O.options.style=="percent"?ee="percentage":O.mask?ee=me.call(O,O.mask):C instanceof Date&&(ee="datetime");var de=!1;if(ee=="datetime"||O.type=="calendar"){var se=Q.getDateString(C,O.mask);se&&(C=se),O.mask&&Z&&(de=!0)}else if(typeof C=="string"&&f.isNumeric(C)&&(C=Number(C)),ee==="percentage"&&(C=Q.adjustPrecision(C*100)),typeof C=="number"){var se=null;if(O.mask&&Z){var be=oe.call(O,O.mask);if(ee==="scientific")if(O.mask.indexOf(be)!==-1){let ve=O.mask.split("E");ve=ve[0].split(be),ve=""+ve[1].match(/[0-9]+/g),ve=ve.length,se=C.toExponential(ve)}else se=C.toExponential(0);else{if(O.mask.indexOf(be)!==-1){be=O.mask.split(be),be=""+be[1].match(/[0-9]+/g),be=be.length,se=C.toFixed(be);let ve=C.toString().split("."),Ce=ve[1];Ce&&Ce.length>be&&Ce[Ce.length-1]==="5"&&(se=parseFloat(ve[0]+"."+Ce+"1").toFixed(be))}else C.toString().indexOf(be)!==-1&&(se=C.toFixed(0));(""+se).indexOf("e")!==-1&&(se=q(se))}}else if(O.locale&&Z){var be=(""+C).split(".");if(O.options){typeof be[1]>"u"&&(be[1]="");var we=be[1].length;if(O.options.minimumFractionDigits>we)for(var Oe=0;Oe<O.options.minimumFractionDigits-we;Oe++)be[1]+="0"}be[1].length?se=be.join("."):se=be[0];var we=be[1].length;O.options&&O.options.maximumFractionDigits<we&&(se=parseFloat(se).toFixed(O.options.maximumFractionDigits))}else se=q(C);se!==null&&(C=se,oe.call(O,O.mask),O.options.decimal&&(C=C.replace(".",O.options.decimal)))}else O.mask&&Z&&(de=!0);if(de){var Se=O.mask.length-C.length;if(Se>0)for(var Oe=0;Oe<Se;Oe++)C+=" "}if(ee==="scientific")if(!Z)C=q(C);else return C;if(C=Q(C,O),Z&&ee==="numeric"){var Re=O.mask.match(new RegExp(/^[0]+$/gm));if(Re&&Re.length===1){var Ke=Re[0].length;if(Ke>3)for(C=""+C;C.length<Ke;)C="0"+C}}return C},Q.set=function(C,O){if(O){C.setAttribute("data-mask",O);var Z=new Event("input",{bubbles:!0,cancelable:!0});C.dispatchEvent(Z)}},Q.extractDateFromString=function(C,O){var Z=Q(C,{mask:O},!0);if(C>0&&Number(C)==C&&(Z.values.join("")!==Z.value||Z.type=="numeric")){var se=new Date(Math.round((C-25569)*86400*1e3));return se.getFullYear()+"-"+l.two(se.getMonth())+"-"+l.two(se.getDate())+" 00:00:00"}var ee=!1;return Z.values&&Z.values.length===Z.tokens.length&&Z.values[Z.values.length-1].length>=Z.tokens[Z.tokens.length-1].length&&(ee=!0),Z.date[0]&&Z.date[1]&&(Z.date[2]||ee)?(Z.date[2]||(Z.date[2]=1),Z.date[0]+"-"+l.two(Z.date[1])+"-"+l.two(Z.date[2])+" "+l.two(Z.date[3])+":"+l.two(Z.date[4])+":"+l.two(Z.date[5])):""},Q.getDateString=function(C,O){if(!O)var O={};if(O&&typeof O=="object"){if(O.format)var Z=O.format;else if(O.mask)var Z=O.mask}else var Z=O;if(Z||(Z="YYYY-MM-DD"),Z.indexOf("[h]")>=0){var se=0;if(C&&l.isNumeric(C)&&(se=parseFloat(24*Number(C)),Z.indexOf("mm")>=0)){var ee=(""+se).split(".");if(ee[1]){var de=60*parseFloat("0."+ee[1]);de=parseFloat(de.toFixed(2))}else var de=0;se=parseInt(ee[0])+":"+l.two(de)}return se}C instanceof Date?C=I.now(C):C&&l.isNumeric(C)&&(C=I.numToDate(C));for(var be=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],Oe=new RegExp(be.join("|"),"gi"),we=Z.match(Oe),Se=0;Se<we.length;Se++)we[Se].toUpperCase()=="MM"&&(we[Se-1]&&we[Se-1].toUpperCase().indexOf("H")>=0||we[Se-2]&&we[Se-2].toUpperCase().indexOf("H")>=0||we[Se+1]&&we[Se+1].toUpperCase().indexOf("S")>=0||we[Se+2]&&we[Se+2].toUpperCase().indexOf("S")>=0)&&(we[Se]="mi");var Re={tokens:we};if(C){var de=""+C,Ke=de.indexOf("T")!==-1?"T":" ";de=de.split(Ke);var ee=0,re=0,ve=0;de[1]&&(ee=de[1].split(":"),re=ee[1]?ee[1]:0,ve=ee[2]?ee[2]:0,ee=ee[0]?ee[0]:0),de=de[0].split("-");let ut=new Date(de[0],de[1],0).getDate();if(de[0]&&de[1]&&de[2]&&de[0]>0&&de[1]>0&&de[1]<13&&de[2]>0&&de[2]<=ut){Re.data=[de[0],de[1],de[2],ee,re,ve],Re.value=[];for(var Ce=new Date(Re.data[0],Re.data[1]-1,Re.data[2],Re.data[3],Re.data[4],Re.data[5]),He=function(ht){var tt=this.tokens[ht],ct=tt.toUpperCase(),$e=null;ct==="YYYY"?$e=this.data[0]:ct==="YYY"?$e=this.data[0].substring(1,4):ct==="YY"?$e=this.data[0].substring(2,4):ct==="Y"?$e=this.data[0].substring(3,4):tt==="MON"?$e=I.months[Ce.getMonth()].substr(0,3).toUpperCase():tt==="mon"?$e=I.months[Ce.getMonth()].substr(0,3).toLowerCase():tt==="MONTH"?$e=I.months[Ce.getMonth()].toUpperCase():tt==="month"?$e=I.months[Ce.getMonth()].toLowerCase():ct==="MMMMM"?$e=I.months[Ce.getMonth()].substr(0,1):ct==="MMMM"||tt==="Month"?$e=I.months[Ce.getMonth()]:ct==="MMM"||tt=="Mon"?$e=I.months[Ce.getMonth()].substr(0,3):ct==="MM"?$e=l.two(this.data[1]):ct==="M"?$e=Ce.getMonth()+1:tt==="DAY"?$e=I.weekdays[Ce.getDay()].toUpperCase():tt==="day"?$e=I.weekdays[Ce.getDay()].toLowerCase():ct==="DDDD"||tt=="Day"?$e=I.weekdays[Ce.getDay()]:ct==="DDD"?$e=I.weekdays[Ce.getDay()].substr(0,3):ct==="DD"?$e=l.two(this.data[2]):ct==="D"?$e=parseInt(this.data[2]):ct==="Q"?$e=Math.floor((Ce.getMonth()+3)/3):ct==="HH24"||ct==="HH"?($e=this.data[3],$e>12&&this.tokens.indexOf("am/pm")!==-1&&($e-=12),$e=l.two($e)):ct==="HH12"?this.data[3]>12?$e=l.two(this.data[3]-12):$e=l.two(this.data[3]):ct==="H"?($e=this.data[3],$e>12&&this.tokens.indexOf("am/pm")!==-1&&($e-=12,$e=l.two($e))):ct==="MI"?$e=l.two(this.data[4]):ct==="SS"?$e=l.two(this.data[5]):ct==="MS"?$e=Ce.getMilliseconds():ct==="AM/PM"?this.data[3]>=12?$e="PM":$e="AM":ct==="WD"&&($e=I.weekdays[Ce.getDay()]),$e===null?this.value[ht]=this.tokens[ht]:this.value[ht]=$e},Se=0;Se<Re.tokens.length;Se++)He.call(Re,Se);C=Re.value.join("")}else C=""}return C},Q}var K=H();function U(){var E=function(M,u){if(M.calendar)return M.calendar.setOptions(u,!0);var a={type:"calendar"};a.options={},a.date=null,a.setOptions=function(q,Q){var C={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:I.monthsShort,monthsFull:I.months,weekdays:I.weekdays,textDone:h.translate("Done"),textReset:h.translate("Reset"),textUpdate:h.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var O in C)q&&q.hasOwnProperty(O)?a.options[O]=q[O]:(typeof a.options[O]>"u"||Q===!0)&&(a.options[O]=C[O]);if(a.options.resetButton==!1?N.style.display="none":N.style.display="",a.options.readonly?M.setAttribute("readonly","readonly"):M.removeAttribute("readonly"),a.options.placeholder?M.setAttribute("placeholder",a.options.placeholder):M.removeAttribute("placeholder"),l.isNumeric(a.options.value)&&a.options.value>0&&(a.options.value=E.numToDate(a.options.value),a.options.dataType="numeric"),N.innerHTML=a.options.textReset,Y.innerHTML=a.options.textDone,Xe.innerHTML=a.options.textUpdate,M.setAttribute("data-mask",a.options.format.toLowerCase()),!a.options.value&&a.options.today)var Z=E.now();else var Z=a.options.value;return Z&&(a.options.value=null,a.setValue(Z)),a},a.open=function(q){if(!k.classList.contains("jcalendar-focus")&&!k.classList.contains("jcalendar-inline")){if(E.current=a,V(a,!0),a.getDays(),a.options.type=="year-month-picker"&&a.getMonths(),a.options.time&&(te.value=a.date[3],me.value=a.date[4]),k.classList.add("jcalendar-focus"),l.getWindowWidth()<800||a.options.fullscreen)k.classList.add("jcalendar-fullsize"),P.slideBottom(ie,1);else{k.classList.remove("jcalendar-fullsize");var Q=M.getBoundingClientRect(),C=ie.getBoundingClientRect();if(a.options.position)J.style.position="fixed",window.innerHeight<Q.bottom+C.height?J.style.top=Q.top-(C.height+2)+"px":J.style.top=Q.top+Q.height+2+"px",J.style.left=Q.left+"px";else{if(window.innerHeight<Q.bottom+C.height){var O=-1*(Q.height+C.height+2);O+Q.top<0&&(O=-1*(Q.top+Q.height)),J.style.top=O+"px"}else J.style.top="2px";if(window.innerWidth<Q.left+C.width){var O=window.innerWidth-(Q.left+C.width+20);J.style.left=O+"px"}else J.style.left="0px"}}typeof a.options.onopen=="function"&&a.options.onopen(M)}},a.close=function(q,Q){if(a.options.autoSelect!==!0&&typeof Q>"u"&&(Q=!1),k.classList.contains("jcalendar-focus")){if(Q!==!1){var C=k.querySelector(".jcalendar-selected");if(typeof Q=="string")var O=Q;else if(!C||C.classList.contains("jcalendar-disabled"))var O=a.options.value;else var O=a.getValue();a.setValue(O)}else{let Z=a.options.value||"";a.options.value=null,a.setValue(Z)}!q&&typeof a.options.onclose=="function"&&a.options.onclose(M),k.classList.remove("jcalendar-focus"),V(a,!1),E.current=null}return a.options.value},a.prev=function(){a.options.mode=="years"?(a.date[0]=a.date[0]-12,a.getYears()):a.options.mode=="months"?(a.date[0]=parseInt(a.date[0])-1,a.getMonths()):(a.date[1]<2?(a.date[0]=a.date[0]-1,a.date[1]=12):a.date[1]=a.date[1]-1,a.getDays())},a.next=function(){a.options.mode=="years"?(a.date[0]=parseInt(a.date[0])+12,a.getYears()):a.options.mode=="months"?(a.date[0]=parseInt(a.date[0])+1,a.getMonths()):(a.date[1]>11?(a.date[0]=parseInt(a.date[0])+1,a.date[1]=1):a.date[1]=parseInt(a.date[1])+1,a.getDays())},a.setToday=function(){var q=new Date().toISOString().substr(0,10);return a.setValue(q),q},a.setValue=function(q){q||(q=""+q);var Q=q,C=a.options.value;if(C!=Q){if(Q){a.setLabel(Q,a.options);var Z=Q.split(" ");Z[1]||(Z[1]="00:00:00");var O=Z[1].split(":"),Z=Z[0].split("-"),se=parseInt(Z[0]),ee=parseInt(Z[1]),de=parseInt(Z[2]),be=parseInt(O[0]),Oe=parseInt(O[1]);a.date=[se,ee,de,be,Oe,0];var q=a.setLabel(Q,a.options),we=E.now(new Date(se,ee-1,de),!0);if(a.options.validRange){if(!a.options.validRange[0]||we>=a.options.validRange[0])var Se=!0;else var Se=!1;if(!a.options.validRange[1]||we<=a.options.validRange[1])var Re=!0;else var Re=!1;Se&&Re?(M.classList.remove("jcalendar_warning"),M.title=""):(M.classList.add("jcalendar_warning"),M.title=h.translate("Date outside the valid range"))}else M.classList.remove("jcalendar_warning"),M.title=""}else{a.date=null;var q="";M.classList.remove("jcalendar_warning"),M.title=""}a.options.value=Q,typeof a.options.onchange=="function"&&a.options.onchange(M,Q,C),M.value!=q&&(M.value=q,typeof M.oninput=="function"&&M.oninput({type:"input",target:M,value:M.value}))}a.date&&(a.getDays(),a.options.type=="year-month-picker"&&a.getMonths())},a.getValue=function(){return a.date?a.options.time?l.two(a.date[0])+"-"+l.two(a.date[1])+"-"+l.two(a.date[2])+" "+l.two(a.date[3])+":"+l.two(a.date[4])+":"+l.two(0):l.two(a.date[0])+"-"+l.two(a.date[1])+"-"+l.two(a.date[2])+" "+l.two(0)+":"+l.two(0)+":"+l.two(0):""},a.update=function(q,Q){if(!q.classList.contains("jcalendar-disabled")){var C=k.querySelector(".jcalendar-selected");C&&C.classList.remove("jcalendar-selected"),q.classList.add("jcalendar-selected"),q.classList.contains("jcalendar-set-month")?(a.date[1]=Q,a.date[2]=1):a.date[2]=q.innerText,a.options.time?(a.date[3]=te.value,a.date[4]=me.value):a.close(null,!0)}oe()},a.reset=function(){a.setValue(""),a.date=null,a.close(!1,!1)},a.getDays=function(){a.options.mode="days";var be=new Date,q=a.date&&l.isNumeric(a.date[0])?a.date[0]:parseInt(be.getFullYear()),Q=a.date&&l.isNumeric(a.date[1])?a.date[1]:parseInt(be.getMonth())+1,C=a.date&&l.isNumeric(a.date[2])?a.date[2]:parseInt(be.getDate()),O=a.date&&l.isNumeric(a.date[3])?a.date[3]:parseInt(be.getHours()),Z=a.date&&l.isNumeric(a.date[4])?a.date[4]:parseInt(be.getMinutes());a.date=[q,Q,C,O,Z,0],ge.innerHTML=q,fe.innerHTML=a.options.months[Q-1];var se=be.getMonth()==Q-1&&be.getFullYear()==q,ee=be.getDate(),be=new Date(q,Q,0,0,0),de=be.getDate(),be=new Date(q,Q-1,0,0,0),Oe=be.getDay()+1,Ke=a.options.startingDay||0;Oe=Oe-Ke,Le.innerHTML="";var we=document.createElement("tr");we.setAttribute("align","center"),Le.appendChild(we);for(var Se=0;Se<7;Se++){var Re=document.createElement("td");Re.classList.add("jcalendar-weekday"),Re.innerHTML=a.options.weekdays[Ke].substr(0,1),we.appendChild(Re),Ke++,Ke>6&&(Ke=0)}for(var Ke=0,re=0,ve=0;ve<6;ve++){var we=document.createElement("tr");we.setAttribute("align","center"),we.style.height="34px";for(var Se=0;Se<7;Se++){var Re=document.createElement("td");if(Re.classList.add("jcalendar-set-day"),Ke>=Oe&&Ke<Oe+de){re++,Re.innerHTML=re,re==C&&Re.classList.add("jcalendar-selected"),se&&ee==re&&(Re.style.fontWeight="bold");var Ce=E.now(new Date(q,Q-1,re),!0);if(a.options.validRange){if(!a.options.validRange[0]||Ce>=a.options.validRange[0])var He=!0;else var He=!1;if(!a.options.validRange[1]||Ce<=a.options.validRange[1])var Je=!0;else var Je=!1;He&&Je||Re.classList.add("jcalendar-disabled")}}we.appendChild(Re),Ke++}Le.appendChild(we)}a.options.time?Fe.style.display="":Fe.style.display="none",oe()},a.getMonths=function(){a.options.mode="months";var q=a.options.months;a.options.value;var Q=new Date,C=parseInt(Q.getFullYear()),O=parseInt(Q.getMonth())+1,Z=a.date&&l.isNumeric(a.date[0])?a.date[0]:C,se=a.date&&l.isNumeric(a.date[1])?a.date[1]:O;ge.innerHTML=a.date[0],fe.innerHTML=q[se-1];var ee=document.createElement("table");ee.setAttribute("width","100%");for(var de=null,be=0;be<12;be++){if(!(be%4)){var de=document.createElement("tr");de.setAttribute("align","center"),ee.appendChild(de)}var Oe=document.createElement("td");if(Oe.classList.add("jcalendar-set-month"),Oe.setAttribute("data-value",be+1),Oe.innerText=q[be],a.options.validRange){var we=Z+"-"+l.two(be+1);if(!a.options.validRange[0]||we>=a.options.validRange[0].substr(0,7))var Se=!0;else var Se=!1;if(!a.options.validRange[1]||we<=a.options.validRange[1].substr(0,7))var Re=!0;else var Re=!1;Se&&Re||Oe.classList.add("jcalendar-disabled")}be+1==se&&Oe.classList.add("jcalendar-selected"),C==Z&&be+1==O&&(Oe.style.fontWeight="bold"),de.appendChild(Oe)}Le.innerHTML='<tr><td colspan="7"></td></tr>',Le.children[0].children[0].appendChild(ee),oe()},a.getYears=function(){a.options.mode="years";for(var q=new Date,Q=q.getFullYear(),C=a.date&&l.isNumeric(a.date[0])?a.date[0]:parseInt(q.getFullYear()),O=[],Z=0;Z<25;Z++)O[Z]=parseInt(a.date[0])+(Z-12);var se=document.createElement("table");se.setAttribute("width","100%");for(var Z=0;Z<25;Z++){if(!(Z%5)){var ee=document.createElement("tr");ee.setAttribute("align","center"),se.appendChild(ee)}var de=document.createElement("td");de.classList.add("jcalendar-set-year"),de.innerText=O[Z],C==O[Z]&&de.classList.add("jcalendar-selected"),Q==O[Z]&&(de.style.fontWeight="bold"),ee.appendChild(de)}Le.innerHTML='<tr><td colspan="7"></td></tr>',Le.firstChild.firstChild.appendChild(se),oe()},a.setLabel=function(q,Q){return E.getDateString(q,Q)},a.fromFormatted=function(q,Q){return E.extractDateFromString(q,Q)};var z=function(q){var Q=l.findElement(q.target,"jcalendar-container");if(Q){var C=q.target.className;if(C=="jcalendar-prev")a.prev();else if(C=="jcalendar-next")a.next();else if(C=="jcalendar-month")a.getMonths();else if(C=="jcalendar-year")a.getYears();else if(C=="jcalendar-set-year")a.date[0]=q.target.innerText,a.options.type=="year-month-picker"?a.getMonths():a.getDays();else if(q.target.classList.contains("jcalendar-set-month")){var O=parseInt(q.target.getAttribute("data-value"));a.options.type=="year-month-picker"?a.update(q.target,O):(a.date[1]=O,a.getDays())}else C=="jcalendar-confirm"||C=="jcalendar-update"||C=="jcalendar-close"?a.close(null,!0):C=="jcalendar-backdrop"?a.close(!1,!1):C=="jcalendar-reset"?a.reset():q.target.classList.contains("jcalendar-set-day")&&q.target.innerText&&a.update(q.target)}else a.close(!1,!1)},ne=function(q){if(q.target.value&&q.target.value.length>3){var Q=E.extractDateFromString(q.target.value,a.options.format);Q&&a.setValue(Q)}},oe=function(){var q=k.querySelector(".jcalendar-selected");q&&q.classList.contains("jcalendar-disabled")?(Xe.setAttribute("disabled","disabled"),te.setAttribute("disabled","disabled"),me.setAttribute("disabled","disabled")):(Xe.removeAttribute("disabled"),te.removeAttribute("disabled"),me.removeAttribute("disabled")),typeof a.options.onupdate=="function"&&a.options.onupdate(M,a.getValue())},k=null,N=null,Y=null,J=null,ie=null,ge=null,fe=null,he=null,Le=null,Te=null,Fe=null,Ge=null,Xe=null,te=null,me=null,Ee=function(){M.tagName=="INPUT"&&M.value&&(u.value=M.value),N=document.createElement("div"),N.className="jcalendar-reset",Y=document.createElement("div"),Y.className="jcalendar-confirm",Te=document.createElement("div"),Te.className="jcalendar-controls",Te.style.borderBottom="1px solid #ddd",Te.appendChild(N),Te.appendChild(Y),J=document.createElement("div"),J.className="jcalendar-container",ie=document.createElement("div"),ie.className="jcalendar-content",J.appendChild(ie),M.tagName=="DIV"?(k=M,k.classList.add("jcalendar-inline")):(ie.appendChild(Te),k=document.createElement("div"),k.className="jcalendar"),k.classList.add("jcalendar-container"),k.appendChild(J);var q=document.createElement("div");q.className="jcalendar-table",ie.appendChild(q);var Q=document.createElement("td");Q.setAttribute("colspan","2"),Q.className="jcalendar-prev",ge=document.createElement("span"),ge.className="jcalendar-year",fe=document.createElement("span"),fe.className="jcalendar-month";var C=document.createElement("td");C.className="jcalendar-header",C.setAttribute("colspan","3"),C.appendChild(fe),C.appendChild(ge);var O=document.createElement("td");O.setAttribute("colspan","2"),O.className="jcalendar-next";var Z=document.createElement("thead"),se=document.createElement("tr");se.appendChild(Q),se.appendChild(C),se.appendChild(O),Z.appendChild(se),he=document.createElement("table"),Le=document.createElement("tbody"),he.setAttribute("cellpadding","0"),he.setAttribute("cellspacing","0"),he.appendChild(Z),he.appendChild(Le),q.appendChild(he),te=document.createElement("select"),te.className="jcalendar-select",te.onchange=function(){a.date[3]=this.value,typeof a.options.onupdate=="function"&&a.options.onupdate(M,a.getValue())};for(var ee=0;ee<24;ee++){var de=document.createElement("option");de.value=ee,de.innerHTML=l.two(ee),te.appendChild(de)}me=document.createElement("select"),me.className="jcalendar-select",me.onchange=function(){a.date[4]=this.value,typeof a.options.onupdate=="function"&&a.options.onupdate(M,a.getValue())};for(var ee=0;ee<60;ee++){var de=document.createElement("option");de.value=ee,de.innerHTML=l.two(ee),me.appendChild(de)}var be=document.createElement("div");be.className="jcalendar-controls",Fe=document.createElement("div"),Fe.className="jcalendar-time",Fe.style.maxWidth="140px",Fe.appendChild(te),Fe.appendChild(me),Xe=document.createElement("button"),Xe.setAttribute("type","button"),Xe.className="jcalendar-update",Ge=document.createElement("div"),Ge.style.flexGrow="10",Ge.appendChild(Xe),be.appendChild(Fe),M.tagName=="INPUT"&&be.appendChild(Ge),ie.appendChild(be);var Oe=document.createElement("div");Oe.className="jcalendar-backdrop",k.appendChild(Oe),M.addEventListener("keyup",ne),k.addEventListener("swipeleft",function(we){P.slideLeft(he,0,function(){a.next(),P.slideRight(he,1)}),we.preventDefault(),we.stopPropagation()}),k.addEventListener("swiperight",function(we){P.slideRight(he,0,function(){a.prev(),P.slideLeft(he,1)}),we.preventDefault(),we.stopPropagation()}),"ontouchend"in document.documentElement?(k.addEventListener("touchend",z),M.addEventListener("touchend",a.open)):(k.addEventListener("mouseup",z),M.addEventListener("mouseup",a.open)),E.hasEvents||(E.hasEvents=!0,document.addEventListener("keydown",E.keydown)),a.setOptions(u),M.tagName=="INPUT"?(M.parentNode.insertBefore(k,M.nextSibling),M.setAttribute("autocomplete","off"),M.classList.add("jcalendar-input"),M.value=a.setLabel(a.getValue(),a.options)):(a.getDays(),a.options.time&&(te.value=a.date[3],me.value=a.date[4])),a.options.opened==!0&&a.open(),a.options.controls==!1&&J.classList.add("jcalendar-hide-controls"),M.change=a.setValue,M.val=function(we){if(we===void 0)return a.getValue();a.setValue(we)},M.calendar=k.calendar=a};return Ee(),a};return E.keydown=function(M){var u=null;(u=E.current)&&(M.which==13?u.close(!1,!0):M.which==27&&u.close(!1,!1))},E.prettify=function(M,u){if(!u)var u={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};M.indexOf("GMT")===-1&&M.indexOf("Z")===-1&&(M+=" GMT");var a=new Date,z=new Date(M),ne=parseInt((a-z)/1e3/60);if(String.prototype.format=function(k){return this.replace("{0}",k)},ne==0)var oe=u.justNow;else if(ne<90)var oe=u.xMinutesAgo.format(ne);else if(ne<1440)var oe=u.xHoursAgo.format(Math.round(ne/60));else if(ne<20160)var oe=u.xDaysAgo.format(Math.round(ne/1440));else if(ne<43200)var oe=u.xWeeksAgo.format(Math.round(ne/10080));else if(ne<1036800)var oe=u.xMonthsAgo.format(Math.round(ne/43200));else var oe=u.xYearsAgo.format(Math.round(ne/525600));return oe},E.prettifyAll=function(){for(var M=document.querySelectorAll(".prettydate"),u=0;u<M.length;u++)M[u].getAttribute("data-date")?M[u].innerHTML=E.prettify(M[u].getAttribute("data-date")):M[u].innerHTML&&(M[u].setAttribute("title",M[u].innerHTML),M[u].setAttribute("data-date",M[u].innerHTML),M[u].innerHTML=E.prettify(M[u].innerHTML))},E.now=I.now,E.toArray=I.toArray,E.dateToNum=I.dateToNum,E.numToDate=I.numToDate,E.weekdays=I.weekdays,E.months=I.months,E.weekdaysShort=I.weekdaysShort,E.monthsShort=I.monthsShort,E.extractDateFromString=K.extractDateFromString,E.getDateString=K.getDateString,E}var ue=U();function je(){var E={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},M=function(u){return E[u]?E[u]:E.material};return M.get=function(u){return E[u]?E[u]:E},M.set=function(u,a){E[u]=a},M}var ce=je();function ye(E,M){var u={};u.options={};var a={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var z in a)M&&M.hasOwnProperty(z)?u.options[z]=M[z]:u.options[z]=a[z];E.classList.add("jtabs");var ne=null,oe=null,k=null;const N=function(fe){u.options.animation&&setTimeout(function(){let he=u.headers.children[fe].getBoundingClientRect();u.options.palette==="modern"?(k.style.width=he.width-4+"px",k.style.left=u.headers.children[fe].offsetLeft+2+"px"):(k.style.width=he.width+"px",k.style.left=u.headers.children[fe].offsetLeft+"px"),u.options.position==="bottom"?k.style.top="0px":k.style.bottom="0px"},50)};var Y=function(fe){typeof u.headers.scrollTo=="function"?u.headers.scrollTo({left:fe,behavior:"smooth"}):u.headers.scrollLeft=fe,fe<=1?ne.classList.add("disabled"):ne.classList.remove("disabled"),fe>=u.headers.scrollWidth-u.headers.offsetWidth?oe.classList.add("disabled"):oe.classList.remove("disabled"),u.headers.scrollWidth<=u.headers.offsetWidth?(ne.style.display="none",oe.style.display="none"):(ne.style.display="",oe.style.display="")};if(u.setBorder=N,u.open=function(fe){if(Array.from(u.content.children),!!u.content.children[fe]){for(var he=null,Le=0;Le<u.headers.children.length;Le++)u.headers.children[Le].classList.contains("jtabs-selected")&&(he=Le),u.headers.children[Le].classList.remove("jtabs-selected"),u.content.children[Le]&&u.content.children[Le].classList.remove("jtabs-selected");if(u.headers.children[fe].classList.add("jtabs-selected"),u.content.children[fe]&&u.content.children[fe].classList.add("jtabs-selected"),he!=fe&&typeof u.options.onchange=="function"&&u.content.children[fe]&&u.options.onchange(E,u,fe,u.headers.children[fe],u.content.children[fe]),u.options.hideHeaders==!0&&u.headers.children.length<3&&u.options.allowCreate==!1)u.headers.parentNode.style.display="none";else{u.headers.parentNode.style.display="";var Te=u.headers.children[fe].offsetLeft,Fe=Te+u.headers.children[fe].offsetWidth,Ge=u.headers.scrollLeft,Xe=Ge+u.headers.offsetWidth;Ge<=Te&&Xe>=Fe||Y(Te-1),N(fe)}}},u.selectIndex=function(fe){var he=Array.prototype.indexOf.call(u.headers.children,fe);return he>=0&&u.open(he),he},u.rename=function(fe,he){he||(he=prompt("New title",u.headers.children[fe].innerText)),u.headers.children[fe].innerText=he,N(u.getActive())},u.create=function(fe,he){if(typeof u.options.onbeforecreate=="function"){var Le=u.options.onbeforecreate(E);if(Le===!1)return!1;fe=Le}var Te=u.appendElement(fe);return typeof u.options.oncreate=="function"&&u.options.oncreate(E,Te),N(u.getActive()),Te},u.remove=function(fe){return u.deleteElement(fe)},u.nextNumber=function(){for(var fe=0,he=0;he<u.headers.children.length;he++){var Le=u.headers.children[he].innerText.match(/[0-9].*/);Le>fe&&(fe=parseInt(Le))}return fe?fe++:fe=1,fe},u.deleteElement=function(fe){let he=u.getActive();if(u.headers.children[fe])u.headers.removeChild(u.headers.children[fe]),u.content.removeChild(u.content.children[fe]);else return!1;if(he===fe)u.open(0);else{let Le=u.getActive()||0;N(Le)}typeof u.options.ondelete=="function"&&u.options.ondelete(E,fe)},u.appendElement=function(fe,he,Le,Te){if(!fe)var fe=prompt("Title?","");if(fe){var Fe=document.createElement("div"),Ge=document.createElement("div");if(Ge.innerHTML=fe,Ge.content=Fe,typeof Te>"u")u.content.appendChild(Fe),u.headers.insertBefore(Ge,u.headers.lastChild);else{let Xe=u.content.children[Te];Xe?u.content.insertBefore(Fe,Xe):u.content.appendChild(Fe),Xe=u.headers.children[Te]||u.headers.lastChild,u.headers.insertBefore(Ge,Xe)}return u.options.allowChangePosition&&Ge.setAttribute("draggable","true"),Le!==!1&&u.selectIndex(Ge),typeof he=="function"&&he(Fe,Ge),Fe}},u.getActive=function(){for(var fe=0;fe<u.headers.children.length;fe++)if(u.headers.children[fe].classList.contains("jtabs-selected"))return fe;return!1},u.updateContent=function(fe,he){if(typeof he!="string")var Le=he;else{var Le=document.createElement("div");Le.innerHTML=he}u.content.children[fe].classList.contains("jtabs-selected")&&he.classList.add("jtabs-selected"),u.content.replaceChild(he,u.content.children[fe]),N()},u.updatePosition=function(fe,he,Le,Te){if(fe>he?u.content.insertBefore(u.content.children[fe],u.content.children[he]):u.content.insertBefore(u.content.children[fe],u.content.children[he].nextSibling),Te!==!1)u.open(he);else{const Fe=u.getActive();he<Fe&&u.setBorder(Fe)}!Le&&typeof u.options.onchangeposition=="function"&&u.options.onchangeposition(u.headers,fe,he)},u.move=function(fe,he,Le,Te){fe>he?u.headers.insertBefore(u.headers.children[fe],u.headers.children[he]):u.headers.insertBefore(u.headers.children[fe],u.headers.children[he].nextSibling),u.updatePosition(fe,he,Le,Te)},u.setBorder=N,u.init=function(){E.innerHTML="",u.headers=document.createElement("div"),u.content=document.createElement("div"),u.headers.classList.add("jtabs-headers"),u.content.classList.add("jtabs-content"),u.options.palette?E.classList.add("jtabs-modern"):E.classList.remove("jtabs-modern"),u.options.padding&&(u.content.style.padding=parseInt(u.options.padding)+"px");var fe=document.createElement("div");fe.className="jtabs-headers-container",fe.appendChild(u.headers),u.options.maxWidth&&(fe.style.maxWidth=parseInt(u.options.maxWidth)+"px");var he=document.createElement("div");if(he.className="jtabs-controls",he.setAttribute("draggable","false"),fe.appendChild(he),u.options.position=="bottom"?(E.appendChild(u.content),E.appendChild(fe)):(E.appendChild(fe),E.appendChild(u.content)),u.options.allowCreate==!0){var Le=document.createElement("div");Le.className="jtabs-add",Le.onclick=function(){u.create()},he.appendChild(Le)}ne=document.createElement("div"),ne.className="jtabs-prev",ne.onclick=function(){Y(u.headers.scrollLeft-u.headers.offsetWidth)},he.appendChild(ne),oe=document.createElement("div"),oe.className="jtabs-next",oe.onclick=function(){Y(u.headers.scrollLeft+u.headers.offsetWidth)},he.appendChild(oe);for(var Te=0;Te<u.options.data.length;Te++){if(u.options.data[Te].titleElement)var Fe=u.options.data[Te].titleElement;else var Fe=document.createElement("div");if(u.options.data[Te].icon){var Ge=document.createElement("div"),Xe=document.createElement("i");Xe.classList.add("material-icons"),Xe.innerHTML=u.options.data[Te].icon,Ge.appendChild(Xe),Fe.appendChild(Ge)}if(u.options.data[Te].title){var te=document.createTextNode(u.options.data[Te].title);Fe.appendChild(te)}if(u.options.data[Te].width&&(Fe.style.width=u.options.data[Te].width),u.options.data[Te].contentElement)var me=u.options.data[Te].contentElement;else{var me=document.createElement("div");me.innerHTML=u.options.data[Te].content}u.headers.appendChild(Fe),u.content.appendChild(me)}k=document.createElement("div"),k.className="jtabs-border",u.headers.appendChild(k),u.options.animation&&E.classList.add("jtabs-animation"),u.headers.addEventListener("click",function(Ee){if(Ee.target.parentNode.classList.contains("jtabs-headers"))var q=Ee.target;else if(Ee.target.tagName=="I")var q=Ee.target.parentNode.parentNode;else var q=Ee.target.parentNode;var Q=u.selectIndex(q);typeof u.options.onclick=="function"&&u.options.onclick(E,u,Q,u.headers.children[Q],u.content.children[Q])}),u.headers.addEventListener("contextmenu",function(Ee){u.selectIndex(Ee.target)}),u.headers.children.length&&u.open(0),Y(0),u.options.allowChangePosition==!0&&w(u.headers,{direction:1,ondrop:function(Ee,q,Q){u.updatePosition(q,Q)}}),typeof u.options.onload=="function"&&u.options.onload(E,u)},E.children[0]&&E.children[0].children.length)for(var J=0;J<E.children[0].children.length;J++){var ie=u.options.data&&u.options.data[J]?u.options.data[J]:{};E.children[1]&&E.children[1].children[J]?(ie.titleElement=E.children[0].children[J],ie.contentElement=E.children[1].children[J]):ie.contentElement=E.children[0].children[J],u.options.data[J]=ie}var ge=!1;if(u.options.data)for(var J=0;J<u.options.data.length;J++)u.options.data[J].url&&(T({url:u.options.data[J].url,type:"GET",dataType:"text/html",index:J,success:function(he){u.options.data[this.index].content=he},complete:function(){u.init()}}),ge=!0);return ge||u.init(),E.tabs=u,u}function Me(E,M){if(E.color)return E.color.setOptions(M,!0);var u={type:"color"};u.options={};var a=null,z=null,ne=null,oe=null,k=null,N=null,Y=null;u.setOptions=function(C,O){var Z={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};C||(C={}),C&&!C.palette&&(C.palette=ce());for(var se in Z)C&&C.hasOwnProperty(se)?u.options[se]=C[se]:(typeof u.options[se]>"u"||O===!0)&&(u.options[se]=Z[se]);return oe&&(oe.innerHTML=u.options.resetLabel),k&&(k.innerHTML=u.options.doneLabel),u.options.palette&&Y&&Y.updateContent(0,he()),typeof u.options.value=="string"&&(E.value=u.options.value,E.tagName==="INPUT"&&(E.style.color=E.value,E.style.backgroundColor=E.value)),u.options.placeholder?E.setAttribute("placeholder",u.options.placeholder):E.getAttribute("placeholder")&&E.removeAttribute("placeholder"),u},u.select=function(C){var O=a.querySelector(".jcolor-selected");O&&O.classList.remove("jcolor-selected"),u.values[C]&&u.values[C].classList.add("jcolor-selected"),u.options.value=C},u.open=function(){if(!a.classList.contains("jcolor-focus")){V(u,!0),a.classList.add("jcolor-focus"),u.options.value&&u.select(u.options.value),ne.style.marginTop="",ne.style.marginLeft="";var C=ne.getBoundingClientRect(),O=l.getWindowWidth(),Z=l.getWindowHeight();if(O<800||u.options.fullscreen==!0?(ne.classList.add("jcolor-fullscreen"),P.slideBottom(ne,1),z.style.display="block"):(ne.classList.contains("jcolor-fullscreen")&&(ne.classList.remove("jcolor-fullscreen"),z.style.display=""),u.options.position?ne.style.position="fixed":ne.style.position="",C.left+C.width>O&&(ne.style.marginLeft=-1*(C.left+C.width-(O-20))+"px"),C.top+C.height>Z&&(ne.style.marginTop=-1*(C.top+C.height-(Z-20))+"px")),typeof u.options.onopen=="function"&&u.options.onopen(E,u),Y.setBorder(Y.getActive()),u.options.value){var se=fe(u.options.value);me.forEach(function(ee,de){ee.value=se[de],ee.dispatchEvent(new Event("input"))})}}},u.close=function(C){return a.classList.contains("jcolor-focus")&&(a.classList.remove("jcolor-focus"),z.style.display="",!C&&typeof u.options.onclose=="function"&&u.options.onclose(E,u),V(u,!1)),u.options.value},u.setValue=function(C){C||(C=""),C!=u.options.value&&(u.options.value=C,te=C,u.select(C),typeof u.options.onchange=="function"&&u.options.onchange(E,C,u),E.value!=u.options.value&&(E.value=u.options.value,E.tagName==="INPUT"&&(E.style.color=E.value,E.style.backgroundColor=E.value),typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value})),u.options.closeOnChange==!0&&u.close())},u.getValue=function(){return u.options.value};var J=function(C){var O=C.toString(16);return O.length===1?"0"+O:O},ie=function(C,O,Z){return"#"+J(C)+J(O)+J(Z)},ge=function(C){return parseInt("0x"+C)},fe=function(C){return[ge(C.substr(1,2)),ge(C.substr(3,2)),ge(C.substr(5,2))]},he=function(){var C=document.createElement("div");C.className="jcolor-grid",u.values=[];var O=document.createElement("table");O.setAttribute("cellpadding","7"),O.setAttribute("cellspacing","0");for(var Z=0;Z<u.options.palette.length;Z++){for(var se=document.createElement("tr"),ee=0;ee<u.options.palette[Z].length;ee++){var de=document.createElement("td"),be=u.options.palette[Z][ee];be.length<7&&be.substr(0,1)!=="#"&&(be="#"+be),de.style.backgroundColor=be,de.setAttribute("data-value",be),de.innerHTML="",se.appendChild(de),u.options.value==be&&de.classList.add("jcolor-selected"),u.values[be]=de}O.appendChild(se)}return C.appendChild(O),C},Le=document.createElement("canvas");Le.width=200,Le.height=160;var Te=Le.getContext("2d"),Fe=function(){var C=N.firstChild.getBoundingClientRect();Le.width=C.width-14,Ge()},Ge=function(){var C=Te.createLinearGradient(0,0,Le.width,0);C.addColorStop(0,"rgb(255,0,0)"),C.addColorStop(.15,"rgb(255,0,255)"),C.addColorStop(.33,"rgb(0,0,255)"),C.addColorStop(.49,"rgb(0,255,255)"),C.addColorStop(.67,"rgb(0,255,0)"),C.addColorStop(.84,"rgb(255,255,0)"),C.addColorStop(1,"rgb(255,0,0)"),Te.fillStyle=C,Te.fillRect(0,0,Le.width,Le.height),C=Te.createLinearGradient(0,0,0,Le.height),C.addColorStop(0,"rgba(255,255,255,1)"),C.addColorStop(.5,"rgba(255,255,255,0)"),C.addColorStop(.5,"rgba(0,0,0,0)"),C.addColorStop(1,"rgba(0,0,0,1)"),Te.fillStyle=C,Te.fillRect(0,0,Le.width,Le.height)},Xe=function(){var C=document.createElement("div");C.className="jcolor-hsl";var O=document.createElement("div");O.className="jcolor-point";var Z=document.createElement("div");Z.appendChild(Le),Z.appendChild(O),C.appendChild(Z);var se=function(ee,de,be){if(ee===1){var Oe=C.getBoundingClientRect(),we=de-Oe.left,Se=be-Oe.top;we<0&&(we=0),Se<0&&(Se=0),we>Oe.width&&(we=Oe.width),Se>Oe.height&&(Se=Oe.height),O.style.left=we+"px",O.style.top=Se+"px";var Re=Te.getImageData(we,Se,1,1).data;te=ie(Re[0],Re[1],Re[2])}};return C.addEventListener("mousedown",function(ee){se(ee.buttons,ee.clientX,ee.clientY)}),C.addEventListener("mousemove",function(ee){se(ee.buttons,ee.clientX,ee.clientY)}),C.addEventListener("touchmove",function(ee){se(1,ee.changedTouches[0].clientX,ee.changedTouches[0].clientY)}),C},te="",me=[],Ee=function(){if(te!=="")for(var C=0;C<me.length;C++){var O=fe(te);O[C]=0;var Z="linear-gradient(90deg, rgb(";Z+=O.join(", "),Z+="), rgb(",O[C]=255,Z+=O.join(", "),Z+="))",me[C].style.backgroundImage=Z}},q=function(){var C=document.createElement("div");C.className="jcolor-sliders";var O=document.createElement("div"),Z=function(be){var Oe=document.createElement("div");Oe.className="jcolor-sliders-input-container";var we=document.createElement("label");we.innerText=be;var Se=document.createElement("div");Se.className="jcolor-sliders-input-subcontainer";var Re=document.createElement("input");Re.type="range",Re.min=0,Re.max=255,Re.value=0,Oe.appendChild(we),Se.appendChild(Re);var Ke=document.createElement("div");return Ke.innerText=Re.value,Re.addEventListener("input",function(){Ke.innerText=Re.value}),Se.appendChild(Ke),Oe.appendChild(Se),O.appendChild(Oe),Re};me=[Z("Red"),Z("Green"),Z("Blue")],C.appendChild(O);var se=document.createElement("div");se.className="jcolor-sliders-final-color";var ee=document.createElement("div");ee.style.visibility="hidden",ee.innerText="a",se.appendChild(ee);var de=function(){var be=ie(parseInt(me[0].value),parseInt(me[1].value),parseInt(me[2].value));ee.innerText=be,ee.style.color=be,ee.style.removeProperty("visibility"),te=be};return me.forEach(function(be){be.addEventListener("input",function(){de(),Ee()})}),C.appendChild(se),C},Q=function(){u.setOptions(M),E.tagName=="INPUT"&&(E.classList.add("jcolor-input"),E.readOnly=!0),a=document.createElement("div"),a.className="jcolor",z=document.createElement("div"),z.className="jcolor-backdrop",a.appendChild(z),ne=document.createElement("div"),ne.className="jcolor-content";var C=document.createElement("div");C.className="jcolor-controls",ne.appendChild(C),oe=document.createElement("div"),oe.className="jcolor-reset",oe.innerHTML=u.options.resetLabel,C.appendChild(oe),k=document.createElement("div"),k.className="jcolor-close",k.innerHTML=u.options.doneLabel,C.appendChild(k),N=document.createElement("div"),ne.appendChild(N),Y=ye(N,{animation:!0,data:[{title:"Grid",contentElement:he()},{title:"Spectrum",contentElement:Xe()},{title:"Sliders",contentElement:q()}],onchange:function(O,Z,se){if(se===1)Fe();else{var ee=te!==""?te:u.getValue();if(se===2&&ee){var de=fe(ee);me.forEach(function(be,Oe){be.value=de[Oe],be.dispatchEvent(new Event("input"))})}}},palette:"modern"}),a.appendChild(ne),E.tagName=="INPUT"?E.parentNode.insertBefore(a,E.nextSibling):E.appendChild(a),a.addEventListener("click",function(O){if(O.target.tagName=="TD"){var Z=O.target.getAttribute("data-value");Z&&u.setValue(Z)}else O.target.classList.contains("jcolor-reset")?(u.setValue(""),u.close()):O.target.classList.contains("jcolor-close")?(Y.getActive()>0&&u.setValue(te),u.close()):O.target.classList.contains("jcolor-backdrop")?u.close():u.open()}),E.addEventListener("mouseup",function(O){u.open()}),window.addEventListener("resize",function(){a.classList.contains("jcolor-focus")&&Y.getActive()==1&&Fe()}),u.options.opened==!0&&u.open(),E.change=u.setValue,E.val=function(O){if(O===void 0)return u.getValue();u.setValue(O)},E.color=u,a.color=u};return u.toHex=function(C){var O=function(Z){return("0"+parseInt(Z).toString(16)).slice(-2)};if(C)return/^#[0-9A-F]{6}$/i.test(C)?C:(C=C.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),C&&C.length?"#"+O(C[1])+O(C[2])+O(C[3]):"")},Q(),u}function xe(){var E=function(M,u){var a={type:"contextmenu"};a.options={};var z={items:null,onclick:null};for(var ne in z)u&&u.hasOwnProperty(ne)?a.options[ne]=u[ne]:a.options[ne]=z[ne];M.classList.add("jcontextmenu"),a.open=function(N,Y){if(Y&&(a.options.items=Y,a.create(Y)),E.current&&E.current.close(),V(a,!0),M.classList.add("jcontextmenu-focus"),E.current=a,a.options.items&&a.options.items.length>0||M.children.length){if(N.target)if(N.changedTouches&&N.changedTouches[0])J=N.changedTouches[0].clientX,ie=N.changedTouches[0].clientY;else var J=N.clientX,ie=N.clientY;else var J=N.x,ie=N.y;var ge=M.getBoundingClientRect();if(window.innerHeight<ie+ge.height){var fe=ie-ge.height;fe<0&&(fe=0),M.style.top=fe+"px"}else M.style.top=ie+"px";window.innerWidth<J+ge.width?J-ge.width>0?M.style.left=J-ge.width+"px":M.style.left="10px":M.style.left=J+"px"}},a.isOpened=function(){return!!M.classList.contains("jcontextmenu-focus")},a.close=function(){M.classList.contains("jcontextmenu-focus")&&M.classList.remove("jcontextmenu-focus"),V(a,!1)},a.create=function(N){M.innerHTML="";var Y=oe();M.appendChild(Y);for(var J=0;J<N.length;J++){var ie=k(N[J]);M.appendChild(ie)}};function oe(){var N=document.createElement("div");N.classList.add("header"),N.addEventListener("click",function(ie){ie.preventDefault(),ie.stopPropagation()});var Y=document.createElement("a");Y.classList.add("title"),Y.innerHTML=h.translate("Menu"),N.appendChild(Y);var J=document.createElement("a");return J.classList.add("close"),J.innerHTML=h.translate("close"),J.addEventListener("click",function(ie){a.close()}),N.appendChild(J),N}function k(N){if(N.type&&(N.type=="line"||N.type=="divisor"))var Y=document.createElement("hr");else{var Y=document.createElement("div"),J=document.createElement("a");if(J.innerHTML=N.title,N.tooltip&&Y.setAttribute("title",N.tooltip),N.icon&&Y.setAttribute("data-icon",N.icon),N.id&&(Y.id=N.id),N.disabled?Y.className="jcontextmenu-disabled":N.onclick&&(Y.method=N.onclick,Y.addEventListener("mousedown",function(Ge){Ge.preventDefault()}),Y.addEventListener("mouseup",function(Ge){this.method(this,Ge)})),Y.appendChild(J),N.submenu){var ie=document.createElement("span");ie.innerHTML="&#9658;",Y.appendChild(ie),Y.classList.add("jcontexthassubmenu");var ge=document.createElement("div");ge.classList.add("jcontextmenu"),ge.setAttribute("tabindex","900");for(var fe=N.submenu,he=0;he<fe.length;he++){var Le=k(fe[he]);ge.appendChild(Le)}Y.appendChild(ge)}else if(N.shortcut){var Te=document.createElement("span");Te.innerHTML=N.shortcut,Y.appendChild(Te)}}return Y}return typeof a.options.onclick=="function"&&M.addEventListener("click",function(N){a.options.onclick(a,N)}),a.options.items&&a.create(a.options.items),window.addEventListener("mousewheel",function(){a.close()}),M.contextmenu=a,a};return E}var le=xe();function ze(){var E=function(M,u){if(M.dropdown)return M.dropdown.setOptions(u,!0);var a={type:"dropdown"};a.options={};var z=function(q,Q){q&&q.length&&(a.options.sortResults!==!1&&(typeof a.options.sortResults=="function"?q.sort(a.options.sortResults):q.sort(ne)),a.setData(q)),typeof a.options.onload=="function"&&a.options.onload(M,a,q,Q),Q&&k(Q),Q==null&&(a.options.value=""),M.value=a.options.value,a.options.opened==!0&&a.open()},ne=function(q,Q){var C,O;return typeof q=="string"?C=q:q.text?C=q.text:q.name&&(C=q.name),typeof Q=="string"?O=Q:Q.text?O=Q.text:Q.name&&(O=Q.name),typeof C=="string"||typeof O=="string"?(typeof C!="string"&&(C=""+C),typeof O!="string"&&(O=""+O),C.localeCompare(O)):C-O},oe=function(){a.value={};for(var q=0;q<a.items.length;q++)a.items[q].selected==!0&&(a.items[q].element&&a.items[q].element.classList.remove("jdropdown-selected"),a.items[q].selected=null);a.options.value="",M.value=""},k=function(q){if(oe(),q!==null)if(!q)typeof a.value[""]<"u"&&(a.value[""]="");else{Array.isArray(q)||(q=(""+q).split(";"));for(var Q=0;Q<q.length;Q++)a.value[q[Q]]=""}for(var Q=0;Q<a.items.length;Q++)typeof a.value[N(Q)]<"u"&&(a.items[Q].element&&a.items[Q].element.classList.add("jdropdown-selected"),a.items[Q].selected=!0,a.value[N(Q)]=Y(Q));a.options.value=Object.keys(a.value).join(";"),a.header.value=a.getText()},N=function(q,Q){if(a.options.format)var C="id";else var C="value";return a.items[q]?a.items[q].data[C]:""},Y=function(q,Q){if(a.options.format)var C="name";else var C="text";return a.items[q]?a.items[q].data[C]:""},J=function(){return Object.keys(a.value)},ie=function(){for(var q=[],Q=Object.keys(a.value),C=0;C<Q.length;C++)q.push(a.value[Q[C]]);return q};a.setOptions=function(q,Q){q||(q={});var C={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null};for(var O in C)q&&q.hasOwnProperty(O)?a.options[O]=q[O]:(typeof a.options[O]>"u"||Q===!0)&&(a.options[O]=C[O]);return(a.options.remoteSearch==!0||a.options.type==="searchbar")&&(a.options.autocomplete=!0),a.options.newOptions==!0?a.header.classList.add("jdropdown-add"):a.header.classList.remove("jdropdown-add"),a.options.autocomplete==!0?a.header.removeAttribute("readonly"):a.header.setAttribute("readonly","readonly"),a.options.placeholder?a.header.setAttribute("placeholder",a.options.placeholder):a.header.removeAttribute("placeholder"),M.classList.remove("jdropdown-searchbar"),M.classList.remove("jdropdown-picker"),M.classList.remove("jdropdown-list"),a.options.type=="searchbar"?M.classList.add("jdropdown-searchbar"):a.options.type=="list"?M.classList.add("jdropdown-list"):a.options.type=="picker"?M.classList.add("jdropdown-picker"):l.getWindowWidth()<800?a.options.autocomplete?(M.classList.add("jdropdown-searchbar"),a.options.type="searchbar"):(M.classList.add("jdropdown-picker"),a.options.type="picker"):(a.options.width?(M.style.width=a.options.width,M.style.minWidth=a.options.width):(M.style.removeProperty("width"),M.style.removeProperty("min-width")),M.classList.add("jdropdown-default"),a.options.type="default"),a.options.type=="searchbar"?ge.appendChild(Le):fe.insertBefore(Le,fe.firstChild),a.options.url&&!q.data?T({url:a.options.url,method:"GET",dataType:"json",success:function(Z){Z&&z(Z,a.options.value)}}):z(a.options.data,a.options.value),a};var ge=null,fe=null,he=null,Le=null,Te=null,Fe=null,Ge=null,Xe=function(){if(u||(u={}),M.tagName=="SELECT"){var q=E.extractFromDom(M,u);M=q.el,u=q.options}!u.placeholder&&M.getAttribute("placeholder")&&(u.placeholder=M.getAttribute("placeholder")),a.value={},a.items=[],a.groups=[],a.search="",a.results=null,M.classList.add("jdropdown"),ge=document.createElement("div"),ge.className="jdropdown-container-header",a.header=document.createElement("input"),a.header.className="jdropdown-header jss_object",a.header.type="text",a.header.setAttribute("autocomplete","off"),a.header.onfocus=function(){typeof a.options.onfocus=="function"&&a.options.onfocus(M)},a.header.onblur=function(){typeof a.options.onblur=="function"&&a.options.onblur(M)},a.header.onkeyup=function(Q){a.options.autocomplete==!0&&!Ge?(a.search!=a.header.value.trim()&&(Ge=setTimeout(function(){a.find(a.header.value.trim()),Ge=null},400)),M.classList.contains("jdropdown-focus")||a.open()):a.options.autocomplete||a.next(Q.key)},E.hasEvents||(E.hasEvents=!0,document.addEventListener("keydown",E.keydown)),fe=document.createElement("div"),fe.className="jdropdown-container",he=document.createElement("div"),he.className="jdropdown-content",Le=document.createElement("div"),Le.className="jdropdown-close",Le.textContent="Done",Te=document.createElement("div"),Te.className="jdropdown-reset",Te.textContent="x",Te.onclick=function(){a.reset(),a.close()},Fe=document.createElement("div"),Fe.className="jdropdown-backdrop",ge.appendChild(a.header),fe.appendChild(he),M.appendChild(ge),M.appendChild(fe),M.appendChild(Fe),a.setOptions(u),"ontouchsend"in document.documentElement?M.addEventListener("touchsend",E.mouseup):M.addEventListener("mouseup",E.mouseup),a.options.lazyLoading==!0&&b(he,{loadUp:a.loadUp,loadDown:a.loadDown}),he.onwheel=function(Q){Q.stopPropagation()},M.change=a.setValue,M.val=function(Q){if(Q===void 0)return a.getValue(!!a.options.multiple);a.setValue(Q)},M.dropdown=a};a.getUrl=function(){return a.options.url},a.setUrl=function(q,Q){a.options.url=q,T({url:a.options.url,method:"GET",dataType:"json",success:function(C){a.setData(C),typeof Q=="function"&&Q(a)}})},a.setId=function(q,Q){if(a.options.format)var C="id";else var C="value";typeof q=="object"?q[C]=Q:a.items[q].data[C]=Q};const te=function(q,Q){if(!q){let Z=a.options.autocomplete==!0?a.header.value:"";if(q=prompt(h.translate("Add A New Option"),Z),!q)return!1}if(Q||(Q=l.guid()),a.options.format)var C={id:Q,name:q};else var C={value:Q,text:q};if(typeof a.options.onbeforeinsert=="function"){let Z=a.options.onbeforeinsert(a,C);if(Z===!1)return!1;Z&&(C=Z)}a.options.data.push(C);var O=a.createItem(C);return he.appendChild(O.element),typeof a.options.oninsert=="function"&&a.options.oninsert(a,C,O),he.style.display=="none"&&(he.style.display=""),a.results&&a.results.push(O),C};a.add=function(q,Q){return typeof a.options.prompt=="function"?a.options.prompt.call(a,te):te(q,Q)},a.createItem=function(q,Q,C){a.options.format?(!q.id&&q.value!==void 0&&(q.id=q.value),!q.name&&q.text!==void 0&&(q.name=q.text)):(!q.value&&q.id!==void 0&&(q.value=q.id),!q.text&&q.name!==void 0&&(q.text=q.name));var O={};if(O.element=document.createElement("div"),O.element.className="jdropdown-item",O.element.indexValue=a.items.length,O.data=q,Q&&(O.group=Q),q.id&&O.element.setAttribute("id",q.id),q.disabled==!0&&O.element.setAttribute("data-disabled",!0),q.tooltip&&O.element.setAttribute("title",q.tooltip),q.image){var Z=document.createElement("img");Z.className="jdropdown-image",Z.src=q.image,q.title||Z.classList.add("jdropdown-image-small"),O.element.appendChild(Z)}else if(q.icon){var se=document.createElement("span");se.className="jdropdown-icon material-icons",se.innerText=q.icon,q.title||se.classList.add("jdropdown-icon-small"),q.color&&(se.style.color=q.color),O.element.appendChild(se)}else if(q.color){var ee=document.createElement("div");ee.className="jdropdown-color",ee.style.backgroundColor=q.color,O.element.appendChild(ee)}if(a.options.format)var de=q.name;else var de=q.text;var be=document.createElement("div");if(be.className="jdropdown-description",be.textContent=de||"&nbsp;",q.title){var Oe=document.createElement("div");Oe.className="jdropdown-title",Oe.innerText=q.title,be.appendChild(Oe)}if(a.options.format)var we=q.id;else var we=q.value;return a.value[we]&&(O.element.classList.add("jdropdown-selected"),O.selected=!0),a.items.push(O),O.element.appendChild(be),O},a.appendData=function(q){if(q.length){for(var Q=[],C=[],O=0;O<q.length;O++)q[O].group?(C[q[O].group]||(C[q[O].group]=[]),C[q[O].group].push(O)):Q.push(O);var Z=0,se=Object.keys(C);if(se.length>0)for(var O=0;O<se.length;O++){var ee=document.createElement("div");ee.className="jdropdown-group";var de=document.createElement("div");de.className="jdropdown-group-name",de.textContent=se[O];var be=document.createElement("i");be.className="jdropdown-group-arrow jdropdown-group-arrow-down",de.appendChild(be);var Oe=document.createElement("div");Oe.className="jdropdown-group-items";for(var we=0;we<C[se[O]].length;we++){var Se=a.createItem(q[C[se[O]][we]],ee,se[O]);(a.options.lazyLoading==!1||Z<200)&&(Oe.appendChild(Se.element),Z++)}ee.appendChild(de),ee.appendChild(Oe),a.groups.push(ee),Oe.children.length>0&&he.appendChild(ee)}if(Q.length)for(var O=0;O<Q.length;O++){var Se=a.createItem(q[Q[O]]);(a.options.lazyLoading==!1||Z<200)&&(he.appendChild(Se.element),Z++)}}},a.setData=function(q){if(oe(),he.textContent="",a.header.value="",a.items=[],q&&q.length){for(var Q=0;Q<q.length;Q++)typeof q[Q]!="object"&&(a.options.format?q[Q]={id:q[Q],name:q[Q]}:q[Q]={value:q[Q],text:q[Q]});a.appendData(q),a.options.data=q}else a.options.data=[];a.close()},a.getData=function(){return a.options.data},a.getPosition=function(q){for(var Q=0;Q<a.items.length;Q++)if(N(Q)==q)return Q;return!1},a.getText=function(q){var Q=ie();return q?Q:Q.join("; ")},a.getValue=function(q){var Q=J();return q?Q:Q.join(";")};var me=function(q){M.value!=a.options.value&&(M.value=a.options.value,typeof M.oninput=="function"&&M.oninput({type:"input",target:M,value:M.value})),typeof a.options.onchange=="function"&&a.options.onchange(M,a,q,a.options.value)};a.setValue=function(q){var Q=a.getValue();Array.isArray(q)&&(q=q.join(";")),Q!==q&&(k(q),me(Q))},a.resetSelected=function(){a.setValue(null)},a.selectIndex=function(C,Q){var C=parseInt(C);if(a.items&&a.items[C]&&(Q===!0||a.items[C].data.disabled!==!0))if(a.setCursor(C,!1),!a.options.multiple)a.items[C].selected?a.setValue(null):a.setValue(N(C)),a.close();else{var O=a.options.value;a.items[C].selected?(a.items[C].element.classList.remove("jdropdown-selected"),a.items[C].selected=!1,delete a.value[N(C)]):(a.items[C].element.classList.add("jdropdown-selected"),a.items[C].selected=!0,a.value[N(C)]=Y(C)),a.options.value=Object.keys(a.value).join(";"),a.options.autocomplete==!1&&(a.header.value=ie().join("; ")),me(O)}},a.selectItem=function(q){a.selectIndex(q.indexValue)};var Ee=function(q,Q){for(var C=0;C<Q.length;C++)if(a.options.format){if(Q[C].id==q)return!0}else if(Q[C].value==q)return!0;return!1};return a.find=function(q){if(a.search==q.trim())return!1;if(a.search=q,a.setCursor(),a.groups.length)for(var Q=0;Q<a.groups.length;Q++)a.groups[Q].lastChild.textContent="";if(he.textContent="",a.options.remoteSearch==!0){a.results=null;var C=a.options.url;let Oe={url:C,method:"GET",data:{q},dataType:"json",success:function(we){a.items=[];var Se=Object.keys(a.value);if(Se.length)for(var Re=0;Re<Se.length;Re++)Ee(Se[Re],we)||(a.options.format?we.unshift({id:Se[Re],name:a.value[Se[Re]]}):we.unshift({value:Se[Re],text:a.value[Se[Re]]}));a.appendData(we),we.length?he.style.display="":he.style.display="none",typeof a.options.onsearch=="function"&&a.options.onsearch(a,we)}};if(typeof a.options.onbeforesearch=="function"){let we=a.options.onbeforesearch(a,Oe);if(we===!1)return;typeof we=="object"&&(Oe=we)}T(Oe)}else{q=new RegExp(q,"gi");for(var O=[],Q=0;Q<a.items.length;Q++){var Z=Y(Q),se=a.items[Q].data.title||"",ee=a.items[Q].data.group||"",de=a.items[Q].data.synonym||"";de&&(de=de.join(" ")),(q==null||a.items[Q].selected==!0||Z.match(q)||se.match(q)||ee.match(q)||de.match(q))&&O.push(a.items[Q])}if(!O.length)he.style.display="none",a.results=null;else{he.style.display="",a.results=O;var be=O.length||0;a.options.lazyLoading==!0&&be>200&&(be=200);for(var Q=0;Q<be;Q++)a.results[Q].group?(a.results[Q].group.parentNode||he.appendChild(a.results[Q].group),a.results[Q].group.lastChild.appendChild(a.results[Q].element)):he.appendChild(a.results[Q].element)}}a.options.autofocus==!0&&a.first()},a.open=function(){if(!M.classList.contains("jdropdown-focus")){E.current=a,V(a,!0),M.classList.add("jdropdown-focus"),l.getWindowWidth()<800&&(a.options.type==null||a.options.type=="picker")&&P.slideBottom(fe,1),a.options.autocomplete==!0&&(a.header.value=a.search,a.header.focus());var q=J();if(q[0]){var Q=a.getPosition(q[0]);Q!==!1&&a.setCursor(Q)}if(!a.options.type||a.options.type=="default"){var C=M.getBoundingClientRect(),O=fe.getBoundingClientRect();a.options.position?(fe.style.position="fixed",window.innerHeight<C.bottom+O.height?(fe.style.top="",fe.style.bottom=window.innerHeight-C.top+1+"px"):(fe.style.top=C.bottom+"px",fe.style.bottom=""),fe.style.left=C.left+"px"):window.innerHeight<C.bottom+O.height?(fe.style.top="",fe.style.bottom=C.height+1+"px"):(fe.style.top="",fe.style.bottom=""),fe.style.minWidth=C.width+"px",a.options.maxWidth&&(fe.style.maxWidth=a.options.maxWidth),!a.items.length&&a.options.autocomplete==!0?he.style.display="none":he.style.display=""}}typeof a.options.onopen=="function"&&a.options.onopen(M)},a.close=function(q){return M.classList.contains("jdropdown-focus")&&(a.header.value=a.getText(),a.setCursor(),!q&&typeof a.options.onclose=="function"&&a.options.onclose(M),a.header.blur&&a.header.blur(),M.classList.remove("jdropdown-focus"),V(a,!1),E.current=null),a.getValue()},a.setCursor=function(q,Q){if(a.currentIndex!=null&&a.items&&a.items[a.currentIndex]&&a.items[a.currentIndex].element.classList.remove("jdropdown-cursor"),q==null)a.currentIndex=null;else if(q=parseInt(q),a.items[q].element.parentNode&&(a.items[q].element.classList.add("jdropdown-cursor"),a.currentIndex=q,Q!==!1&&a.items[a.currentIndex].element)){he.scrollTop;var C=a.items[a.currentIndex].element;he.scrollTop=C.offsetTop-C.scrollTop+C.clientTop-95}},a.resetCursor=a.setCursor,a.updateCursor=a.setCursor,a.reset=function(){a.setCursor(),a.setValue(null)},a.first=function(){a.options.lazyLoading===!0&&a.loadFirst();var q=he.querySelectorAll(".jdropdown-item");if(q.length){var Q=q[0].indexValue;a.setCursor(Q)}},a.last=function(){a.options.lazyLoading===!0&&a.loadLast();var q=he.querySelectorAll(".jdropdown-item");if(q.length){var Q=q[q.length-1].indexValue;a.setCursor(Q)}},a.next=function(q){var Q=null;if(q){if(q.length==1){var C=a.currentIndex||-1;q=q.toLowerCase();var O=null,Z=null,se=he.querySelectorAll(".jdropdown-item");if(se.length){for(var ee=0;ee<se.length;ee++)if(se[ee].indexValue>C&&(O=a.items[se[ee].indexValue])&&(Z=O.element.innerText[0])&&(Z=Z.toLowerCase(),q==Z)){Q=se[ee].indexValue;break}a.setCursor(Q)}}}else if(a.currentIndex==null||a.currentIndex==null)a.first();else{var de=a.items[a.currentIndex].element,be=de.nextElementSibling;be?(be.classList.contains("jdropdown-group")&&(be=be.lastChild.firstChild),Q=be.indexValue):de.parentNode.classList.contains("jdropdown-group-items")&&((be=de.parentNode.parentNode.nextElementSibling)&&(be.classList.contains("jdropdown-group")?be=be.lastChild.firstChild:be.classList.contains("jdropdown-item")?Q=be.indexValue:be=null),be&&(Q=be.indexValue)),Q!==null&&a.setCursor(Q)}},a.prev=function(){var q=null;if(a.currentIndex===null)a.first();else{var Q=a.items[a.currentIndex].element,C=Q.previousElementSibling;C?(C.classList.contains("jdropdown-group")&&(C=C.lastChild.lastChild),q=C.indexValue):Q.parentNode.classList.contains("jdropdown-group-items")&&((C=Q.parentNode.parentNode.previousElementSibling)&&(C.classList.contains("jdropdown-group")?C=C.lastChild.lastChild:C.classList.contains("jdropdown-item")?q=C.indexValue:C=null),C&&(q=C.indexValue))}q!==null&&a.setCursor(q)},a.loadFirst=function(){if(a.results)var q=a.results;else var q=a.items;var Q=q.length||0;a.options.lazyLoading==!0&&Q>200&&(Q=200),he.textContent="";for(var C=0;C<Q;C++)q[C].group?(q[C].group.parentNode||he.appendChild(q[C].group),q[C].group.lastChild.appendChild(q[C].element)):he.appendChild(q[C].element);he.scrollTop=0},a.loadLast=function(){if(a.results)var q=a.results;else var q=a.items;var Q=q.length;if(Q>200){Q=Q-200,he.textContent="";for(var C=Q;C<q.length;C++)q[C].group?(q[C].group.parentNode||he.appendChild(q[C].group),q[C].group.lastChild.appendChild(q[C].element)):he.appendChild(q[C].element);he.scrollTop=he.scrollHeight}},a.loadUp=function(){var q=!1;if(a.results)var Q=a.results;else var Q=a.items;var C=he.querySelectorAll(".jdropdown-item"),O=C[0].indexValue;O=a.items[O];var Z=Q.indexOf(O)-1;if(Z>0){for(var se=0;Z>0&&Q[Z]&&se<200;)Q[Z].group?(Q[Z].group.parentNode||he.insertBefore(Q[Z].group,he.firstChild),Q[Z].group.lastChild.insertBefore(Q[Z].element,Q[Z].group.lastChild.firstChild)):he.insertBefore(Q[Z].element,he.firstChild),Z--,se++;q=!0}return q},a.loadDown=function(){var q=!1;if(a.results)var Q=a.results;else var Q=a.items;var C=he.querySelectorAll(".jdropdown-item"),O=C[C.length-1].indexValue;O=a.items[O];var Z=Q.indexOf(O)+1;if(Z<Q.length){for(var se=0;Z<Q.length&&Q[Z]&&se<200;)Q[Z].group?(Q[Z].group.parentNode||he.appendChild(Q[Z].group),Q[Z].group.lastChild.appendChild(Q[Z].element)):he.appendChild(Q[Z].element),Z++,se++;q=!0}return q},Xe(),a};return E.keydown=function(M){var u=null;if(u=E.current){if(M.which==13||M.which==9)u.header.value&&u.currentIndex==null&&u.options.newOptions?u.add():(u.currentIndex==null&&u.options.autocomplete==!0&&u.header.value!=""&&u.find(u.header.value),u.selectIndex(u.currentIndex));else if(M.which==38)u.currentIndex==null?u.first():u.currentIndex>0&&u.prev(),M.preventDefault();else if(M.which==40)u.currentIndex==null?u.first():u.currentIndex+1<u.items.length&&u.next(),M.preventDefault();else if(M.which==36)u.first(),M.target.classList.contains("jdropdown-header")||M.preventDefault();else if(M.which==35)u.last(),M.target.classList.contains("jdropdown-header")||M.preventDefault();else if(M.which==27)u.close();else if(M.which==33){if(u.currentIndex==null)u.first();else if(u.currentIndex>0)for(var a=0;a<7;a++)u.prev();M.preventDefault()}else if(M.which==34){if(u.currentIndex==null)u.first();else if(u.currentIndex+1<u.items.length)for(var a=0;a<7;a++)u.next();M.preventDefault()}}},E.mouseup=function(M){var u=l.findElement(M.target,"jdropdown");if(u){var a=u.dropdown;if(M.target.classList.contains("jdropdown-header"))if(u.classList.contains("jdropdown-focus")&&u.classList.contains("jdropdown-default")){var z=u.getBoundingClientRect();if(M.changedTouches&&M.changedTouches[0]){var ne=M.changedTouches[0].clientX;M.changedTouches[0].clientY}else{var ne=M.clientX;M.clientY}z.width-(ne-z.left)<30?M.target.classList.contains("jdropdown-add")?a.add():a.close():a.options.autocomplete==!1&&a.close()}else a.open();else if(M.target.classList.contains("jdropdown-group-name")){var oe=M.target.nextSibling.children;if(M.target.nextSibling.style.display!="none")for(var k=0;k<oe.length;k++)oe[k].style.display!="none"&&a.selectItem(oe[k])}else M.target.classList.contains("jdropdown-group-arrow")?M.target.classList.contains("jdropdown-group-arrow-down")?(M.target.classList.remove("jdropdown-group-arrow-down"),M.target.classList.add("jdropdown-group-arrow-up"),M.target.parentNode.nextSibling.style.display="none"):(M.target.classList.remove("jdropdown-group-arrow-up"),M.target.classList.add("jdropdown-group-arrow-down"),M.target.parentNode.nextSibling.style.display=""):M.target.classList.contains("jdropdown-item")?a.selectItem(M.target):M.target.classList.contains("jdropdown-image")||M.target.classList.contains("jdropdown-description")?a.selectItem(M.target.parentNode):M.target.classList.contains("jdropdown-title")?a.selectItem(M.target.parentNode.parentNode):(M.target.classList.contains("jdropdown-close")||M.target.classList.contains("jdropdown-backdrop"))&&a.close()}},E.extractFromDom=function(M,u){var a=M;if(u||(u={}),M.getAttribute("multiple")&&(!u||u.multiple==null)&&(u.multiple=!0),M.getAttribute("placeholder")&&(!u||u.placeholder==null)&&(u.placeholder=M.getAttribute("placeholder")),M.getAttribute("data-autocomplete")&&(!u||u.autocomplete==null)&&(u.autocomplete=!0),(!u||u.width==null)&&(u.width=M.offsetWidth),M.value&&(!u||u.value==null)&&(u.value=M.value),!u||u.data==null){u.data=[];for(var z=0;z<M.children.length;z++)if(M.children[z].tagName=="OPTGROUP")for(var ne=0;ne<M.children[z].children.length;ne++)u.data.push({value:M.children[z].children[ne].value,text:M.children[z].children[ne].textContent,group:M.children[z].getAttribute("label")});else u.data.push({value:M.children[z].value,text:M.children[z].textContent})}(!u||u.onchange==null)&&(u.onchange=function(k,N,Y,J){u.multiple==!0?obj.items[N].classList.contains("jdropdown-selected")?a.options[N].setAttribute("selected","selected"):a.options[N].removeAttribute("selected"):a.value=J});var oe=document.createElement("div");return M.parentNode.insertBefore(oe,M),M.style.display="none",M=oe,{el:M,options:u}},E}var We=ze();function Ye(E,M){if(E.picker)return E.picker.setOptions(M,!0);var u={type:"picker"};u.options={};var a=null,z=null,ne=function(N){return N instanceof Element||N instanceof HTMLDocument},oe=function(){z.innerHTML="";for(var N=Object.keys(u.options.data),Y=0;Y<N.length;Y++){var J=document.createElement("div");J.classList.add("jpicker-item"),J.k=N[Y],J.v=u.options.data[N[Y]];var ie=u.getLabel(N[Y],J);ne(ie)?J.appendChild(ie):J.innerHTML=ie,z.appendChild(J)}};u.setOptions=function(N,Y){var J={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};N&&N.options&&(N.data=N.options);for(var ie in J)N&&N.hasOwnProperty(ie)?u.options[ie]=N[ie]:(typeof u.options[ie]>"u"||Y===!0)&&(u.options[ie]=J[ie]);return u.options.header===!1?a.style.display="none":a.style.display="",u.options.width?a.style.width=parseInt(u.options.width)+"px":a.style.width="",u.options.height?(z.style.maxHeight=u.options.height+"px",z.style.overflow="scroll"):z.style.overflow="",u.options.columns>0&&(u.options.grid?(z.classList.add("jpicker-grid"),z.style.gridTemplateColumns="repeat("+u.options.grid+", 1fr)"):(z.classList.add("jpicker-columns"),z.style.width=u.options.width?u.options.width:36*u.options.columns+"px")),isNaN(parseInt(u.options.value))&&(u.options.value=0),oe(),u.setValue(u.options.value),u},u.getValue=function(){return u.options.value},u.setValue=function(N,Y){if(u.setLabel(N),u.options.value=String(N),E.value!=u.options.value&&(E.value=u.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value})),z.children[N]&&z.children[N].getAttribute("type")!=="generic"&&u.close(),Y&&typeof u.options.onchange=="function"){var J=u.options.data[N];u.options.onchange(E,u,J,J,N,Y)}},u.getLabel=function(N,Y){var J=u.options.data[N]||null;return typeof u.options.render=="function"&&(J=u.options.render(J,Y)),J},u.setLabel=function(N){var Y;u.options.content?Y='<i class="material-icons">'+u.options.content+"</i>":Y=u.getLabel(N,null),ne(Y)?(a.innerHTML="",a.appendChild(Y)):a.innerHTML=Y},u.open=function(){if(!E.classList.contains("jpicker-focus")){V(u,!0),E.classList.add("jpicker-focus"),E.focus();var N=0,Y=0;z.style.marginLeft="";var J=a.getBoundingClientRect(),ie=z.getBoundingClientRect();window.innerHeight<J.bottom+ie.height||u.options.bottom?N=-1*(ie.height+4):N=J.height+4,u.options.right===!0&&(Y=-1*ie.width+J.width),ie.left+Y<0&&(Y=Y+ie.left+10),ie.left+ie.width>window.innerWidth&&(Y=-1*(10+ie.left+ie.width-window.innerWidth)),z.style.marginTop=parseInt(N)+"px",z.style.marginLeft=parseInt(Y)+"px",typeof u.options.onopen=="function"&&u.options.onopen(E,u)}},u.close=function(){E.classList.contains("jpicker-focus")&&(E.classList.remove("jpicker-focus"),V(u,!1),typeof u.options.onclose=="function"&&u.options.onclose(E,u))};var k=function(){E.classList.add("jpicker"),E.setAttribute("tabindex","900"),E.onmousedown=function(N){E.classList.contains("jpicker-focus")||u.open()},a=document.createElement("div"),a.classList.add("jpicker-header"),z=document.createElement("div"),z.classList.add("jpicker-content"),z.onclick=function(N){var Y=l.findElement(N.target,"jpicker-item");Y&&Y.parentNode===z&&u.setValue(Y.k,N)},E.appendChild(a),E.appendChild(z),E.value=M.value||0,u.setOptions(M),typeof u.options.onload=="function"&&u.options.onload(E,u),E.change=u.setValue,E.val=function(N){if(N===void 0)return u.getValue();u.setValue(N)},E.picker=u};return k(),u}function Be(E,M){var u={type:"toolbar"};u.options={};var a={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var z in a)M&&M.hasOwnProperty(z)?u.options[z]=M[z]:u.options[z]=a[z];!E&&M.app&&M.app.el&&(E=document.createElement("div"),M.app.el.appendChild(E));var ne=document.createElement("div");ne.classList.add("jtoolbar-item"),ne.classList.add("jtoolbar-arrow");var oe=document.createElement("div");oe.classList.add("jtoolbar-floating"),ne.appendChild(oe),u.selectItem=function(N){for(var Y=k.children,J=0;J<Y.length;J++)N!=Y[J]&&Y[J].classList.remove("jtoolbar-selected");N.classList.add("jtoolbar-selected")},u.hide=function(){P.slideBottom(E,0,function(){E.style.display="none"})},u.show=function(){E.style.display="",P.slideBottom(E,1)},u.get=function(){return E},u.setBadge=function(N,Y){k.children[N].children[1].firstChild.innerHTML=Y},u.destroy=function(){toolbar.remove(),E.innerHTML=""},u.update=function(N,Y){for(var J=0;J<k.children.length;J++){var ie=k.children[J];typeof ie.updateState=="function"&&ie.updateState(E,u,ie,N,Y)}for(var J=0;J<oe.children.length;J++){var ie=oe.children[J];typeof ie.updateState=="function"&&ie.updateState(E,u,ie,N,Y)}},u.create=function(N){k.innerHTML="";for(var Y=0;Y<N.length;Y++){var J=document.createElement("div");if(J.classList.add("jtoolbar-item"),N[Y].width&&(J.style.width=parseInt(N[Y].width)+"px"),N[Y].k&&(J.k=N[Y].k),N[Y].tooltip&&J.setAttribute("title",N[Y].tooltip),N[Y].id&&J.setAttribute("id",N[Y].id),N[Y].updateState&&(J.updateState=N[Y].updateState),N[Y].active&&J.classList.add("jtoolbar-active"),N[Y].disabled&&J.classList.add("jtoolbar-disabled"),N[Y].type=="select"||N[Y].type=="dropdown")Ye(J,N[Y]);else if(N[Y].type=="divisor")J.classList.add("jtoolbar-divisor");else if(N[Y].type=="label")J.classList.add("jtoolbar-label"),J.innerHTML=N[Y].content;else{var ie=document.createElement("i");if(typeof N[Y].class>"u")ie.classList.add("material-icons");else for(var ge=N[Y].class.split(" "),fe=0;fe<ge.length;fe++)ie.classList.add(ge[fe]);if(ie.innerHTML=N[Y].content?N[Y].content:"",J.appendChild(ie),u.options.badge==!0){var he=document.createElement("div");he.classList.add("jbadge");var Le=document.createElement("div");Le.innerHTML=N[Y].badge?N[Y].badge:"",he.appendChild(Le),J.appendChild(he)}if(N[Y].title)if(u.options.title==!0){var Te=document.createElement("span");Te.innerHTML=N[Y].title,J.appendChild(Te)}else J.setAttribute("title",N[Y].title);u.options.app&&N[Y].route&&(J.route=N[Y].route,J.onclick=function(){u.options.app.pages(this.route)},u.options.app.pages(N[Y].route,{toolbarItem:J,closed:!0})),typeof N[Y].render=="function"&&N[Y].render(J,N[Y])}N[Y].onclick&&(J.onclick=N[Y].onclick.bind(N[Y],E,u,J)),k.appendChild(J)}setTimeout(function(){u.refresh()},0)},u.open=function(){ne.classList.add("jtoolbar-arrow-selected"),E.getBoundingClientRect();var N=oe.getBoundingClientRect();N.bottom>window.innerHeight||u.options.bottom?oe.style.bottom="0":oe.style.removeProperty("bottom"),oe.style.right="0",ne.children[0].focus(),V(u,!0)},u.close=function(){ne.classList.remove("jtoolbar-arrow-selected"),V(u,!1)},u.refresh=function(){if(u.options.responsive==!0){var N=E.parentNode.getBoundingClientRect();u.options.maxWidth||(u.options.maxWidth=N.width);var Y=parseInt(u.options.maxWidth);for(ne.parentNode&&ne.parentNode.removeChild(ne);oe.firstChild;)k.appendChild(oe.firstChild);if(Y<k.offsetWidth)for(Y-=50;k.lastChild&&Y<k.offsetWidth;)oe.insertBefore(k.lastChild,oe.firstChild);oe.children.length>0&&k.appendChild(ne)}},u.setReadonly=function(N){N=N?"add":"remove",E.classList[N]("jtoolbar-disabled")},E.onclick=function(N){var Y=l.findElement(N.target,"jtoolbar-item");Y&&u.selectItem(Y),N.target.classList.contains("jtoolbar-arrow")&&u.open()},window.addEventListener("resize",function(){u.refresh()}),E.classList.add("jtoolbar"),E.innerHTML="",u.options.container==!0&&E.classList.add("jtoolbar-container");var k=document.createElement("div");return E.appendChild(k),u.options.app&&E.classList.add("jtoolbar-mobile"),u.create(u.options.items),E.toolbar=u,u}function dt(){var E=function(M,u){var a={type:"editor"};a.options={};var z={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var ne in z)u&&u.hasOwnProperty(ne)?a.options[ne]=u[ne]:a.options[ne]=z[ne];var oe=null,k=null,N=[];a.el=M,typeof a.options.onclick=="function"&&(M.onclick=function(re){a.options.onclick(M,a,re)}),M.classList.add("jeditor-container");var Y=document.createElement("div");Y.className="jsnippet",Y.setAttribute("contenteditable",!1);var J=document.createElement("div");if(J.className="jeditor-toolbar",a.editor=document.createElement("div"),a.editor.setAttribute("contenteditable",!0),a.editor.setAttribute("spellcheck",!1),a.editor.classList.add("jeditor"),a.options.placeholder&&a.editor.setAttribute("data-placeholder",a.options.placeholder),(a.options.maxHeight||a.options.height)&&(a.editor.style.overflowY="auto",a.options.maxHeight&&(a.editor.style.maxHeight=a.options.maxHeight),a.options.height&&(a.editor.style.height=a.options.height)),a.options.url)T({url:a.options.url,dataType:"html",success:function(re){a.editor.innerHTML=re,E.setCursor(a.editor,a.options.focus=="initial")}});else if(a.options.value)a.editor.innerHTML=a.options.value;else for(var ie=0;ie<M.children.length;ie++)a.editor.appendChild(M.children[ie]);M.innerHTML="";var ge=function(re){typeof a.options.onchange=="function"&&a.options.onchange(M,a,re),a.options.value=a.getData(),M.value!=a.options.value&&(M.value=a.options.value,typeof M.oninput=="function"&&M.oninput({type:"input",target:M,value:M.value}))},fe=function(re){var ve=document.createElement("div");ve.innerHTML=re;var Ce=ve.querySelectorAll("img");if(Ce.length)for(var He=0;He<Ce.length;He++)a.addImage(Ce[He].src)},he=function(){var re=null;if(re=Y.children[0]){re.classList.contains("jslider-grid")||re.classList.add("jslider-grid");var ve=re.children.length;re.setAttribute("data-number",ve>4?4:ve),ve>4?re.setAttribute("data-total",ve-4):re.removeAttribute("data-total")}},Le=function(re){Y.innerHTML||a.appendSnippet({}),Y.children[0].appendChild(re),he()};a.appendSnippet=function(re){Y.innerHTML="";for(var ve=["image","title","description","host","url"],Ce=0;Ce<ve.length;Ce++){var He=document.createElement("div");if(He.className="jsnippet-"+ve[Ce],He.setAttribute("data-k",ve[Ce]),Y.appendChild(He),re[ve[Ce]])if(ve[Ce]=="image"){Array.isArray(re.image)||(re.image=[re.image]);for(var Je=0;Je<re.image.length;Je++){var Qe=document.createElement("img");Qe.src=re.image[Je],He.appendChild(Qe)}}else He.innerHTML=re[ve[Ce]]}a.editor.appendChild(document.createElement("br")),a.editor.appendChild(Y)},a.setData=function(re){typeof re=="object"?a.editor.innerHTML=re.content:a.editor.innerHTML=re,a.options.focus&&E.setCursor(a.editor,!0),N=[]},a.getFiles=function(){for(var re=a.editor.querySelectorAll(".jfile"),ve=[],Ce=0;Ce<re.length;Ce++)N[re[Ce].src]&&ve.push(N[re[Ce].src]);return ve},a.getText=function(){return a.editor.innerText},a.getData=function(re){if(re){var ve={content:""};if(Y.innerHTML){ve.snippet={};for(var Ce=0;Ce<Y.children.length;Ce++){var He=Y.children[Ce].getAttribute("data-k");if(He)if(He=="image"){ve.snippet.image||(ve.snippet.image=[]);for(var Je=0;Je<Y.children[Ce].children.length;Je++)ve.snippet.image.push(Y.children[Ce].children[Je].getAttribute("src"))}else ve.snippet[He]=Y.children[Ce].innerHTML}}var Qe=Object.keys(N);if(Qe.length){ve.files=[];for(var Ce=0;Ce<Qe.length;Ce++)ve.files.push(N[Qe[Ce]])}var ut=document.createElement("div");ut.innerHTML=a.editor.innerHTML;var ht=ut.querySelector(".jsnippet");ht&&ht.remove();var tt=ut.innerHTML;tt=tt.replace(/<br>/g,`
`),tt=tt.replace(/<\/div>/g,`</div>
`),tt=tt.replace(/<(?:.|\n)*?>/gm,""),ve.content=tt.trim(),Se("getData",ve)}else var ve=a.editor.innerHTML;return ve},a.reset=function(){a.editor.innerHTML="",Y.innerHTML="",N=[]},a.addPdf=function(re){if(re.result.substr(0,4)!="data")console.error("Invalid source");else{var ve=document.createElement("canvas");ve.width=60,ve.height=60;var Ce=new Image,He=ve.getContext("2d");He.drawImage(Ce,0,0,ve.width,ve.height),ve.toBlob(function(Je){var Qe=document.createElement("img");Qe.src=window.URL.createObjectURL(Je),Qe.title=re.name,Qe.className="jfile pdf",N[Qe.src]={file:Qe.src,extension:"pdf",content:re.result},document.execCommand("insertHtml",!1,Qe.outerHTML)})}},a.addImage=function(re,ve){if(a.options.acceptImages)if(re||(re=""),re.substr(0,4)!="data"&&!a.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(re.substr(0,4)=="data"){var Ce=re.split(";");Ce=Ce[0].split("/"),Ce=Ce[1]}else{var Ce=re.substr(re.lastIndexOf(".")+1);re=a.options.remoteParser+re}var He=new Image;He.onload=function(){var Qe=document.createElement("canvas");Qe.width=He.width,Qe.height=He.height;var ut=Qe.getContext("2d");ut.drawImage(He,0,0,Qe.width,Qe.height),Qe.toBlob(function(ht){var tt=document.createElement("img");tt.src=window.URL.createObjectURL(ht),tt.classList.add("jfile"),tt.setAttribute("tabindex","900"),tt.setAttribute("width",He.width),tt.setAttribute("height",He.height),N[tt.src]={file:tt.src,extension:Ce,content:Qe.toDataURL()},a.options.dropAsSnippet||ve?(Le(tt),N[tt.src].snippet=!0):document.execCommand("insertHtml",!1,tt.outerHTML),ge()})},He.src=re}},a.addFile=function(re){for(var ve=[],Ce=0;Ce<re.length;Ce++)if(re[Ce].size>a.options.maxFileSize)alert("The file is too big");else{var He=re[Ce].type.split("/");He[0]=="image"?He=1:He[1]=="pdf"?He=2:He=0,He?(ve[Ce]=new FileReader,ve[Ce].index=Ce,ve[Ce].type=He,ve[Ce].name=re[Ce].name,ve[Ce].date=re[Ce].lastModified,ve[Ce].size=re[Ce].size,ve[Ce].addEventListener("load",function(Je){Je.target.type==2?a.options.acceptFiles==!0&&a.addPdf(Je.target):a.addImage(Je.target.result)},!1),ve[Ce].readAsDataURL(re[Ce])):alert("The extension is not allowed")}},a.destroy=function(){a.editor.removeEventListener("mouseup",be),a.editor.removeEventListener("mousedown",Oe),a.editor.removeEventListener("mousemove",we),a.editor.removeEventListener("keyup",ee),a.editor.removeEventListener("keydown",de),a.editor.removeEventListener("dragstart",q),a.editor.removeEventListener("dragenter",Q),a.editor.removeEventListener("dragover",C),a.editor.removeEventListener("drop",O),a.editor.removeEventListener("paste",Ee),a.editor.removeEventListener("blur",Z),a.editor.removeEventListener("focus",se),M.editor=null,M.classList.remove("jeditor-container"),J.remove(),Y.remove(),a.editor.remove()},a.upload=function(){l.click(a.file)};const Te=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],Fe=["width","height","align","border","src","tabindex"],Ge=["color","font-weight","font-size","background","background-color","margin"],Xe=function(re){if(re.tagName&&Te.indexOf(re.tagName.toLowerCase())===-1&&re.innerText&&(re.innerHTML=re.innerText),re.attributes&&re.attributes.length){let ve=null,Ce=re.getAttribute("style");if(Ce){ve=[];let Je=Ce.split(";");for(let Qe=0;Qe<Je.length;Qe++){let ut=Je[Qe].trim().split(":");if(Ge.indexOf(ut[0].trim())>=0){let ht=ut.shift();ut=ut.join(":"),ve.push(ht+":"+ut)}}}re.tagName.toUpperCase()==="IMG"&&(!a.options.acceptImages||!re.src?re.parentNode.removeChild(re):(re.setAttribute("tabindex","900"),a.addImage(re.src)));let He=[];for(let Je=0;Je<re.attributes.length;Je++)He.push(re.attributes[Je].name);He.length&&He.forEach(function(Je){Fe.indexOf(Je)===-1?re.removeAttribute(Je):re.attributes&&re.attributes[ie]&&re.attributes[ie].value.indexOf("<")!==-1&&re.attributes[ie].value.replace("<","&#60;")}),re.style="",ve&&ve.length&&re.setAttribute("style",ve.join(";"))}if(re.children.length)for(let ve=re.children.length;ve>0;ve--)Xe(re.children[ve-1])};var te=function(re){var ve=window.getSelection(),Ce=document.createRange();Ce.selectNode(re),ve.addRange(Ce)},me=function(re){re&&(re=re.replace(new RegExp("<!--(.*?)-->","gsi"),""));var ve=new DOMParser,Ce=ve.parseFromString(re,"text/html");Xe(Ce);var He=document.createElement("div");return He.innerHTML=Ce.firstChild.innerHTML,He},Ee=function(re){if(a.options.filterPaste==!0){if(re.clipboardData||re.originalEvent.clipboardData)var ve=(re.originalEvent||re).clipboardData.getData("text/html"),Ce=(re.originalEvent||re).clipboardData.getData("text/plain"),He=(re.originalEvent||re).clipboardData.files;else if(window.clipboardData)var ve=window.clipboardData.getData("Html"),Ce=window.clipboardData.getData("Text"),He=window.clipboardData.files;if(He.length)a.addFile(He);else if(!ve)ve=Ce.split(`\r
`),re.target.innerText?(ve=ve.map(function(Qe){return"<div>"+Qe+"</div>"}),document.execCommand("insertText",!1,ve.join(""))):ve.map(function(Qe){var ut=document.createElement("div");ut.innerText=Qe,a.editor.appendChild(ut)});else{var Je=me(ve);document.execCommand("insertHtml",!1,Je.innerHTML)}re.preventDefault()}},q=function(re){k&&k.e&&re.preventDefault()},Q=function(re){k||a.options.dropZone==!1||(M.classList.add("jeditor-dragging"),re.preventDefault())},C=function(re){k||a.options.dropZone==!1||(oe&&clearTimeout(oe),oe=setTimeout(function(){M.classList.remove("jeditor-dragging")},100),re.preventDefault())},O=function(re){if(!(k||a.options.dropZone==!1)){var ve=null;document.caretRangeFromPoint?ve=document.caretRangeFromPoint(re.clientX,re.clientY):re.rangeParent&&(ve=document.createRange(),ve.setStart(re.rangeParent,re.rangeOffset));var Ce=window.getSelection();Ce.removeAllRanges(),Ce.addRange(ve),Ce.anchorNode.parentNode.focus();var He=(re.originalEvent||re).dataTransfer.getData("text/html"),Je=(re.originalEvent||re).dataTransfer.getData("text/plain"),Qe=(re.originalEvent||re).dataTransfer.files;Qe.length?a.addFile(Qe):Je&&fe(He),M.classList.remove("jeditor-dragging"),re.preventDefault()}},Z=function(re){Se("onevent",re),ge(re),typeof a.options.onblur=="function"&&a.options.onblur(M,a,re)},se=function(re){typeof a.options.onfocus=="function"&&a.options.onfocus(M,a,re)},ee=function(re){a.editor.innerHTML||(a.editor.innerHTML="<div><br></div>"),typeof a.options.onkeyup=="function"&&a.options.onkeyup(M,a,re)},de=function(re){if(Se("onevent",re),re.key=="Delete"&&re.target.tagName=="IMG"){var ve=re.target.parentNode;te(re.target),ve.classList.contains("jsnippet-image")&&he()}typeof a.options.onkeydown=="function"&&a.options.onkeydown(M,a,re)},be=function(re){if(k&&k.e&&(k.e.classList.remove("resizing"),k.e.changed==!0)){var ve=k.e.cloneNode();ve.width=parseInt(k.e.style.width)||k.e.getAttribute("width"),ve.height=parseInt(k.e.style.height)||k.e.getAttribute("height"),k.e.style.width="",k.e.style.height="",te(k.e),document.execCommand("insertHtml",!1,ve.outerHTML)}k=!1},Oe=function(re){var ve=function(Qe){var ut=Qe.getBoundingClientRect();ut.width-(re.clientX-ut.left)<40&&re.clientY-ut.top<40&&(Qe.innerHTML="",Qe.remove())};if(re.target.tagName=="IMG")if(re.target.style.cursor){var Ce=re.target.getBoundingClientRect();k={e:re.target,x:re.clientX,y:re.clientY,w:Ce.width,h:Ce.height,d:re.target.style.cursor},re.target.getAttribute("width")||re.target.setAttribute("width",Ce.width),re.target.getAttribute("height")||re.target.setAttribute("height",Ce.height);var He=window.getSelection();if(He.rangeCount)for(var Je=0;Je<He.rangeCount;Je++)He.removeRange(He.getRangeAt(Je));re.target.classList.add("resizing")}else k=!0;else re.target.classList.contains("jsnippet")?ve(re.target):re.target.parentNode.classList.contains("jsnippet")&&ve(re.target.parentNode),k=!0},we=function(re){if(re.target.tagName=="IMG"&&!re.target.parentNode.classList.contains("jsnippet-image")&&a.options.allowImageResize==!0&&re.target.getAttribute("tabindex")){var ve=re.target.getBoundingClientRect();re.clientY-ve.top<5?ve.width-(re.clientX-ve.left)<5?re.target.style.cursor="ne-resize":re.clientX-ve.left<5?re.target.style.cursor="nw-resize":re.target.style.cursor="n-resize":ve.height-(re.clientY-ve.top)<5?ve.width-(re.clientX-ve.left)<5?re.target.style.cursor="se-resize":re.clientX-ve.left<5?re.target.style.cursor="sw-resize":re.target.style.cursor="s-resize":ve.width-(re.clientX-ve.left)<5?re.target.style.cursor="e-resize":re.clientX-ve.left<5?re.target.style.cursor="w-resize":re.target.style.cursor=""}if(re.which==1&&k&&k.d){if(k.d=="e-resize"||k.d=="ne-resize"||k.d=="se-resize")if(k.e.style.width=k.w+(re.clientX-k.x),re.shiftKey){var Ce=(re.clientX-k.x)*(k.h/k.w);k.e.style.height=k.h+Ce}else var Ce=null;Ce||(k.d=="s-resize"||k.d=="se-resize"||k.d=="sw-resize")&&(re.shiftKey||(k.e.style.height=k.h+(re.clientY-k.y))),k.e.changed=!0}},Se=function(re,ve){if(a.options.extensions){var Ce=Object.keys(a.options.extensions);if(Ce.length)for(var He=0;He<Ce.length;He++)a.options.extensions[Ce[He]]&&typeof a.options.extensions[Ce[He]][re]=="function"&&a.options.extensions[Ce[He]][re].call(a,ve)}},Re=function(){if(a.options.extensions){var re=Object.keys(a.options.extensions);if(re.length)for(var ve=0;ve<re.length;ve++)a.options.extensions[re[ve]]&&typeof a.options.extensions[re[ve]]=="function"&&(a.options.extensions[re[ve]]=a.options.extensions[re[ve]](M,a))}};if(document.addEventListener("mouseup",be),document.addEventListener("mousemove",we),a.editor.addEventListener("mousedown",Oe),a.editor.addEventListener("keyup",ee),a.editor.addEventListener("keydown",de),a.editor.addEventListener("dragstart",q),a.editor.addEventListener("dragenter",Q),a.editor.addEventListener("dragover",C),a.editor.addEventListener("drop",O),a.editor.addEventListener("paste",Ee),a.editor.addEventListener("focus",se),a.editor.addEventListener("blur",Z),M.appendChild(a.editor),a.options.snippet&&a.appendSnippet(a.options.snippet),a.options.toolbar){if(Array.isArray(a.options.toolbar))var Ke={container:!0,responsive:!0,items:a.options.toolbar};else if(a.options.toolbar===!0)var Ke={container:!0,responsive:!0,items:[]};else var Ke=a.options.toolbar;Ke.items&&Ke.items.length||(Ke.items=E.getDefaultToolbar(a)),a.options.toolbarOnTop?(M.classList.add("toolbar-on-top"),M.insertBefore(J,M.firstChild)):(a.editor.style.padding="15px",M.appendChild(J)),Be(J,Ke),J.addEventListener("click",function(){a.editor.focus()})}return a.file=document.createElement("input"),a.file.style.display="none",a.file.type="file",a.file.setAttribute("accept","image/*"),a.file.onchange=function(){a.addFile(this.files)},M.appendChild(a.file),a.options.focus&&E.setCursor(a.editor,a.options.focus=="initial"),M.change=a.setData,M.val=function(re){if(re===void 0){var ve=M.getAttribute("data-html")!=="true";return a.getData(ve)}else a.setData(re)},Re(),M.editor=a,typeof a.options.onload=="function"&&a.options.onload(M,a,a.editor),a};return E.setCursor=function(M,u){M.focus(),document.execCommand("selectAll");var a=window.getSelection(),z=a.getRangeAt(0);if(u==!0)var ne=z.startContainer,oe=0;else var ne=z.endContainer,oe=ne.length;z.setStart(ne,oe),z.setEnd(ne,oe),a.removeAllRanges(),a.addRange(z)},E.getDefaultToolbar=function(M){var u=function(z,ne,oe){oe.color||(Me(oe,{onchange:function(k,N){oe.k==="color"?document.execCommand("foreColor",!1,N):document.execCommand("backColor",!1,N)}}),oe.color.open())},a=[];return a.push({content:"undo",onclick:function(){document.execCommand("undo")}}),a.push({content:"redo",onclick:function(){document.execCommand("redo")}}),a.push({type:"divisor"}),M.options.toolbarOnTop&&(a.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(z){return'<span style="font-family:'+z+'">'+z+"</span>"},onchange:function(z,ne,oe,k,N){document.execCommand("fontName",!1,k)}}),a.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(z){return'<span style="font-size:'+z+'">'+z+"</span>"},onchange:function(z,ne,oe,k,N){document.execCommand("fontSize",!1,parseInt(N)+1)}}),a.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(z){return'<i class="material-icons">'+z+"</i>"},onchange:function(z,ne,oe,k,N){var Y=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(Y[N])}}),a.push({type:"divisor"}),a.push({content:"format_color_text",k:"color",onclick:u}),a.push({content:"format_color_fill",k:"background-color",onclick:u})),a.push({content:"format_bold",onclick:function(z,ne,oe){document.execCommand("bold"),document.queryCommandState("bold")?oe.classList.add("selected"):oe.classList.remove("selected")}}),a.push({content:"format_italic",onclick:function(z,ne,oe){document.execCommand("italic"),document.queryCommandState("italic")?oe.classList.add("selected"):oe.classList.remove("selected")}}),a.push({content:"format_underline",onclick:function(z,ne,oe){document.execCommand("underline"),document.queryCommandState("underline")?oe.classList.add("selected"):oe.classList.remove("selected")}}),a.push({type:"divisor"}),a.push({content:"format_list_bulleted",onclick:function(z,ne,oe){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?oe.classList.add("selected"):oe.classList.remove("selected")}}),a.push({content:"format_list_numbered",onclick:function(z,ne,oe){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?oe.classList.add("selected"):oe.classList.remove("selected")}}),a.push({content:"format_indent_increase",onclick:function(z,ne,oe){document.execCommand("indent",!0,null),document.queryCommandState("indent")?oe.classList.add("selected"):oe.classList.remove("selected")}}),a.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),M.options.toolbarOnTop&&(a.push({type:"divisor"}),a.push({content:"photo",onclick:function(){M.upload()}}),a.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(z,ne){ne&&(ne.onmouseover=this.onmouseover,z=z.split("x"),ne.setAttribute("data-x",z[0]),ne.setAttribute("data-y",z[1]));var oe=document.createElement("div");return ne.style.margin="1px",ne.style.border="1px solid #ddd",oe},onmouseover:function(z){for(var ne=parseInt(z.target.getAttribute("data-x")),oe=parseInt(z.target.getAttribute("data-y")),k=0;k<z.target.parentNode.children.length;k++){var N=z.target.parentNode.children[k],Y=parseInt(N.getAttribute("data-x")),J=parseInt(N.getAttribute("data-y"));Y<=ne&&J<=oe?(N.style.backgroundColor="#cae1fc",N.style.borderColor="#2977ff"):(N.style.backgroundColor="",N.style.borderColor="#ddd")}},onchange:function(z,ne,oe){oe=oe.split("x");for(var k=document.createElement("table"),N=document.createElement("tbody"),Y=0;Y<=oe[1];Y++){for(var J=document.createElement("tr"),ie=0;ie<=oe[0];ie++){var ge=document.createElement("td");ge.innerHTML="",J.appendChild(ge)}N.appendChild(J)}k.appendChild(N),k.setAttribute("width","100%"),k.setAttribute("cellpadding","6"),k.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,k.outerHTML)}})),a},E}var W=dt();function Ne(){var E=function(M,u){var a={};a.options={};var z={type:"big",title:"Untitled",width:510,height:472};for(var ne in z)u&&u.hasOwnProperty(ne)?a.options[ne]=u[ne]:a.options[ne]=z[ne];var oe=function(){for(var Y=document.createElement("div");M.children[0];)Y.appendChild(M.children[0]);for(a.content=document.createElement("div"),a.content.className="jfloating_content",a.content.innerHTML=M.innerHTML;Y.children[0];)a.content.appendChild(Y.children[0]);a.container=document.createElement("div"),a.container.className="jfloating",a.container.appendChild(a.content),a.options.title?a.container.setAttribute("title",a.options.title):a.container.classList.add("no-title"),a.options.width&&(a.container.style.width=parseInt(a.options.width)+"px"),a.options.height&&(a.container.style.height=parseInt(a.options.height)+"px"),M.innerHTML="",M.appendChild(a.container)},k=function(){a.container&&a.container.addEventListener("click",function(Y){var J=Y.target.getBoundingClientRect();if(Y.target.classList.contains("jfloating")){if(Y.changedTouches&&Y.changedTouches[0])var ie=Y.changedTouches[0].clientX,ge=Y.changedTouches[0].clientY;else var ie=Y.clientX,ge=Y.clientY;J.width-(ie-J.left)<50&&ge-J.top<50?setTimeout(function(){a.close()},100):a.setState()}})},N=function(){a.container.classList.add("jfloating-"+a.options.type)};return a.state={isMinized:!1},a.setState=function(){a.state.isMinized?a.container.classList.remove("jfloating-minimized"):a.container.classList.add("jfloating-minimized"),a.state.isMinized=!a.state.isMinized},a.close=function(){Components.elements.splice(E.elements.indexOf(a.container),1),a.updatePosition(),M.remove()},a.updatePosition=function(){for(var Y=0;Y<E.elements.length;Y++){var J=E.elements[Y],ie=E.elements[Y-1];J.style.right=Y*(ie?ie.offsetWidth:J.offsetWidth)*1.01+"px"}},a.init=function(){oe(),k(),N(),E.elements.push(a.container),a.updatePosition(),M.floating=a},a.init(),a};return E.elements=[],E}var Ue=Ne();function jt(){const E=function(k){return!isNaN(k)&&k!==null&&(typeof k!="string"||k.trim()!=="")},M={between:function(k,N){return k>=N[0]&&k<=N[1]},"not between":function(k,N){return k<N[0]||k>N[1]},"<":function(k,N){return k<N[0]},"<=":function(k,N){return k<=N[0]},">":function(k,N){return k>N[0]},">=":function(k,N){return k>=N[0]},"=":function(k,N){return k==N[0]},"!=":function(k,N){return k!=N[0]}},u={"valid date":function(){return!0},"=":function(k,N){return k===N[0]},"!=":function(k,N){return k!==N[0]},"<":function(k,N){return k<N[0]},"<=":function(k,N){return k<=N[0]},">":function(k,N){return k>N[0]},">=":function(k,N){return k>=N[0]},between:function(k,N){return k>=N[0]&&k<=N[1]},"not between":function(k,N){return k<N[0]||k>N[1]}},a={contains:function(k,N){return k.includes(N[0])},"not contains":function(k,N){return!k.includes(N[0])},"begins with":function(k,N){return k.startsWith(N[0])},"ends with":function(k,N){return k.endsWith(N[0])},"=":function(k,N){return k===N[0]},"!=":function(k,N){return k!==N[0]},"valid email":function(k){var N=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return N.test(k)},"valid url":function(k){var N=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return N.test(k)}},z=function(k,N){return typeof z[N.type]=="function"?N.allowBlank&&(typeof k>"u"||k===""||k===null)?!0:z[N.type].call(this,k,N):null};z.url=function(k){var N=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!N.test(k)},z.email=function(k){var N=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(k&&N.test(k))},z.required=function(k){return!!(k&&k.trim())},z.empty=function(k){return typeof k>"u"||k===null||typeof k=="string"&&!k.toString().trim()},z["not exist"]=z.empty,z.notEmpty=function(k){return!z.empty(k)},z.exist=z.notEmpty,z.number=function(k,N){if(!E(k))return!1;if(!N||!N.criteria)return!0;if(!M[N.criteria])return!1;let Y=N.value.map(function(J){return parseFloat(J)});return M[N.criteria](k,Y)},z.login=function(k){let N=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(k&&N.test(k))},z.list=function(k,N){let Y=typeof k;if(Y!=="string"&&Y!=="number")return!1;let J;return typeof N.value[0]=="string"?J=N.value[0].split(","):J=N.value[0],Array.isArray(J)?J.findIndex(function(ge){return ge==k})>-1:!1};const ne=function(){let k=new Date;return k.setHours(0,0,0,0),k},oe={"one year ago":function(){let k=ne();return k.setFullYear(k.getFullYear()-1),k},"one month ago":function(){let k=ne();return k.setMonth(k.getMonth()-1),k},"one week ago":function(){let k=ne();return k.setDate(k.getDate()-7),k},yesterday:function(){let k=ne();return k.setDate(k.getDate()-1),k},today:ne,tomorrow:function(){let k=ne();return k.setDate(k.getDate()+1),k}};return z.date=function(k,N){if(E(k)&&k>0&&k<1e6&&(k=I.numToDate(k)),new Date(k)=="Invalid Date")return!1;if(!N||!N.criteria)return!0;if(!u[N.criteria])return!1;let Y=N.value.map(function(J){return typeof J=="string"&&oe[J]?oe[J]().getTime():new Date(J).getTime()});return u[N.criteria](new Date(k).getTime(),Y)},z.text=function(k,N){if(typeof k>"u"||k===null)k="";else if(typeof k!="string")return!1;return!N||!N.criteria?!0:a[N.criteria]?a[N.criteria](k,N.value):!1},z.textLength=function(k,N){return k=k.toString(),z.number(k.length,N)},z}var ot=jt();function Ie(){var E=function(M,u){var a={};a.options={};var z={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(N,Y){alert(Y)}};for(var ne in z)u&&u.hasOwnProperty(ne)?a.options[ne]=u[ne]:a.options[ne]=z[ne];a.options.validations||(a.options.validations={}),a.options.submitButton||(a.options.submitButton=M.querySelector("input[type=submit]")),a.options.submitButton&&a.options.url&&(a.options.submitButton.onclick=function(){a.save()}),a.options.validations.email||(a.options.validations.email=ot.email),a.options.validations.length||(a.options.validations.length=ot.length),a.options.validations.required||(a.options.validations.required=ot.required),a.setUrl=function(N){a.options.url=N},a.load=function(){T({url:a.options.url,method:"GET",dataType:"json",queue:!0,success:function(N){if(typeof a.options.onbeforeload=="function"){var Y=a.options.onbeforeload(M,N);Y&&(N=Y)}E.setElements(M,N),typeof a.options.onload=="function"&&a.options.onload(M,N)}})},a.save=function(){var N=a.validate();if(N)a.options.onerror(M,N);else{var Y=E.getElements(M,!0);if(typeof a.options.onbeforesave=="function"){var Y=a.options.onbeforesave(M,Y);if(Y===!1)return}T({url:a.options.url,method:"POST",dataType:"json",data:Y,success:function(J){typeof a.options.onsave=="function"&&a.options.onsave(M,Y,J)}})}},a.remove=function(){if(typeof a.options.onbeforeremove=="function"){var N=a.options.onbeforeremove(M,a);if(N===!1)return!1}T({url:a.options.url,method:"DELETE",dataType:"json",success:function(Y){typeof a.options.onremove=="function"&&a.options.onremove(M,a,Y),a.reset()}})};var oe=function(N){N.classList.add("error"),a.options.submitButton&&a.options.submitButton.setAttribute("disabled",!0);var Y=N.getAttribute("data-error")||"There is an error in the form";return N.setAttribute("title",Y),Y},k=function(N){var Y=!1;N.classList.remove("error"),N.removeAttribute("title");for(var J=M.querySelectorAll("input, select, textarea, div[name]"),ie=0;ie<J.length;ie++)J[ie].getAttribute("data-validation")&&J[ie].classList.contains("error")&&(Y=!0);a.options.submitButton&&(Y?a.options.submitButton.setAttribute("disabled",!0):a.options.submitButton.removeAttribute("disabled"))};return a.validateElement=function(N){var Y=!1,J=E.getValue(N),ie=N.getAttribute("data-validation");return typeof a.options.validations[ie]=="function"&&!a.options.validations[ie](J,N)?Y=oe(N):N.classList.contains("error")&&k(N),Y},a.reset=function(){for(var N=M.querySelectorAll("input, select, textarea, div[name]"),Y=0;Y<N.length;Y++)N[Y].getAttribute("name")&&(N[Y].type=="checkbox"||N[Y].type=="radio"?N[Y].checked=!1:typeof N[Y].val=="function"?N[Y].val(""):N[Y].value="")},a.validate=function(){for(var N=[],Y=M.querySelectorAll("input, select, textarea, div[name]"),J=0;J<Y.length;J++)if(Y[J].getAttribute("data-validation")){var ie=a.validateElement(Y[J]);ie&&N.push(ie)}return N.length>0?N.join("<br>"):!1},a.getError=function(){return!!a.validation()},a.setHash=function(){return a.getHash(E.getElements(M))},a.getHash=function(N){var Y=0,J,ie;if(N.length===0)return Y;for(J=0;J<N.length;J++)ie=N.charCodeAt(J),Y=(Y<<5)-Y+ie,Y|=0;return Y},a.isChanged=function(){var N=a.setHash();return a.options.currentHash!=N},a.resetTracker=function(){a.options.currentHash=a.setHash(),a.options.ignore=!1},a.setIgnore=function(N){a.options.ignore=!!N},setTimeout(function(){a.options.currentHash=a.setHash()},1e3),M.addEventListener("keyup",function(N){N.target.getAttribute("data-validation")&&a.validateElement(N.target)}),E.hasEvents||(window.addEventListener("beforeunload",function(N){if(a.isChanged()&&a.options.ignore==!1){var Y=a.options.message?a.options.message:"o/";return Y?(typeof N>"u"&&(N=window.event),N&&(N.returnValue=Y),Y):void 0}}),E.hasEvents=!0),M.form=a,a};return E.getValue=function(M){var u=null;if(M.type=="checkbox")M.checked==!0&&(u=M.value||!0);else if(M.type=="radio")M.checked==!0&&(u=M.value);else if(M.type=="file")u=M.files;else if(M.tagName=="select"&&M.multiple==!0){u=[];for(var a=M.querySelectorAll("options[selected]"),z=0;z<a.length;z++)u.push(a[z].value)}else typeof M.val=="function"?u=M.val():u=M.value||"";return u},E.getElements=function(M,u){for(var a={},z=null,ne=M.querySelectorAll("input, select, textarea, div[name]"),oe=0;oe<ne.length;oe++)(z=ne[oe].getAttribute("name"))&&(a[z]=E.getValue(ne[oe])||"");return u==!0?a:JSON.stringify(a)},E.setElements=function(M,u){for(var a=null,z=null,ne=M.querySelectorAll("input, select, textarea, div[name]"),oe=0;oe<ne.length;oe++){var k=ne[oe].getAttribute("type");if(a=ne[oe].getAttribute("name")){if(a=a.replace(new RegExp(/\[(.*?)\]/ig),".$1"),z=null,a.match(/\./)){var N=v.call(u,a)||"";typeof N<"u"&&(z=N)}else typeof u[a]<"u"&&(z=u[a]);z!==null&&(k=="checkbox"||k=="radio"?ne[oe].checked=!!z:k=="file"||(typeof ne[oe].val=="function"?ne[oe].val(z):ne[oe].value=z))}}},E}var De=Ie();function Pe(){var E=function(){var u=null,a=function(k){if(k.which==27)for(var N=document.querySelectorAll(".jmodal"),Y=0;Y<N.length;Y++)N[Y].parentNode.modal.close()},z=function(k){let N=k.composedPath();var Y=l.findElement(N[0],"jmodal");if(Y){var J=Y.getBoundingClientRect();if(k.changedTouches&&k.changedTouches[0])var ie=k.changedTouches[0].clientX,ge=k.changedTouches[0].clientY;else var ie=k.clientX,ge=k.clientY;J.width-(ie-J.left)<50&&ge-J.top<50&&Y.parentNode.modal.close()}u&&(u.element.style.cursor="auto",u=null)},ne=function(k){let N=k.composedPath();var Y=l.findElement(N[0],"jmodal");if(Y){var J=Y.getBoundingClientRect();if(k.changedTouches&&k.changedTouches[0])var ie=k.changedTouches[0].clientX,ge=k.changedTouches[0].clientY;else var ie=k.clientX,ge=k.clientY;J.width-(ie-J.left)<50&&ge-J.top<50||ge-J.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),u={left:J.left,top:J.top,x:k.clientX,y:k.clientY,width:J.width,height:J.height,element:Y})}},oe=function(k){if(u){if(k=k||window.event,k.buttons)var N=k.buttons;else if(k.button)var N=k.button;else var N=k.which;N?(u.element.style.top=u.top+(k.clientY-u.y)+u.height/2+"px",u.element.style.left=u.left+(k.clientX-u.x)+u.width/2+"px",u.element.style.cursor="move"):u.element.style.cursor="auto"}};document.addEventListener("keydown",a),document.addEventListener("mouseup",z),document.addEventListener("mousedown",ne),document.addEventListener("mousemove",oe)},M=function(u,a){var z={};z.options={};var ne={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var oe in ne)a&&a.hasOwnProperty(oe)?z.options[oe]=a[oe]:z.options[oe]=ne[oe];!z.options.title&&u.getAttribute("title")&&(z.options.title=u.getAttribute("title"));for(var k=document.createElement("div");u.children[0];)k.appendChild(u.children[0]);for(z.title=document.createElement("div"),z.title.className="jmodal_title",z.options.icon&&z.title.setAttribute("data-icon",z.options.icon),z.content=document.createElement("div"),z.content.className="jmodal_content",z.content.innerHTML=u.innerHTML;k.children[0];)z.content.appendChild(k.children[0]);if(z.container=document.createElement("div"),z.container.className="jmodal",z.container.appendChild(z.title),z.container.appendChild(z.content),z.options.padding&&(z.content.style.padding=z.options.padding),z.options.width&&(z.container.style.width=z.options.width),z.options.height&&(z.container.style.height=z.options.height),z.options.title){var N=document.createElement("h4");N.innerText=z.options.title,z.title.appendChild(N)}if(u.innerHTML="",u.style.display="none",u.appendChild(z.container),z.options.backdrop){var Y=document.createElement("div");Y.className="jmodal_backdrop",Y.onclick=function(){z.close()},u.appendChild(Y)}return z.open=function(){u.style.display="block";var J=z.container.getBoundingClientRect();l.getWindowWidth()<J.width?(z.container.style.top="",z.container.style.left="",z.container.classList.add("jmodal_fullscreen"),P.slideBottom(z.container,1)):z.options.backdrop&&(Y.style.display="block"),typeof z.options.onopen=="function"&&z.options.onopen(u,z)},z.resetPosition=function(){z.container.style.top="",z.container.style.left=""},z.isOpen=function(){return u.style.display!="none"},z.close=function(){z.isOpen()&&(u.style.display="none",z.options.backdrop&&(Y.style.display=""),z.container.classList.remove("jmodal_fullscreen"),typeof z.options.onclose=="function"&&z.options.onclose(u,z))},z.options.url?T({url:z.options.url,method:"GET",dataType:"text/html",success:function(J){z.content.innerHTML=J,z.options.closed||z.open(),typeof z.options.onload=="function"&&z.options.onload(z)}}):(z.options.closed||z.open(),typeof z.options.onload=="function"&&z.options.onload(z)),u.modal=z,E(),E=function(){},z};return M}var qe=Pe();function et(){var E=function(M){var u={};u.options={};var a={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var z in a)M&&M.hasOwnProperty(z)?u.options[z]=M[z]:u.options[z]=a[z];var ne=document.createElement("div");ne.className="jnotification",u.options.error&&ne.classList.add("jnotification-error");var oe=document.createElement("div");oe.className="jnotification-container",ne.appendChild(oe);var k=document.createElement("div");k.className="jnotification-header",oe.appendChild(k);var N=document.createElement("div");if(N.className="jnotification-image",k.appendChild(N),u.options.icon){var Y=document.createElement("img");Y.src=u.options.icon,N.appendChild(Y)}var J=document.createElement("div");if(J.className="jnotification-name",J.innerHTML=u.options.name,k.appendChild(J),u.options.closeable==!0){var ie=document.createElement("div");ie.className="jnotification-close",ie.onclick=function(){u.hide()},k.appendChild(ie)}var ge=document.createElement("div");ge.className="jnotification-date",k.appendChild(ge);var fe=document.createElement("div");if(fe.className="jnotification-content",oe.appendChild(fe),u.options.title){var he=document.createElement("div");he.className="jnotification-title",he.innerHTML=u.options.title,fe.appendChild(he)}var Le=document.createElement("div");if(Le.className="jnotification-message",Le.innerHTML=u.options.message,fe.appendChild(Le),u.show=function(){document.body.appendChild(ne),l.getWindowWidth()>800?P.fadeIn(ne):P.slideTop(ne,1)},u.hide=function(){l.getWindowWidth()>800?P.fadeOut(ne,function(){ne.parentNode&&(ne.parentNode.removeChild(ne),Te&&clearTimeout(Te))}):P.slideTop(ne,0,function(){ne.parentNode&&(ne.parentNode.removeChild(ne),Te&&clearTimeout(Te))})},u.show(),u.options.autoHide==!0)var Te=setTimeout(function(){u.hide()},u.options.timeout);return l.getWindowWidth()<800&&ne.addEventListener("swipeup",function(Fe){u.hide(),Fe.preventDefault(),Fe.stopPropagation()}),u};return E.isVisible=function(){var M=document.querySelector(".jnotification");return!!(M&&M.parentNode)},E}var rt=et();function at(E,M){var u={};u.options={};var a={value:0,onchange:null,width:null};for(var z in a)M&&M.hasOwnProperty(z)?u.options[z]=M[z]:u.options[z]=a[z];E.classList.add("jprogressbar"),E.setAttribute("tabindex",1),E.setAttribute("data-value",u.options.value);var ne=document.createElement("div");ne.style.width=u.options.value+"%",ne.style.color="#fff",E.appendChild(ne),u.options.width&&(E.style.width=u.options.width),u.setValue=function(k){k=parseInt(k),u.options.value=k,ne.style.width=k+"%",E.setAttribute("data-value",k+"%"),k<6?E.style.color="#000":E.style.color="#fff",u.options.value=k,typeof u.options.onchange=="function"&&u.options.onchange(E,k),E.value!=u.options.value&&(E.value=u.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))},u.getValue=function(){return u.options.value};var oe=function(k){if(k.which){var N=E.getBoundingClientRect();if(k.changedTouches&&k.changedTouches[0]){var Y=k.changedTouches[0].clientX;k.changedTouches[0].clientY}else{var Y=k.clientX;k.clientY}u.setValue(Math.round((Y-N.left)/N.width*100))}};return"touchstart"in document.documentElement?(E.addEventListener("touchstart",oe),E.addEventListener("touchend",oe)):(E.addEventListener("mousedown",oe),E.addEventListener("mousemove",oe)),E.change=u.setValue,E.val=function(k){if(k===void 0)return u.getValue();u.setValue(k)},E.progressbar=u,u}function pt(E,M){if(E.rating)return E.rating.setOptions(M,!0);var u={};u.options={},u.setOptions=function(z,ne){var oe={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var k in oe)z&&z.hasOwnProperty(k)?u.options[k]=z[k]:(typeof u.options[k]>"u"||ne===!0)&&(u.options[k]=oe[k]);E.innerHTML="";for(var N=0;N<u.options.number;N++){var Y=document.createElement("div");Y.setAttribute("data-index",N+1),Y.setAttribute("title",u.options.tooltip[N]),E.appendChild(Y)}if(u.options.value)for(var N=0;N<u.options.number;N++)N<u.options.value&&E.children[N].classList.add("jrating-selected");return u},u.setValue=function(z){for(var ne=0;ne<u.options.number;ne++)ne<z?E.children[ne].classList.add("jrating-selected"):(E.children[ne].classList.remove("jrating-over"),E.children[ne].classList.remove("jrating-selected"));u.options.value=z,typeof u.options.onchange=="function"&&u.options.onchange(E,z),E.value!=u.options.value&&(E.value=u.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))},u.getValue=function(){return u.options.value};var a=function(){u.setOptions(M),E.classList.add("jrating"),E.addEventListener("click",function(z){var ne=z.target.getAttribute("data-index");ne!=null&&(ne==u.options.value?u.setValue(0):u.setValue(ne))}),E.addEventListener("mouseover",function(z){for(var ne=z.target.getAttribute("data-index"),oe=0;oe<u.options.number;oe++)oe<ne?E.children[oe].classList.add("jrating-over"):E.children[oe].classList.remove("jrating-over")}),E.addEventListener("mouseout",function(z){for(var ne=0;ne<u.options.number;ne++)E.children[ne].classList.remove("jrating-over")}),E.change=u.setValue,E.val=function(z){if(z===void 0)return u.getValue();u.setValue(z)},E.rating=u};return a(),u}function mt(E,M){if(E.search)return E.search;var u=null,a=function(Y){if(Y.target.classList.contains("jsearch_item"))var J=Y.target;else var J=Y.target.parentNode;k.selectIndex(J),Y.preventDefault()},z=function(Y){if(typeof k.options.onsearch=="function"){var J=k.options.onsearch(k,Y);J&&(Y=J)}if(N.innerHTML="",!Y.length)E.style.display="";else{E.style.display="block";for(var ie=Y.length<11?Y.length:10,ge=0;ge<ie;ge++){if(typeof Y[ge]=="string")var fe=Y[ge],he=Y[ge];else{var fe=Y[ge].text;!fe&&Y[ge].name&&(fe=Y[ge].name);var he=Y[ge].value;!he&&Y[ge].id&&(he=Y[ge].id)}var Le=document.createElement("div");Le.setAttribute("data-value",he),Le.setAttribute("data-text",fe),Le.className="jsearch_item",Y[ge].id&&Le.setAttribute("id",Y[ge].id),k.options.forceSelect&&ge==0&&Le.classList.add("selected");var Te=document.createElement("img");Y[ge].image?Te.src=Y[ge].image:Te.style.display="none",Le.appendChild(Te);var Fe=document.createElement("div");Fe.innerHTML=fe,Le.appendChild(Fe),N.appendChild(Le)}}},ne=function(Y){if(Y!=k.terms)if(k.terms=Y,k.options.forceSelect?u=0:u=null,Array.isArray(k.options.data)){var J=function(ge){if(typeof ge=="string"){if((""+ge).toLowerCase().search(Y.toLowerCase())>=0)return!0}else for(var fe in ge){var he=ge[fe];if((""+he).toLowerCase().search(Y.toLowerCase())>=0)return!0}return!1},ie=k.options.data.filter(function(ge){return J(ge)});z(ie)}else T({url:k.options.data+Y,method:"GET",dataType:"json",success:function(ge){z(ge)}})},oe=null,k=function(Y){oe&&clearTimeout(oe),oe=setTimeout(function(){ne(Y)},500)};M.forceSelect===null&&(M.forceSelect=!0),k.options={data:M.data||null,input:M.input||null,searchByNode:M.searchByNode||null,onselect:M.onselect||null,forceSelect:M.forceSelect,onsearch:M.onsearch||null,onbeforesearch:M.onbeforesearch||null},k.selectIndex=function(Y){var J=Y.getAttribute("id"),ie=Y.getAttribute("data-text"),ge=Y.getAttribute("data-value"),fe=Y.children[0].src||"";typeof k.options.onselect=="function"&&k.options.onselect(k,ie,ge,J,fe),k.close()},k.open=function(){E.style.display="block"},k.close=function(){oe&&clearTimeout(oe),k.terms="",N.innerHTML="",E.style.display=""},k.isOpened=function(){return!!E.style.display},k.keydown=function(Y){k.isOpened()&&(Y.key=="Enter"?u!==null&&N.children[u]?(k.selectIndex(N.children[u]),Y.preventDefault()):k.close():Y.key==="ArrowUp"?(u!==null&&N.children[0]&&(N.children[u].classList.remove("selected"),!k.options.forceSelect&&u===0?u=null:(u=Math.max(0,u-1),N.children[u].classList.add("selected"))),Y.preventDefault()):Y.key==="ArrowDown"&&(u==null?u=-1:N.children[u].classList.remove("selected"),u<9&&N.children[u+1]&&u++,N.children[u].classList.add("selected"),Y.preventDefault()))},k.keyup=function(Y){if(!k.options.searchByNode&&k.options.input)if(k.options.input.tagName==="DIV")var J=k.options.input.innerText;else var J=k.options.input.value;else{var ie=l.getNode();if(ie)var J=ie.innerText}if(typeof k.options.onbeforesearch=="function"){var ge=k.options.onbeforesearch(k,J);if(ge)J=ge;else if(ge===!1)return}k(J)},k.blur=function(Y){k.close()},k.options.input&&(k.options.input.addEventListener("keyup",k.keyup),k.options.input.addEventListener("keydown",k.keydown),k.options.input.addEventListener("blur",k.blur));var N=document.createElement("div");return N.classList.add("jsearch_container"),N.onmousedown=a,E.appendChild(N),E.classList.add("jsearch"),E.search=k,k}function vt(E,M){var u={};if(u.options={},u.currentImage=null,M&&(u.options=M),E.setAttribute("tabindex","900"),u.options.items=[],!E.classList.contains("jslider")){if(E.classList.add("jslider"),E.classList.add("unselectable"),u.options.height&&(E.style.minHeight=parseInt(u.options.height)+"px"),u.options.width&&(E.style.width=parseInt(u.options.width)+"px"),u.options.grid){E.classList.add("jslider-grid");var a=E.children.length;a>4&&E.setAttribute("data-total",a-4),E.setAttribute("data-number",a>4?4:a)}var z=document.createElement("div");if(z.classList.add("jslider-counter"),E.children.length>0)for(var ne=0;ne<E.children.length;ne++){u.options.items.push(E.children[ne]);var oe=document.createElement("div");oe.onclick=function(){var ie=Array.prototype.slice.call(z.children).indexOf(this);u.show(u.currentImage=u.options.items[ie])},z.appendChild(oe)}var k=document.createElement("div");k.className="jslider-caption";var N=document.createElement("div"),Y=document.createElement("div");Y.className="jslider-close",Y.innerHTML="",Y.onclick=function(){u.close()},N.appendChild(k),N.appendChild(Y)}u.updateCounter=function(ie){for(var ge=0;ge<z.children.length;ge++)if(z.children[ge].classList.contains("jslider-counter-focus")){z.children[ge].classList.remove("jslider-counter-focus");break}z.children[ie].classList.add("jslider-counter-focus")},u.show=function(ie){if(!ie)var ie=E.children[0];E.classList.add("jslider-focus"),E.classList.remove("jslider-grid"),E.appendChild(N),E.appendChild(z);var ge=u.options.items.indexOf(ie);u.updateCounter(ge);for(var fe=0;fe<E.children.length;fe++)E.children[fe].style.display="";ie.style.display="block",ie.previousElementSibling?E.classList.add("jslider-left"):E.classList.remove("jslider-left"),ie.nextElementSibling&&ie.nextElementSibling.tagName=="IMG"?E.classList.add("jslider-right"):E.classList.remove("jslider-right"),u.currentImage=ie,u.currentImage.offsetHeight>u.currentImage.offsetWidth&&u.currentImage.classList.add("jslider-vertical"),N.children[0].innerText=u.currentImage.getAttribute("title")},u.open=function(){u.show(),typeof u.options.onopen=="function"&&u.options.onopen(E)},u.close=function(){E.classList.remove("jslider-focus"),E.classList.remove("jslider-left"),E.classList.remove("jslider-right"),u.options.grid&&E.classList.add("jslider-grid");for(var ie=0;ie<E.children.length;ie++)E.children[ie].style.display="";z.remove(),N.remove(),u.currentImage=null,typeof u.options.onclose=="function"&&u.options.onclose(E)},u.reset=function(){E.innerHTML=""},u.next=function(){var ie=u.currentImage.nextElementSibling;ie&&ie.tagName==="IMG"&&u.show(u.currentImage.nextElementSibling)},u.prev=function(){u.currentImage.previousElementSibling&&u.show(u.currentImage.previousElementSibling)};var J=function(ie){if(ie.target.tagName=="IMG")u.show(ie.target);else if(!ie.target.classList.contains("jslider-close")&&!(ie.target.parentNode.classList.contains("jslider-counter")||ie.target.classList.contains("jslider-counter"))){var ge=ie.offsetX||ie.changedTouches[0].clientX;ie.target.clientWidth-ge<40?u.next():ge<40&&u.prev()}};return"ontouchend"in document.documentElement?E.addEventListener("touchend",J):E.addEventListener("mouseup",J),E.addEventListener("swipeleft",function(ie){u.next(),ie.preventDefault(),ie.stopPropagation()}),E.addEventListener("swiperight",function(ie){u.prev(),ie.preventDefault(),ie.stopPropagation()}),E.addEventListener("keydown",function(ie){ie.which==27&&u.close()}),E.slider=u,u}function Ft(E,M){if(E.tags)return E.tags.setOptions(M,!0);var u={type:"tags"};u.options={};var a=function(){return!!(u.options.limit&&E.children.length>=u.options.limit)},z=null,ne=null;u.setOptions=function(te,me){var Ee={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var q in Ee)te&&te.hasOwnProperty(q)?u.options[q]=te[q]:(typeof u.options[q]>"u"||me===!0)&&(u.options[q]=Ee[q]);return u.options.placeholder?E.setAttribute("data-placeholder",u.options.placeholder):E.removeAttribute("data-placeholder"),E.placeholder=u.options.placeholder,u.setValue(u.options.value),Y(),u.options.search?ne||(ne=document.createElement("div"),E.parentNode.insertBefore(ne,E.nextSibling),z=mt(ne,{data:u.options.search,onselect:function(Q,C,O){u.selectIndex(C,O)}})):ne&&(z=null,ne.remove(),ne=null),u},u.add=function(te,me){if(typeof u.options.onbeforechange=="function"){var Ee=u.options.onbeforechange(E,u,u.options.value,te);if(Ee===!1)return!1;Ee!=null&&(te=Ee)}if(z&&z.close(),a())typeof u.options.onlimit=="function"?u.options.onlimit(u,u.options.limit):alert(h.translate("You reach the limit number of entries")+" "+u.options.limit);else{var q=l.getNode();if(q&&q.parentNode&&q.parentNode.classList.contains("jtags")&&q.nextSibling&&!(q.nextSibling.innerText&&q.nextSibling.innerText.trim()))Q=q.nextSibling;else{if(E.lastChild&&(E.lastChild.innerText.trim()||E.removeChild(E.lastChild)),!te||typeof te=="string")var Q=k(te,te,q);else for(var C=0;C<=te.length;C++)if(!a()){if(!te[C]||typeof te[C]=="string")var O=te[C]||"",Z=null;else var O=te[C].text,Z=te[C].value;var Q=k(O,Z)}N()}me&&oe(Q)}},u.setLimit=function(te){for(u.options.limit=te,E.children.length-te;E.children.length>te;)E.removeChild(E.lastChild)},u.remove=function(te){te.parentNode.removeChild(te),E.children.length?N():u.add("",!0),typeof u.options.onremoveitem=="function"&&u.options.onremoveitem(E,u,te)},u.getData=function(){for(var te=[],me=0;me<E.children.length;me++){var Ee=E.children[me].innerText.replace(`
`,""),q=E.children[me].getAttribute("data-value");q||(q=Ee),(Ee||q)&&te.push({text:Ee,value:q})}return te},u.getValue=function(te){var me=null;if(te!=null)me=E.children[te].getAttribute("data-value"),me||(me=E.children[te].innerText.replace(`
`,""));else{for(var Ee=[],q=0;q<E.children.length;q++)me=E.children[q].innerText.replace(`
`,""),me&&Ee.push(u.getValue(q));me=Ee.join(",")}return me},u.setValue=function(te){if(!te)u.reset();else if(E.value!=te)if(Array.isArray(te))u.add(te);else{var me=(""+te).trim(),Ee=ie(me);E.innerHTML="",u.add(Ee)}},u.reset=function(){E.classList.add("jtags-empty"),E.innerHTML="<div></div>",N()},u.isValid=function(){for(var te=0,me=0;me<E.children.length;me++)E.children[me].classList.contains("jtags_error")&&te++;return te==0},u.selectIndex=function(te,me){var Ee=l.getNode();Ee&&(Ee.innerText=te,me&&Ee.setAttribute("data-value",me),Ee.classList.remove("jtags_error"),a()||u.add("",!0))},u.search=function(te){te.innerText},u.destroy=function(){E.removeEventListener("mouseup",Te),E.removeEventListener("keydown",fe),E.removeEventListener("keyup",he),E.removeEventListener("paste",Le),E.removeEventListener("focus",Fe),E.removeEventListener("blur",Ge),E.parentNode.removeChild(E)};var oe=function(te){if(E.children.length){var me=document.createRange(),Ee=window.getSelection();if(!te)var te=E.childNodes[E.childNodes.length-1];me.setStart(te,te.length),me.collapse(!0),Ee.removeAllRanges(),Ee.addRange(me),E.scrollLeft=E.scrollWidth}},k=function(te,me,Ee){var q=document.createElement("div");return q.textContent=te||"",me&&q.setAttribute("data-value",me),Ee&&Ee.parentNode.classList.contains("jtags")?E.insertBefore(q,Ee.nextSibling):E.appendChild(q),q},N=function(){var te=u.getValue();te!=u.options.value&&(u.options.value=te,typeof u.options.onchange=="function"&&u.options.onchange(E,u,u.options.value),E.value!=u.options.value&&(E.value=u.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))),Y()},Y=function(){for(var te=0;te<E.children.length;te++)E.children[te].tagName==="DIV"&&(u.getValue(te)?(E.children[te].classList.add("jtags_label"),typeof u.options.validation=="function"&&u.getValue(te)?u.options.validation(E.children[te],E.children[te].innerText,E.children[te].getAttribute("data-value"))?E.children[te].classList.remove("jtags_error"):E.children[te].classList.add("jtags_error"):E.children[te].classList.remove("jtags_error")):E.children[te].classList.remove("jtags_label"));J()},J=function(){E.innerText.trim()?E.classList.remove("jtags-empty"):(!E.children.length||E.children[0].tagName==="BR")&&(E.innerHTML="",oe(k()))},ie=function(te){var me=[],Ee="";if(te=te.trim(),te){for(var q=0;q<te.length;q++)te[q]==","||te[q]==";"||te[q]==`
`?Ee&&(me.push(Ee.trim()),Ee=""):Ee+=te[q];Ee&&me.push(Ee)}return me},ge=0,fe=function(te){if(ge=window.getSelection().anchorOffset,J(),te.key==="Tab"||te.key===";"||te.key===","){var me=window.getSelection().anchorOffset;me>1&&(a()?typeof u.options.onlimit=="function"&&u.options.onlimit(u,u.options.limit):u.add("",!0)),te.preventDefault()}else if(te.key=="Enter"){if(!z||!z.isOpened()){var me=window.getSelection().anchorOffset;me>1&&(a()||u.add("",!0)),te.preventDefault()}}else te.key=="Backspace"&&E.children.length==1&&window.getSelection().anchorOffset<1&&te.preventDefault();z&&z.keydown(te),J()},he=function(te){if(te.which==39){var me=window.getSelection().anchorOffset;me>1&&me==ge&&u.add("",!0)}else te.which==13||te.which==38||te.which==40?te.preventDefault():z&&z.keyup(te);Y()},Le=function(te){if(te.clipboardData||te.originalEvent.clipboardData)var me=(te.originalEvent||te).clipboardData.getData("text/plain");else if(window.clipboardData)var me=window.clipboardData.getData("Text");var Ee=ie(me);if(typeof u.options.onbeforepaste=="function"){var q=u.options.onbeforepaste(E,u,Ee);if(q===!1)return te.preventDefault(),!1;q&&(Ee=q)}Ee.length>1?(u.add(Ee,!0),te.preventDefault()):Ee[0]&&(document.execCommand("insertText",!1,Ee[0]),te.preventDefault())},Te=function(te){if(te.target.parentNode&&te.target.parentNode.classList.contains("jtags")&&(te.target.classList.contains("jtags_label")||te.target.classList.contains("jtags_error"))){var me=te.target.getBoundingClientRect();me.width-(te.clientX-me.left)<16&&u.remove(te.target)}te.target==E&&oe()},Fe=function(){E.classList.contains("jtags-focus")||((!E.children.length||u.getValue(E.children.length-1))&&(a()||k("")),typeof u.options.onfocus=="function"&&u.options.onfocus(E,u,u.getValue()),E.classList.add("jtags-focus"))},Ge=function(){if(E.classList.contains("jtags-focus")){z&&z.close();for(var te=0;te<E.children.length-1;te++)u.getValue(te)||E.removeChild(E.children[te]);N(),E.classList.remove("jtags-focus"),typeof u.options.onblur=="function"&&u.options.onblur(E,u,u.getValue())}},Xe=function(){"touchend"in document.documentElement?E.addEventListener("touchend",Te):E.addEventListener("mouseup",Te),E.addEventListener("keydown",fe),E.addEventListener("keyup",he),E.addEventListener("paste",Le),E.addEventListener("focus",Fe),E.addEventListener("blur",Ge),E.setAttribute("contenteditable",!0),E.classList.add("jtags"),u.setOptions(M),typeof u.options.onload=="function"&&u.options.onload(E,u),E.change=u.setValue,E.val=function(te){if(te===void 0)return u.getValue();u.setValue(te)},E.tags=u};return Xe(),u}function Tt(E,M){var u={};u.options={};var a={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var z in a)M&&M.hasOwnProperty(z)?u.options[z]=M[z]:u.options[z]=a[z];u.options.multiple==!0&&E.setAttribute("data-multiple",!0),E.content=[],E.classList.add("jupload"),u.options.input==!0&&E.classList.add("input"),u.add=function(N){if(u.options.multiple==!1&&(E.content=[],E.innerText=""),u.options.type=="image"){var Y=document.createElement("img");Y.setAttribute("src",N.file),Y.setAttribute("tabindex",-1),E.getAttribute("name")||(Y.className="jfile",Y.content=N),E.appendChild(Y)}else{if(N.name)var J=N.name;else var J=N.file;var ie=document.createElement("div");ie.innerText=J||u.options.type,ie.classList.add("jupload-item"),ie.setAttribute("tabindex",-1),E.appendChild(ie)}N.content&&(N.file=l.guid()),E.content.push(N),typeof u.options.onchange=="function"&&u.options.onchange(E,N)},u.addFromFile=function(N){var Y=N.type.split("/");if(Y[0]==u.options.type){var J=new FileReader;J.addEventListener("load",function(ie){var ge={file:ie.srcElement.result,extension:N.name.substr(N.name.lastIndexOf(".")+1),name:N.name,size:N.size,lastmodified:N.lastModified,content:ie.srcElement.result};u.add(ge)}),J.readAsDataURL(N)}else alert(h.translate("This extension is not allowed"))},u.addFromUrl=function(N){if(N.substr(0,4)!="data"&&!u.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(N.substr(0,4)=="data"){var Y=N.split(";");Y=Y[0].split("/");var J=Y[0].replace("data:","");if(J==u.options.type){var ie={file:N,name:"",extension:Y[1],content:N};u.add(ie)}else alert(u.options.text.extensionNotAllowed)}else{var Y=N.substr(N.lastIndexOf(".")+1);N=u.options.remoteParser+N,T({url:N,type:"GET",dataType:"blob",success:function(fe){}})}};var ne=u.options.type+"/"+u.options.extension,oe=document.createElement("input");oe.type="file",oe.setAttribute("accept",ne),oe.onchange=function(){for(var N=0;N<this.files.length;N++)u.addFromFile(this.files[N])},u.options.multiple==!0&&oe.setAttribute("multiple",!0);var k=null;return E.addEventListener("click",function(N){k=null,!E.children.length||N.target===E?l.click(oe):N.target.parentNode==E&&(k=N.target)}),E.addEventListener("dblclick",function(N){l.click(oe)}),E.addEventListener("dragenter",function(N){E.style.border="1px dashed #000"}),E.addEventListener("dragleave",function(N){E.style.border="1px solid #eee"}),E.addEventListener("dragstop",function(N){E.style.border="1px solid #eee"}),E.addEventListener("dragover",function(N){N.preventDefault()}),E.addEventListener("keydown",function(N){if(k&&N.which==46){var Y=Array.prototype.indexOf.call(E.children,k);Y>=0&&(E.content.splice(Y,1),k.remove(),k=null)}}),E.addEventListener("drop",function(N){N.preventDefault(),N.stopPropagation();var Y=(N.originalEvent||N).dataTransfer.getData("text/html"),J=(N.originalEvent||N).dataTransfer.files;if(J.length)for(var ie=0;ie<N.dataTransfer.files.length;ie++)u.addFromFile(N.dataTransfer.files[ie]);else if(Y){u.options.multiple==!1&&(E.innerText="");var ge=document.createElement("div");ge.innerHTML=Y;var fe=ge.querySelectorAll("img");if(fe.length)for(var ie=0;ie<fe.length;ie++)u.addFromUrl(fe[ie].src)}return E.style.border="1px solid #eee",!1}),E.val=function(N){if(N===void 0)return E.content&&E.content.length?E.content:null;if(E.innerText="",E.content=[],N)if(Array.isArray(N))for(var Y=0;Y<N.length;Y++)typeof N[Y]=="string"?u.add({file:N[Y]}):u.add(N[Y]);else typeof N=="string"&&u.add({file:N})},E.upload=E.image=u,u}var Dt=R(195),Rt=R.n(Dt),gt={...h,...l,version:"5.6.5",setExtensions:function(E){if(typeof E=="object")for(var M=Object.keys(E),u=0;u<M.length;u++)gt[M[u]]=E[M[u]]},tracking:V,path:v,sorting:w,lazyLoading:b,ajax:T,animation:P,calendar:ue,color:Me,contextmenu:le,dropdown:We,editor:W,floating:Ue,form:De,mask:K,modal:qe,notification:rt,palette:ce,picker:Ye,progressbar:at,rating:pt,search:mt,slider:vt,tabs:ye,tags:Ft,toolbar:Be,upload:Tt,validations:ot};gt.image=Tt,gt.image.create=function(E){var M=document.createElement("img");return M.setAttribute("src",E.file),M.className="jfile",M.setAttribute("tabindex",-1),M.content=E,M},gt.tracker=De,gt.loading=P.loading,gt.sha512=Rt(),typeof document<"u"&&function(){if(typeof window.jSuitesStateControl>"u")window.jSuitesStateControl=[];else return;const E=function(te,me){return te[me.type]&&te[me.type]==me||te.component&&te.component==me?!0:te.parentNode?E(te.parentNode,me):!1},M=function(te){let me=window.jSuitesStateControl;if(me&&me.length>0)for(let Ee=0;Ee<me.length;Ee++)me[Ee]&&!E(te,me[Ee])&&me[Ee].close()};let u=15,a=!1,z={x:null,y:null},ne=document.createElement("div");ne.classList.add("jtooltip");const oe=function(te){return te.shadowRoot||te.tagName.includes("-")},k=function(te){let me,Ee,q=te.path||te.composedPath&&te.composedPath();return q?(Ee=q[0],Ee&&oe(Ee)&&!Ee.shadowRoot&&te.toElement&&(Ee=te.toElement)):(te.target&&oe(te.target)?me=te.target.shadowRoot:me=document,Ee=me.elementFromPoint(x,y)),Ee},N=function(te){if(te.changedTouches&&te.changedTouches[0])var me=te.changedTouches[0].clientX,Ee=te.changedTouches[0].clientY;else var me=te.clientX,Ee=te.clientY;let q=k(te),Q=q&&q.tagName==="DIV"&&q.getAttribute("contentEditable"),C=gt.findElement(q,"jpanel");if(C&&!C.classList.contains("readonly")&&!Q){let O=C.getBoundingClientRect(),Z=0;C.style.rotate&&(Z=parseFloat(C.style.rotate));let se="move";q.getAttribute("data-action")?se=q.getAttribute("data-action"):C.style.cursor?se="resize":C.style.cursor="move",a={action:se,a:Z,e:C,x:me,y:Ee,l:O.left,t:O.top,b:O.bottom,r:O.right,w:O.width,h:O.height,d:C.style.cursor,actioned:!1},C.style.width||(C.style.width=O.width+"px"),C.style.height||(C.style.height=O.height+"px")}else a=!1;M(q),he(te)},Y=function(te,me,Ee,q,Q,C){const O=Ee-te,Z=q-me,se=Q-te,ee=C-me;let de=Math.atan2(Z,O),Oe=Math.atan2(ee,se)-de;return Oe=Oe*(180/Math.PI),Oe<0&&(Oe+=360),Oe},J=function(te){a&&a.e&&(typeof a.e.refresh=="function"&&z.actioned&&a.e.refresh(),a.e.style.cursor=""),z={x:null,y:null},a=!1},ie=function(te){if(a){let C=te.clientX||te.pageX,O=te.clientY||te.pageY;if(z.x==null&&z.y==null&&(z.x=C,z.y=O),a.action==="move"){var me=C-z.x,Ee=O-z.y,q=a.e.offsetTop+Ee,Q=a.e.offsetLeft+me;a.e.style.top=q+"px",a.e.style.left=Q+"px",typeof a.e.refresh=="function"&&(z.actioned=!0,a.e.refresh("position",q,Q))}else if(a.action==="rotate"){let Z=a.l+a.w/2,se=a.t+a.h/2,ee=Y(Z,se,a.x,a.y,C,O);ee=ee+a.a%360,ee=Math.round(ee/2)*2,a.e.style.rotate=`${ee}deg`,typeof a.e.refresh=="function"&&(z.actioned=!0,a.e.refresh("rotate",ee))}else if(a.action==="resize"){let Z=null,se=null,ee=null,de=null;a.d=="e-resize"||a.d=="ne-resize"||a.d=="se-resize"?(ee=a.e.offsetWidth+(C-z.x),te.shiftKey&&(de=a.e.offsetHeight+(C-z.x)*(a.e.offsetHeight/a.e.offsetWidth))):(a.d==="w-resize"||a.d=="nw-resize"||a.d=="sw-resize")&&(se=a.e.offsetLeft+(C-z.x),ee=a.e.offsetLeft+a.e.offsetWidth-se,te.shiftKey&&(de=a.e.offsetHeight-(C-z.x)*(a.e.offsetHeight/a.e.offsetWidth))),a.d=="s-resize"||a.d=="se-resize"||a.d=="sw-resize"?de||(de=a.e.offsetHeight+(O-z.y)):(a.d==="n-resize"||a.d=="ne-resize"||a.d=="nw-resize")&&(Z=a.e.offsetTop+(O-z.y),de=a.e.offsetTop+a.e.offsetHeight-Z),Z&&(a.e.style.top=Z+"px"),se&&(a.e.style.left=se+"px"),ee&&(a.e.style.width=ee+"px"),de&&(a.e.style.height=de+"px"),typeof a.e.refresh=="function"&&(z.actioned=!0,a.e.refresh("dimensions",ee,de))}z.x=C,z.y=O}else{let C=k(te),O=gt.findElement(C,"jpanel");if(O){if(O.classList.contains("jpanel-controls")){let se=C.getAttribute("data-position");se?O.style.cursor=se:O.style.cursor=""}else if(O.getAttribute("tabindex")){let se=O.getBoundingClientRect();te.clientY-se.top<u?se.width-(te.clientX-se.left)<u?O.style.cursor="ne-resize":te.clientX-se.left<u?O.style.cursor="nw-resize":O.style.cursor="n-resize":se.height-(te.clientY-se.top)<u?se.width-(te.clientX-se.left)<u?O.style.cursor="se-resize":te.clientX-se.left<u?O.style.cursor="sw-resize":O.style.cursor="s-resize":se.width-(te.clientX-se.left)<u?O.style.cursor="e-resize":te.clientX-se.left<u?O.style.cursor="w-resize":O.style.cursor=""}}}};let ge=["n","ne","e","se","s","sw","w","nw","rotate"];ge.forEach(function(te,me){ge[me]=document.createElement("div"),ge[me].classList.add("jpanel-action"),te==="rotate"?ge[me].setAttribute("data-action","rotate"):(ge[me].setAttribute("data-action","resize"),ge[me].setAttribute("data-position",te+"-resize"))});let fe;const he=function(te){let me=k(te),Ee=gt.findElement(me,"jpanel");Ee&&!Ee.classList.contains("readonly")&&Ee.classList.contains("jpanel-controls")?(Ee.append(...ge),Ee.classList.contains("jpanel-rotate")||ge[ge.length-1].remove(),fe=Ee):Le()},Le=function(te){fe&&(ge.forEach(function(me){me.remove()}),fe=null)},Te=function(te){var Ee=k(te).getAttribute("data-tooltip");if(Ee){if(ne.innerText=Ee,te.changedTouches&&te.changedTouches[0])var q=te.changedTouches[0].clientX,Q=te.changedTouches[0].clientY;else var q=te.clientX,Q=te.clientY;ne.style.top=Q+"px",ne.style.left=q+"px",document.body.appendChild(ne)}else ne.innerText&&(ne.innerText="",document.body.removeChild(ne))},Fe=function(te){var me=document.activeElement;if(me&&typeof me.contextmenu=="function")me.contextmenu(te),te.preventDefault(),te.stopImmediatePropagation();else if(me=gt.findElement(te.target,function(q){return q.tagName&&q.getAttribute("aria-contextmenu-id")}),me){var Ee=document.querySelector("#"+me);Ee?(Ee.contextmenu.open(te),te.preventDefault(),te.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+me)}},Ge=function(te){let me=document.activeElement;me&&te.key==="Delete"&&typeof me.delete=="function"&&(me.delete(),te.preventDefault(),te.stopImmediatePropagation());let Ee=window.jSuitesStateControl;Ee&&Ee.length>0&&(me=Ee[Ee.length-1],me&&te.key==="Escape"&&typeof me.isOpened=="function"&&typeof me.close=="function"&&me.isOpened()&&(me.close(),te.preventDefault(),te.stopImmediatePropagation()))},Xe=function(te){(te.target.getAttribute("data-mask")||te.target.mask)&&gt.mask(te)};document.addEventListener("focusin",he),document.addEventListener("mouseup",J),document.addEventListener("mousedown",N),document.addEventListener("mousemove",ie),document.addEventListener("mouseover",Te),document.addEventListener("keydown",Ge),document.addEventListener("contextmenu",Fe),document.addEventListener("input",Xe)}();var St=gt})(),f=X.default}(),f})}(jsuites$1)),jsuites$1.exports}var hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,function(module,exports){if(!jSuites&&typeof commonjsRequire=="function")var jSuites=requireJsuites();(function(r,c){module.exports=c()})(self,function(){return function(){var __webpack_modules__={243:function(r){var c;r.exports=(function(){var f={765:function(X,j){var d;d=function(h){h.version="1.0.2";var F=Math;function V(xe,le){for(var ze=0,We=0;ze<xe.length;++ze)We=le*We+xe[ze];return We}function m(xe,le,ze,We,Ye){if(le===0)return ze;if(le===1)return We;for(var Be=2/xe,dt=We,W=1;W<le;++W)dt=We*W*Be+Ye*ze,ze=We,We=dt;return dt}function l(xe,le,ze,We,Ye){return function(Be,dt){if(We){if(Be===0)return We==1?-1/0:1/0;if(Be<0)return NaN}return dt===0?xe(Be):dt===1?le(Be):dt<0?NaN:m(Be,dt|=0,xe(Be),le(Be),Ye)}}var v,w,b,A,T,S,P,_,I,H,K,U,ue,je=function(){var xe=.636619772,le=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),ze=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),We=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),Ye=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function Be(ot){var Ie=0,De=0,Pe=0,qe=ot*ot;if(ot<8)Ie=(De=V(le,qe))/(Pe=V(ze,qe));else{var et=ot-.785398164;De=V(We,qe=64/qe),Pe=V(Ye,qe),Ie=F.sqrt(xe/ot)*(F.cos(et)*De-F.sin(et)*Pe*8/ot)}return Ie}var dt=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),W=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Ne=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),Ue=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function jt(ot){var Ie=0,De=0,Pe=0,qe=ot*ot,et=F.abs(ot)-2.356194491;return Math.abs(ot)<8?Ie=(De=ot*V(dt,qe))/(Pe=V(W,qe)):(De=V(Ne,qe=64/qe),Pe=V(Ue,qe),Ie=F.sqrt(xe/F.abs(ot))*(F.cos(et)*De-F.sin(et)*Pe*8/F.abs(ot)),ot<0&&(Ie=-Ie)),Ie}return function ot(Ie,De){if(De=Math.round(De),!isFinite(Ie))return isNaN(Ie)?Ie:0;if(De<0)return(De%2?-1:1)*ot(Ie,-De);if(Ie<0)return(De%2?-1:1)*ot(-Ie,De);if(De===0)return Be(Ie);if(De===1)return jt(Ie);if(Ie===0)return 0;var Pe=0;if(Ie>De)Pe=m(Ie,De,Be(Ie),jt(Ie),-1);else{for(var qe=!1,et=0,rt=0,at=1,pt=0,mt=2/Ie,vt=2*F.floor((De+F.floor(F.sqrt(40*De)))/2);vt>0;vt--)pt=vt*mt*at-et,et=at,at=pt,F.abs(at)>1e10&&(at*=1e-10,et*=1e-10,Pe*=1e-10,rt*=1e-10),qe&&(rt+=at),qe=!qe,vt==De&&(Pe=et);Pe/=rt=2*rt-at}return Pe}}(),ce=(v=.636619772,w=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),b=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),A=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),T=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),S=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),P=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),_=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),I=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),l(function(xe){var le=0,ze=0,We=0,Ye=xe*xe,Be=xe-.785398164;return xe<8?le=(ze=V(w,Ye))/(We=V(b,Ye))+v*je(xe,0)*F.log(xe):(ze=V(A,Ye=64/Ye),We=V(T,Ye),le=F.sqrt(v/xe)*(F.sin(Be)*ze+F.cos(Be)*We*8/xe)),le},function(xe){var le=0,ze=0,We=0,Ye=xe*xe,Be=xe-2.356194491;return xe<8?le=(ze=xe*V(S,Ye))/(We=V(P,Ye))+v*(je(xe,1)*F.log(xe)-1/xe):(ze=V(_,Ye=64/Ye),We=V(I,Ye),le=F.sqrt(v/xe)*(F.sin(Be)*ze+F.cos(Be)*We*8/xe)),le},0,1,-1)),ye=(H=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),K=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),U=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),ue=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function xe(le,ze){if((ze=Math.round(ze))===0)return function(Ue){return Ue<=3.75?V(H,Ue*Ue/14.0625):F.exp(F.abs(Ue))/F.sqrt(F.abs(Ue))*V(K,3.75/F.abs(Ue))}(le);if(ze===1)return function(Ue){return Ue<3.75?Ue*V(U,Ue*Ue/14.0625):(Ue<0?-1:1)*F.exp(F.abs(Ue))/F.sqrt(F.abs(Ue))*V(ue,3.75/F.abs(Ue))}(le);if(ze<0)return NaN;if(F.abs(le)===0)return 0;if(le==1/0)return 1/0;var We,Ye=0,Be=2/F.abs(le),dt=0,W=1,Ne=0;for(We=2*F.round((ze+F.round(F.sqrt(40*ze)))/2);We>0;We--)Ne=We*Be*W+dt,dt=W,W=Ne,F.abs(W)>1e10&&(W*=1e-10,dt*=1e-10,Ye*=1e-10),We==ze&&(Ye=dt);return Ye*=xe(le,0)/W,le<0&&ze%2?-Ye:Ye}),Me=function(){var xe=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),le=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),ze=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),We=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return l(function(Ye){return Ye<=2?-F.log(Ye/2)*ye(Ye,0)+V(xe,Ye*Ye/4):F.exp(-Ye)/F.sqrt(Ye)*V(le,2/Ye)},function(Ye){return Ye<=2?F.log(Ye/2)*ye(Ye,1)+1/Ye*V(ze,Ye*Ye/4):F.exp(-Ye)/F.sqrt(Ye)*V(We,2/Ye)},0,2,1)}();h.besselj=je,h.bessely=ce,h.besseli=ye,h.besselk=Me},d(typeof DO_NOT_EXPORT_BESSEL>"u"?j:{})},162:function(X){var j;X.exports=(j=function(d,h){var F=Array.prototype.concat,V=Array.prototype.slice,m=Object.prototype.toString;function l(I,H){var K=I>H?I:H;return d.pow(10,17-~~(d.log(K>0?K:-K)*d.LOG10E))}var v=Array.isArray||function(I){return m.call(I)==="[object Array]"};function w(I){return m.call(I)==="[object Function]"}function b(I){return typeof I=="number"&&I-I==0}function A(){return new A._init(arguments)}function T(){return 0}function S(){return 1}function P(I,H){return I===H?1:0}A.fn=A.prototype,A._init=function(I){if(v(I[0]))if(v(I[0][0])){w(I[1])&&(I[0]=A.map(I[0],I[1]));for(var H=0;H<I[0].length;H++)this[H]=I[0][H];this.length=I[0].length}else this[0]=w(I[1])?A.map(I[0],I[1]):I[0],this.length=1;else if(b(I[0]))this[0]=A.seq.apply(null,I),this.length=1;else{if(I[0]instanceof A)return A(I[0].toArray());this[0]=[],this.length=1}return this},A._init.prototype=A.prototype,A._init.constructor=A,A.utils={calcRdx:l,isArray:v,isFunction:w,isNumber:b,toVector:function(I){return F.apply([],I)}},A._random_fn=d.random,A.setRandom=function(I){if(typeof I!="function")throw new TypeError("fn is not a function");A._random_fn=I},A.extend=function(I){var H,K;if(arguments.length===1){for(K in I)A[K]=I[K];return this}for(H=1;H<arguments.length;H++)for(K in arguments[H])I[K]=arguments[H][K];return I},A.rows=function(I){return I.length||1},A.cols=function(I){return I[0].length||1},A.dimensions=function(I){return{rows:A.rows(I),cols:A.cols(I)}},A.row=function(I,H){return v(H)?H.map(function(K){return A.row(I,K)}):I[H]},A.rowa=function(I,H){return A.row(I,H)},A.col=function(I,H){if(v(H)){var K=A.arange(I.length).map(function(){return new Array(H.length)});return H.forEach(function(je,ce){A.arange(I.length).forEach(function(ye){K[ye][ce]=I[ye][je]})}),K}for(var U=new Array(I.length),ue=0;ue<I.length;ue++)U[ue]=[I[ue][H]];return U},A.cola=function(I,H){return A.col(I,H).map(function(K){return K[0]})},A.diag=function(I){for(var H=A.rows(I),K=new Array(H),U=0;U<H;U++)K[U]=[I[U][U]];return K},A.antidiag=function(I){for(var H=A.rows(I)-1,K=new Array(H),U=0;H>=0;H--,U++)K[U]=[I[U][H]];return K},A.transpose=function(I){var H,K,U,ue,je,ce=[];for(v(I[0])||(I=[I]),K=I.length,U=I[0].length,je=0;je<U;je++){for(H=new Array(K),ue=0;ue<K;ue++)H[ue]=I[ue][je];ce.push(H)}return ce.length===1?ce[0]:ce},A.map=function(I,H,K){var U,ue,je,ce,ye;for(v(I[0])||(I=[I]),ue=I.length,je=I[0].length,ce=K?I:new Array(ue),U=0;U<ue;U++)for(ce[U]||(ce[U]=new Array(je)),ye=0;ye<je;ye++)ce[U][ye]=H(I[U][ye],U,ye);return ce.length===1?ce[0]:ce},A.cumreduce=function(I,H,K){var U,ue,je,ce,ye;for(v(I[0])||(I=[I]),ue=I.length,je=I[0].length,ce=K?I:new Array(ue),U=0;U<ue;U++)for(ce[U]||(ce[U]=new Array(je)),je>0&&(ce[U][0]=I[U][0]),ye=1;ye<je;ye++)ce[U][ye]=H(ce[U][ye-1],I[U][ye]);return ce.length===1?ce[0]:ce},A.alter=function(I,H){return A.map(I,H,!0)},A.create=function(I,H,K){var U,ue,je=new Array(I);for(w(H)&&(K=H,H=I),U=0;U<I;U++)for(je[U]=new Array(H),ue=0;ue<H;ue++)je[U][ue]=K(U,ue);return je},A.zeros=function(I,H){return b(H)||(H=I),A.create(I,H,T)},A.ones=function(I,H){return b(H)||(H=I),A.create(I,H,S)},A.rand=function(I,H){return b(H)||(H=I),A.create(I,H,A._random_fn)},A.identity=function(I,H){return b(H)||(H=I),A.create(I,H,P)},A.symmetric=function(I){var H,K,U=I.length;if(I.length!==I[0].length)return!1;for(H=0;H<U;H++)for(K=0;K<U;K++)if(I[K][H]!==I[H][K])return!1;return!0},A.clear=function(I){return A.alter(I,T)},A.seq=function(I,H,K,U){w(U)||(U=!1);var ue,je=[],ce=l(I,H),ye=(H*ce-I*ce)/((K-1)*ce),Me=I;for(ue=0;Me<=H&&ue<K;Me=(I*ce+ye*ce*++ue)/ce)je.push(U?U(Me,ue):Me);return je},A.arange=function(I,H,K){var U,ue=[];if(K=K||1,H===h&&(H=I,I=0),I===H||K===0)return[];if(I<H&&K<0)return[];if(I>H&&K>0)return[];if(K>0)for(U=I;U<H;U+=K)ue.push(U);else for(U=I;U>H;U+=K)ue.push(U);return ue},A.slice=function(){function I(H,K,U,ue){var je,ce=[],ye=H.length;if(K===h&&U===h&&ue===h)return A.copy(H);if(ue=ue||1,(K=(K=K||0)>=0?K:ye+K)===(U=(U=U||H.length)>=0?U:ye+U)||ue===0)return[];if(K<U&&ue<0)return[];if(K>U&&ue>0)return[];if(ue>0)for(je=K;je<U;je+=ue)ce.push(H[je]);else for(je=K;je>U;je+=ue)ce.push(H[je]);return ce}return function(H,K){var U,ue;return b((K=K||{}).row)?b(K.col)?H[K.row][K.col]:I(A.rowa(H,K.row),(U=K.col||{}).start,U.end,U.step):b(K.col)?I(A.cola(H,K.col),(ue=K.row||{}).start,ue.end,ue.step):(ue=K.row||{},U=K.col||{},I(H,ue.start,ue.end,ue.step).map(function(je){return I(je,U.start,U.end,U.step)}))}}(),A.sliceAssign=function(I,H,K){var U,ue;if(b(H.row)){if(b(H.col))return I[H.row][H.col]=K;H.col=H.col||{},H.col.start=H.col.start||0,H.col.end=H.col.end||I[0].length,H.col.step=H.col.step||1,U=A.arange(H.col.start,d.min(I.length,H.col.end),H.col.step);var je=H.row;return U.forEach(function(ye,Me){I[je][ye]=K[Me]}),I}if(b(H.col)){H.row=H.row||{},H.row.start=H.row.start||0,H.row.end=H.row.end||I.length,H.row.step=H.row.step||1,ue=A.arange(H.row.start,d.min(I[0].length,H.row.end),H.row.step);var ce=H.col;return ue.forEach(function(ye,Me){I[ye][ce]=K[Me]}),I}return K[0].length===h&&(K=[K]),H.row.start=H.row.start||0,H.row.end=H.row.end||I.length,H.row.step=H.row.step||1,H.col.start=H.col.start||0,H.col.end=H.col.end||I[0].length,H.col.step=H.col.step||1,ue=A.arange(H.row.start,d.min(I.length,H.row.end),H.row.step),U=A.arange(H.col.start,d.min(I[0].length,H.col.end),H.col.step),ue.forEach(function(ye,Me){U.forEach(function(xe,le){I[ye][xe]=K[Me][le]})}),I},A.diagonal=function(I){var H=A.zeros(I.length,I.length);return I.forEach(function(K,U){H[U][U]=K}),H},A.copy=function(I){return I.map(function(H){return b(H)?H:H.map(function(K){return K})})};var _=A.prototype;return _.length=0,_.push=Array.prototype.push,_.sort=Array.prototype.sort,_.splice=Array.prototype.splice,_.slice=Array.prototype.slice,_.toArray=function(){return this.length>1?V.call(this):V.call(this)[0]},_.map=function(I,H){return A(A.map(this,I,H))},_.cumreduce=function(I,H){return A(A.cumreduce(this,I,H))},_.alter=function(I){return A.alter(this,I),this},function(I){for(var H=0;H<I.length;H++)(function(K){_[K]=function(U){var ue,je=this;return U?(setTimeout(function(){U.call(je,_[K].call(je))}),this):(ue=A[K](this),v(ue)?A(ue):ue)}})(I[H])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(I){for(var H=0;H<I.length;H++)(function(K){_[K]=function(U,ue){var je=this;return ue?(setTimeout(function(){ue.call(je,_[K].call(je,U))}),this):A(A[K](this,U))}})(I[H])}("row col".split(" ")),function(I){for(var H=0;H<I.length;H++)(function(K){_[K]=function(){return A(A[K].apply(null,arguments))}})(I[H])}("create zeros ones rand identity".split(" ")),A}(Math),function(d,h){var F=d.utils.isFunction;function V(v,w){return v-w}function m(v,w,b){return h.max(w,h.min(v,b))}d.sum=function(v){for(var w=0,b=v.length;--b>=0;)w+=v[b];return w},d.sumsqrd=function(v){for(var w=0,b=v.length;--b>=0;)w+=v[b]*v[b];return w},d.sumsqerr=function(v){for(var w,b=d.mean(v),A=0,T=v.length;--T>=0;)A+=(w=v[T]-b)*w;return A},d.sumrow=function(v){for(var w=0,b=v.length;--b>=0;)w+=v[b];return w},d.product=function(v){for(var w=1,b=v.length;--b>=0;)w*=v[b];return w},d.min=function(v){for(var w=v[0],b=0;++b<v.length;)v[b]<w&&(w=v[b]);return w},d.max=function(v){for(var w=v[0],b=0;++b<v.length;)v[b]>w&&(w=v[b]);return w},d.unique=function(v){for(var w={},b=[],A=0;A<v.length;A++)w[v[A]]||(w[v[A]]=!0,b.push(v[A]));return b},d.mean=function(v){return d.sum(v)/v.length},d.meansqerr=function(v){return d.sumsqerr(v)/v.length},d.geomean=function(v){var w=v.map(h.log),b=d.mean(w);return h.exp(b)},d.median=function(v){var w=v.length,b=v.slice().sort(V);return 1&w?b[w/2|0]:(b[w/2-1]+b[w/2])/2},d.cumsum=function(v){return d.cumreduce(v,function(w,b){return w+b})},d.cumprod=function(v){return d.cumreduce(v,function(w,b){return w*b})},d.diff=function(v){var w,b=[],A=v.length;for(w=1;w<A;w++)b.push(v[w]-v[w-1]);return b},d.rank=function(v){var w,b=[],A={};for(w=0;w<v.length;w++)A[_=v[w]]?A[_]++:(A[_]=1,b.push(_));var T=b.sort(V),S={},P=1;for(w=0;w<T.length;w++){var _,I=A[_=T[w]],H=(P+(P+I-1))/2;S[_]=H,P+=I}return v.map(function(K){return S[K]})},d.mode=function(v){var w,b=v.length,A=v.slice().sort(V),T=1,S=0,P=0,_=[];for(w=0;w<b;w++)A[w]===A[w+1]?T++:(T>S?(_=[A[w]],S=T,P=0):T===S&&(_.push(A[w]),P++),T=1);return P===0?_[0]:_},d.range=function(v){return d.max(v)-d.min(v)},d.variance=function(v,w){return d.sumsqerr(v)/(v.length-(w?1:0))},d.pooledvariance=function(v){return v.reduce(function(w,b){return w+d.sumsqerr(b)},0)/(v.reduce(function(w,b){return w+b.length},0)-v.length)},d.deviation=function(v){for(var w=d.mean(v),b=v.length,A=new Array(b),T=0;T<b;T++)A[T]=v[T]-w;return A},d.stdev=function(v,w){return h.sqrt(d.variance(v,w))},d.pooledstdev=function(v){return h.sqrt(d.pooledvariance(v))},d.meandev=function(v){for(var w=d.mean(v),b=[],A=v.length-1;A>=0;A--)b.push(h.abs(v[A]-w));return d.mean(b)},d.meddev=function(v){for(var w=d.median(v),b=[],A=v.length-1;A>=0;A--)b.push(h.abs(v[A]-w));return d.median(b)},d.coeffvar=function(v){return d.stdev(v)/d.mean(v)},d.quartiles=function(v){var w=v.length,b=v.slice().sort(V);return[b[h.round(w/4)-1],b[h.round(w/2)-1],b[h.round(3*w/4)-1]]},d.quantiles=function(v,w,b,A){var T,S,P,_,I,H=v.slice().sort(V),K=[w.length],U=v.length;for(b===void 0&&(b=.375),A===void 0&&(A=.375),T=0;T<w.length;T++)P=U*(S=w[T])+(b+S*(1-b-A)),_=h.floor(m(P,1,U-1)),I=m(P-_,0,1),K[T]=(1-I)*H[_-1]+I*H[_];return K},d.percentile=function(v,w,b){var A=v.slice().sort(V),T=w*(A.length+(b?1:-1))+(b?0:1),S=parseInt(T),P=T-S;return S+1<A.length?A[S-1]+P*(A[S]-A[S-1]):A[S-1]},d.percentileOfScore=function(v,w,b){var A,T,S=0,P=v.length,_=!1;for(b==="strict"&&(_=!0),T=0;T<P;T++)A=v[T],(_&&A<w||!_&&A<=w)&&S++;return S/P},d.histogram=function(v,w){w=w||4;var b,A=d.min(v),T=(d.max(v)-A)/w,S=v.length,P=[];for(b=0;b<w;b++)P[b]=0;for(b=0;b<S;b++)P[h.min(h.floor((v[b]-A)/T),w-1)]+=1;return P},d.covariance=function(v,w){var b,A=d.mean(v),T=d.mean(w),S=v.length,P=new Array(S);for(b=0;b<S;b++)P[b]=(v[b]-A)*(w[b]-T);return d.sum(P)/(S-1)},d.corrcoeff=function(v,w){return d.covariance(v,w)/d.stdev(v,1)/d.stdev(w,1)},d.spearmancoeff=function(v,w){return v=d.rank(v),w=d.rank(w),d.corrcoeff(v,w)},d.stanMoment=function(v,w){for(var b=d.mean(v),A=d.stdev(v),T=v.length,S=0,P=0;P<T;P++)S+=h.pow((v[P]-b)/A,w);return S/v.length},d.skewness=function(v){return d.stanMoment(v,3)},d.kurtosis=function(v){return d.stanMoment(v,4)-3};var l=d.prototype;(function(v){for(var w=0;w<v.length;w++)(function(b){l[b]=function(A,T){var S=[],P=0,_=this;if(F(A)&&(T=A,A=!1),T)return setTimeout(function(){T.call(_,l[b].call(_,A))}),this;if(this.length>1){for(_=A===!0?this:this.transpose();P<_.length;P++)S[P]=d[b](_[P]);return S}return d[b](this[0],A)}})(v[w])})("cumsum cumprod".split(" ")),function(v){for(var w=0;w<v.length;w++)(function(b){l[b]=function(A,T){var S=[],P=0,_=this;if(F(A)&&(T=A,A=!1),T)return setTimeout(function(){T.call(_,l[b].call(_,A))}),this;if(this.length>1){for(b!=="sumrow"&&(_=A===!0?this:this.transpose());P<_.length;P++)S[P]=d[b](_[P]);return A===!0?d[b](d.utils.toVector(S)):S}return d[b](this[0],A)}})(v[w])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(v){for(var w=0;w<v.length;w++)(function(b){l[b]=function(){var A,T=[],S=0,P=this,_=Array.prototype.slice.call(arguments);if(F(_[_.length-1])){A=_[_.length-1];var I=_.slice(0,_.length-1);return setTimeout(function(){A.call(P,l[b].apply(P,I))}),this}A=void 0;var H=function(K){return d[b].apply(P,[K].concat(_))};if(this.length>1){for(P=P.transpose();S<P.length;S++)T[S]=H(P[S]);return T}return H(this[0])}})(v[w])}("quantiles percentileOfScore".split(" "))}(j,Math),function(d,h){d.gammaln=function(F){var V,m,l,v=0,w=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],b=1.000000000190015;for(l=(m=V=F)+5.5,l-=(V+.5)*h.log(l);v<6;v++)b+=w[v]/++m;return h.log(2.5066282746310007*b/V)-l},d.loggam=function(F){var V,m,l,v,w,b,A,T=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(V=F,A=0,F==1||F==2)return 0;for(F<=7&&(V=F+(A=h.floor(7-F))),m=1/(V*V),l=2*h.PI,w=T[9],b=8;b>=0;b--)w*=m,w+=T[b];if(v=w/V+.5*h.log(l)+(V-.5)*h.log(V)-V,F<=7)for(b=1;b<=A;b++)v-=h.log(V-1),V-=1;return v},d.gammafn=function(F){var V,m,l,v,w=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],b=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],A=!1,T=0,S=0,P=0,_=F;if(F>171.6243769536076)return 1/0;if(_<=0){if(!(v=_%1+36e-17))return 1/0;A=(1&_?-1:1)*h.PI/h.sin(h.PI*v),_=1-_}for(l=_,m=_<1?_++:(_-=T=(0|_)-1)-1,V=0;V<8;++V)P=(P+w[V])*m,S=S*m+b[V];if(v=P/S+1,l<_)v/=l;else if(l>_)for(V=0;V<T;++V)v*=_,_++;return A&&(v=A/v),v},d.gammap=function(F,V){return d.lowRegGamma(F,V)*d.gammafn(F)},d.lowRegGamma=function(F,V){var m,l=d.gammaln(F),v=F,w=1/F,b=w,A=V+1-F,T=1/1e-30,S=1/A,P=S,_=1,I=-~(8.5*h.log(F>=1?F:1/F)+.4*F+17);if(V<0||F<=0)return NaN;if(V<F+1){for(;_<=I;_++)w+=b*=V/++v;return w*h.exp(-V+F*h.log(V)-l)}for(;_<=I;_++)P*=(S=1/(S=(m=-_*(_-F))*S+(A+=2)))*(T=A+m/T);return 1-P*h.exp(-V+F*h.log(V)-l)},d.factorialln=function(F){return F<0?NaN:d.gammaln(F+1)},d.factorial=function(F){return F<0?NaN:d.gammafn(F+1)},d.combination=function(F,V){return F>170||V>170?h.exp(d.combinationln(F,V)):d.factorial(F)/d.factorial(V)/d.factorial(F-V)},d.combinationln=function(F,V){return d.factorialln(F)-d.factorialln(V)-d.factorialln(F-V)},d.permutation=function(F,V){return d.factorial(F)/d.factorial(F-V)},d.betafn=function(F,V){if(!(F<=0||V<=0))return F+V>170?h.exp(d.betaln(F,V)):d.gammafn(F)*d.gammafn(V)/d.gammafn(F+V)},d.betaln=function(F,V){return d.gammaln(F)+d.gammaln(V)-d.gammaln(F+V)},d.betacf=function(F,V,m){var l,v,w,b,A=1e-30,T=1,S=V+m,P=V+1,_=V-1,I=1,H=1-S*F/P;for(h.abs(H)<A&&(H=A),b=H=1/H;T<=100&&(H=1+(v=T*(m-T)*F/((_+(l=2*T))*(V+l)))*H,h.abs(H)<A&&(H=A),I=1+v/I,h.abs(I)<A&&(I=A),b*=(H=1/H)*I,H=1+(v=-(V+T)*(S+T)*F/((V+l)*(P+l)))*H,h.abs(H)<A&&(H=A),I=1+v/I,h.abs(I)<A&&(I=A),b*=w=(H=1/H)*I,!(h.abs(w-1)<3e-7));T++);return b},d.gammapinv=function(F,V){var m,l,v,w,b,A,T=0,S=V-1,P=d.gammaln(V);if(F>=1)return h.max(100,V+100*h.sqrt(V));if(F<=0)return 0;for(V>1?(b=h.log(S),A=h.exp(S*(b-1)-P),w=F<.5?F:1-F,m=(2.30753+.27061*(l=h.sqrt(-2*h.log(w))))/(1+l*(.99229+.04481*l))-l,F<.5&&(m=-m),m=h.max(.001,V*h.pow(1-1/(9*V)-m/(3*h.sqrt(V)),3))):m=F<(l=1-V*(.253+.12*V))?h.pow(F/l,1/V):1-h.log(1-(F-l)/(1-l));T<12;T++){if(m<=0)return 0;if((m-=l=(v=(d.lowRegGamma(V,m)-F)/(l=V>1?A*h.exp(-(m-S)+S*(h.log(m)-b)):h.exp(-m+S*h.log(m)-P)))/(1-.5*h.min(1,v*((V-1)/m-1))))<=0&&(m=.5*(m+l)),h.abs(l)<1e-8*m)break}return m},d.erf=function(F){var V,m,l,v,w=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],b=w.length-1,A=!1,T=0,S=0;for(F<0&&(F=-F,A=!0),m=4*(V=2/(2+F))-2;b>0;b--)l=T,T=m*T-S+w[b],S=l;return v=V*h.exp(-F*F+.5*(w[0]+m*T)-S),A?v-1:1-v},d.erfc=function(F){return 1-d.erf(F)},d.erfcinv=function(F){var V,m,l,v,w=0;if(F>=2)return-100;if(F<=0)return 100;for(v=F<1?F:2-F,V=-.70711*((2.30753+.27061*(l=h.sqrt(-2*h.log(v/2))))/(1+l*(.99229+.04481*l))-l);w<2;w++)V+=(m=d.erfc(V)-v)/(1.1283791670955126*h.exp(-V*V)-V*m);return F<1?V:-V},d.ibetainv=function(F,V,m){var l,v,w,b,A,T,S,P,_,I,H=V-1,K=m-1,U=0;if(F<=0)return 0;if(F>=1)return 1;for(V>=1&&m>=1?(w=F<.5?F:1-F,T=(2.30753+.27061*(b=h.sqrt(-2*h.log(w))))/(1+b*(.99229+.04481*b))-b,F<.5&&(T=-T),S=(T*T-3)/6,P=2/(1/(2*V-1)+1/(2*m-1)),_=T*h.sqrt(S+P)/P-(1/(2*m-1)-1/(2*V-1))*(S+.8333333333333334-2/(3*P)),T=V/(V+m*h.exp(2*_))):(l=h.log(V/(V+m)),v=h.log(m/(V+m)),T=F<(b=h.exp(V*l)/V)/(_=b+(A=h.exp(m*v)/m))?h.pow(V*_*F,1/V):1-h.pow(m*_*(1-F),1/m)),I=-d.gammaln(V)-d.gammaln(m)+d.gammaln(V+m);U<10;U++){if(T===0||T===1)return T;if((T-=b=(A=(d.ibeta(T,V,m)-F)/(b=h.exp(H*h.log(T)+K*h.log(1-T)+I)))/(1-.5*h.min(1,A*(H/T-K/(1-T)))))<=0&&(T=.5*(T+b)),T>=1&&(T=.5*(T+b+1)),h.abs(b)<1e-8*T&&U>0)break}return T},d.ibeta=function(F,V,m){var l=F===0||F===1?0:h.exp(d.gammaln(V+m)-d.gammaln(V)-d.gammaln(m)+V*h.log(F)+m*h.log(1-F));return!(F<0||F>1)&&(F<(V+1)/(V+m+2)?l*d.betacf(F,V,m)/V:1-l*d.betacf(1-F,m,V)/m)},d.randn=function(F,V){var m,l,v,w,b;if(V||(V=F),F)return d.create(F,V,function(){return d.randn()});do m=d._random_fn(),l=1.7156*(d._random_fn()-.5),b=(v=m-.449871)*v+(w=h.abs(l)+.386595)*(.196*w-.25472*v);while(b>.27597&&(b>.27846||l*l>-4*h.log(m)*m*m));return l/m},d.randg=function(F,V,m){var l,v,w,b,A,T,S=F;if(m||(m=V),F||(F=1),V)return(T=d.zeros(V,m)).alter(function(){return d.randg(F)}),T;F<1&&(F+=1),l=F-.3333333333333333,v=1/h.sqrt(9*l);do{do b=1+v*(A=d.randn());while(b<=0);b*=b*b,w=d._random_fn()}while(w>1-.331*h.pow(A,4)&&h.log(w)>.5*A*A+l*(1-b+h.log(b)));if(F==S)return l*b;do w=d._random_fn();while(w===0);return h.pow(w,1/S)*l*b},function(F){for(var V=0;V<F.length;V++)(function(m){d.fn[m]=function(){return d(d.map(this,function(l){return d[m](l)}))}})(F[V])}("gammaln gammafn factorial factorialln".split(" ")),function(F){for(var V=0;V<F.length;V++)(function(m){d.fn[m]=function(){return d(d[m].apply(null,arguments))}})(F[V])}("randn".split(" "))}(j,Math),function(d,h){function F(m,l,v,w){for(var b,A=0,T=1,S=1,P=1,_=0,I=0;h.abs((S-I)/S)>w;)I=S,T=P+(b=-(l+_)*(l+v+_)*m/(l+2*_)/(l+2*_+1))*T,S=(A=S+b*A)+(b=(_+=1)*(v-_)*m/(l+2*_-1)/(l+2*_))*S,A/=P=T+b*P,T/=P,S/=P,P=1;return S/l}function V(m,l,v){var w=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],b=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],A=.5*m;if(A>=8)return 1;var T,S=2*d.normal.cdf(A,0,1,1,0)-1;S=S>=h.exp(-50/v)?h.pow(S,v):0;for(var P=A,_=(8-A)/(T=m>3?2:3),I=P+_,H=0,K=v-1,U=1;U<=T;U++){for(var ue=0,je=.5*(I+P),ce=.5*(I-P),ye=1;ye<=12;ye++){var Me,xe=je+ce*(6<ye?w[(Me=12-ye+1)-1]:-w[(Me=ye)-1]),le=xe*xe;if(le>60)break;var ze=2*d.normal.cdf(xe,0,1,1,0)*.5-2*d.normal.cdf(xe,m,1,1,0)*.5;ze>=h.exp(-30/K)&&(ue+=ze=b[Me-1]*h.exp(-.5*le)*h.pow(ze,K))}H+=ue*=2*ce*v/h.sqrt(2*h.PI),P=I,I+=_}return(S+=H)<=h.exp(-30/l)?0:(S=h.pow(S,l))>=1?1:S}(function(m){for(var l=0;l<m.length;l++)(function(v){d[v]=function w(b,A,T){return this instanceof w?(this._a=b,this._b=A,this._c=T,this):new w(b,A,T)},d.fn[v]=function(w,b,A){var T=d[v](w,b,A);return T.data=this,T},d[v].prototype.sample=function(w){var b=this._a,A=this._b,T=this._c;return w?d.alter(w,function(){return d[v].sample(b,A,T)}):d[v].sample(b,A,T)},function(w){for(var b=0;b<w.length;b++)(function(A){d[v].prototype[A]=function(T){var S=this._a,P=this._b,_=this._c;return T||T===0||(T=this.data),typeof T!="number"?d.fn.map.call(T,function(I){return d[v][A](I,S,P,_)}):d[v][A](T,S,P,_)}})(w[b])}("pdf cdf inv".split(" ")),function(w){for(var b=0;b<w.length;b++)(function(A){d[v].prototype[A]=function(){return d[v][A](this._a,this._b,this._c)}})(w[b])}("mean median mode variance".split(" "))})(m[l])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),d.extend(d.beta,{pdf:function(m,l,v){return m>1||m<0?0:l==1&&v==1?1:l<512&&v<512?h.pow(m,l-1)*h.pow(1-m,v-1)/d.betafn(l,v):h.exp((l-1)*h.log(m)+(v-1)*h.log(1-m)-d.betaln(l,v))},cdf:function(m,l,v){return m>1||m<0?1*(m>1):d.ibeta(m,l,v)},inv:function(m,l,v){return d.ibetainv(m,l,v)},mean:function(m,l){return m/(m+l)},median:function(m,l){return d.ibetainv(.5,m,l)},mode:function(m,l){return(m-1)/(m+l-2)},sample:function(m,l){var v=d.randg(m);return v/(v+d.randg(l))},variance:function(m,l){return m*l/(h.pow(m+l,2)*(m+l+1))}}),d.extend(d.centralF,{pdf:function(m,l,v){var w;return m<0?0:l<=2?m===0&&l<2?1/0:m===0&&l===2?1:1/d.betafn(l/2,v/2)*h.pow(l/v,l/2)*h.pow(m,l/2-1)*h.pow(1+l/v*m,-(l+v)/2):(w=l*m/(v+m*l),l*(v/(v+m*l))/2*d.binomial.pdf((l-2)/2,(l+v-2)/2,w))},cdf:function(m,l,v){return m<0?0:d.ibeta(l*m/(l*m+v),l/2,v/2)},inv:function(m,l,v){return v/(l*(1/d.ibetainv(m,l/2,v/2)-1))},mean:function(m,l){return l>2?l/(l-2):void 0},mode:function(m,l){return m>2?l*(m-2)/(m*(l+2)):void 0},sample:function(m,l){return 2*d.randg(m/2)/m/(2*d.randg(l/2)/l)},variance:function(m,l){if(!(l<=4))return 2*l*l*(m+l-2)/(m*(l-2)*(l-2)*(l-4))}}),d.extend(d.cauchy,{pdf:function(m,l,v){return v<0?0:v/(h.pow(m-l,2)+h.pow(v,2))/h.PI},cdf:function(m,l,v){return h.atan((m-l)/v)/h.PI+.5},inv:function(m,l,v){return l+v*h.tan(h.PI*(m-.5))},median:function(m){return m},mode:function(m){return m},sample:function(m,l){return d.randn()*h.sqrt(1/(2*d.randg(.5)))*l+m}}),d.extend(d.chisquare,{pdf:function(m,l){return m<0?0:m===0&&l===2?.5:h.exp((l/2-1)*h.log(m)-m/2-l/2*h.log(2)-d.gammaln(l/2))},cdf:function(m,l){return m<0?0:d.lowRegGamma(l/2,m/2)},inv:function(m,l){return 2*d.gammapinv(m,.5*l)},mean:function(m){return m},median:function(m){return m*h.pow(1-2/(9*m),3)},mode:function(m){return m-2>0?m-2:0},sample:function(m){return 2*d.randg(m/2)},variance:function(m){return 2*m}}),d.extend(d.exponential,{pdf:function(m,l){return m<0?0:l*h.exp(-l*m)},cdf:function(m,l){return m<0?0:1-h.exp(-l*m)},inv:function(m,l){return-h.log(1-m)/l},mean:function(m){return 1/m},median:function(m){return 1/m*h.log(2)},mode:function(){return 0},sample:function(m){return-1/m*h.log(d._random_fn())},variance:function(m){return h.pow(m,-2)}}),d.extend(d.gamma,{pdf:function(m,l,v){return m<0?0:m===0&&l===1?1/v:h.exp((l-1)*h.log(m)-m/v-d.gammaln(l)-l*h.log(v))},cdf:function(m,l,v){return m<0?0:d.lowRegGamma(l,m/v)},inv:function(m,l,v){return d.gammapinv(m,l)*v},mean:function(m,l){return m*l},mode:function(m,l){if(m>1)return(m-1)*l},sample:function(m,l){return d.randg(m)*l},variance:function(m,l){return m*l*l}}),d.extend(d.invgamma,{pdf:function(m,l,v){return m<=0?0:h.exp(-(l+1)*h.log(m)-v/m-d.gammaln(l)+l*h.log(v))},cdf:function(m,l,v){return m<=0?0:1-d.lowRegGamma(l,v/m)},inv:function(m,l,v){return v/d.gammapinv(1-m,l)},mean:function(m,l){return m>1?l/(m-1):void 0},mode:function(m,l){return l/(m+1)},sample:function(m,l){return l/d.randg(m)},variance:function(m,l){if(!(m<=2))return l*l/((m-1)*(m-1)*(m-2))}}),d.extend(d.kumaraswamy,{pdf:function(m,l,v){return m===0&&l===1?v:m===1&&v===1?l:h.exp(h.log(l)+h.log(v)+(l-1)*h.log(m)+(v-1)*h.log(1-h.pow(m,l)))},cdf:function(m,l,v){return m<0?0:m>1?1:1-h.pow(1-h.pow(m,l),v)},inv:function(m,l,v){return h.pow(1-h.pow(1-m,1/v),1/l)},mean:function(m,l){return l*d.gammafn(1+1/m)*d.gammafn(l)/d.gammafn(1+1/m+l)},median:function(m,l){return h.pow(1-h.pow(2,-1/l),1/m)},mode:function(m,l){if(m>=1&&l>=1&&m!==1&&l!==1)return h.pow((m-1)/(m*l-1),1/m)},variance:function(){throw new Error("variance not yet implemented")}}),d.extend(d.lognormal,{pdf:function(m,l,v){return m<=0?0:h.exp(-h.log(m)-.5*h.log(2*h.PI)-h.log(v)-h.pow(h.log(m)-l,2)/(2*v*v))},cdf:function(m,l,v){return m<0?0:.5+.5*d.erf((h.log(m)-l)/h.sqrt(2*v*v))},inv:function(m,l,v){return h.exp(-1.4142135623730951*v*d.erfcinv(2*m)+l)},mean:function(m,l){return h.exp(m+l*l/2)},median:function(m){return h.exp(m)},mode:function(m,l){return h.exp(m-l*l)},sample:function(m,l){return h.exp(d.randn()*l+m)},variance:function(m,l){return(h.exp(l*l)-1)*h.exp(2*m+l*l)}}),d.extend(d.noncentralt,{pdf:function(m,l,v){return h.abs(v)<1e-14?d.studentt.pdf(m,l):h.abs(m)<1e-14?h.exp(d.gammaln((l+1)/2)-v*v/2-.5*h.log(h.PI*l)-d.gammaln(l/2)):l/m*(d.noncentralt.cdf(m*h.sqrt(1+2/l),l+2,v)-d.noncentralt.cdf(m,l,v))},cdf:function(m,l,v){var w=1e-14;if(h.abs(v)<w)return d.studentt.cdf(m,l);var b=!1;m<0&&(b=!0,v=-v);for(var A=d.normal.cdf(-v,0,1),T=w+1,S=T,P=m*m/(m*m+l),_=0,I=h.exp(-v*v/2),H=h.exp(-v*v/2-.5*h.log(2)-d.gammaln(1.5))*v;_<200||S>w||T>w;)S=T,_>0&&(I*=v*v/(2*_),H*=v*v/(2*(_+.5))),A+=.5*(T=I*d.beta.cdf(P,_+.5,l/2)+H*d.beta.cdf(P,_+1,l/2)),_++;return b?1-A:A}}),d.extend(d.normal,{pdf:function(m,l,v){return h.exp(-.5*h.log(2*h.PI)-h.log(v)-h.pow(m-l,2)/(2*v*v))},cdf:function(m,l,v){return .5*(1+d.erf((m-l)/h.sqrt(2*v*v)))},inv:function(m,l,v){return-1.4142135623730951*v*d.erfcinv(2*m)+l},mean:function(m){return m},median:function(m){return m},mode:function(m){return m},sample:function(m,l){return d.randn()*l+m},variance:function(m,l){return l*l}}),d.extend(d.pareto,{pdf:function(m,l,v){return m<l?0:v*h.pow(l,v)/h.pow(m,v+1)},cdf:function(m,l,v){return m<l?0:1-h.pow(l/m,v)},inv:function(m,l,v){return l/h.pow(1-m,1/v)},mean:function(m,l){if(!(l<=1))return l*h.pow(m,l)/(l-1)},median:function(m,l){return m*(l*h.SQRT2)},mode:function(m){return m},variance:function(m,l){if(!(l<=2))return m*m*l/(h.pow(l-1,2)*(l-2))}}),d.extend(d.studentt,{pdf:function(m,l){return l=l>1e100?1e100:l,1/(h.sqrt(l)*d.betafn(.5,l/2))*h.pow(1+m*m/l,-(l+1)/2)},cdf:function(m,l){var v=l/2;return d.ibeta((m+h.sqrt(m*m+l))/(2*h.sqrt(m*m+l)),v,v)},inv:function(m,l){var v=d.ibetainv(2*h.min(m,1-m),.5*l,.5);return v=h.sqrt(l*(1-v)/v),m>.5?v:-v},mean:function(m){return m>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(m){return d.randn()*h.sqrt(m/(2*d.randg(m/2)))},variance:function(m){return m>2?m/(m-2):m>1?1/0:void 0}}),d.extend(d.weibull,{pdf:function(m,l,v){return m<0||l<0||v<0?0:v/l*h.pow(m/l,v-1)*h.exp(-h.pow(m/l,v))},cdf:function(m,l,v){return m<0?0:1-h.exp(-h.pow(m/l,v))},inv:function(m,l,v){return l*h.pow(-h.log(1-m),1/v)},mean:function(m,l){return m*d.gammafn(1+1/l)},median:function(m,l){return m*h.pow(h.log(2),1/l)},mode:function(m,l){return l<=1?0:m*h.pow((l-1)/l,1/l)},sample:function(m,l){return m*h.pow(-h.log(d._random_fn()),1/l)},variance:function(m,l){return m*m*d.gammafn(1+2/l)-h.pow(d.weibull.mean(m,l),2)}}),d.extend(d.uniform,{pdf:function(m,l,v){return m<l||m>v?0:1/(v-l)},cdf:function(m,l,v){return m<l?0:m<v?(m-l)/(v-l):1},inv:function(m,l,v){return l+m*(v-l)},mean:function(m,l){return .5*(m+l)},median:function(m,l){return d.mean(m,l)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(m,l){return m/2+l/2+(l/2-m/2)*(2*d._random_fn()-1)},variance:function(m,l){return h.pow(l-m,2)/12}}),d.extend(d.binomial,{pdf:function(m,l,v){return v===0||v===1?l*v===m?1:0:d.combination(l,m)*h.pow(v,m)*h.pow(1-v,l-m)},cdf:function(m,l,v){var w,b=1e-10;if(m<0)return 0;if(m>=l)return 1;if(v<0||v>1||l<=0)return NaN;var A=v,T=(m=h.floor(m))+1,S=l-m,P=T+S,_=h.exp(d.gammaln(P)-d.gammaln(S)-d.gammaln(T)+T*h.log(A)+S*h.log(1-A));return w=A<(T+1)/(P+2)?_*F(A,T,S,b):1-_*F(1-A,S,T,b),h.round(1/b*(1-w))/(1/b)}}),d.extend(d.negbin,{pdf:function(m,l,v){return m===m>>>0&&(m<0?0:d.combination(m+l-1,l-1)*h.pow(1-v,m)*h.pow(v,l))},cdf:function(m,l,v){var w=0,b=0;if(m<0)return 0;for(;b<=m;b++)w+=d.negbin.pdf(b,l,v);return w}}),d.extend(d.hypgeom,{pdf:function(m,l,v,w){if(m!=m|0)return!1;if(m<0||m<v-(l-w)||m>w||m>v)return 0;if(2*v>l)return 2*w>l?d.hypgeom.pdf(l-v-w+m,l,l-v,l-w):d.hypgeom.pdf(w-m,l,l-v,w);if(2*w>l)return d.hypgeom.pdf(v-m,l,v,l-w);if(v<w)return d.hypgeom.pdf(m,l,w,v);for(var b=1,A=0,T=0;T<m;T++){for(;b>1&&A<w;)b*=1-v/(l-A),A++;b*=(w-T)*(v-T)/((T+1)*(l-v-w+T+1))}for(;A<w;A++)b*=1-v/(l-A);return h.min(1,h.max(0,b))},cdf:function(m,l,v,w){if(m<0||m<v-(l-w))return 0;if(m>=w||m>=v)return 1;if(2*v>l)return 2*w>l?d.hypgeom.cdf(l-v-w+m,l,l-v,l-w):1-d.hypgeom.cdf(w-m-1,l,l-v,w);if(2*w>l)return 1-d.hypgeom.cdf(v-m-1,l,v,l-w);if(v<w)return d.hypgeom.cdf(m,l,w,v);for(var b=1,A=1,T=0,S=0;S<m;S++){for(;b>1&&T<w;){var P=1-v/(l-T);A*=P,b*=P,T++}b+=A*=(w-S)*(v-S)/((S+1)*(l-v-w+S+1))}for(;T<w;T++)b*=1-v/(l-T);return h.min(1,h.max(0,b))}}),d.extend(d.poisson,{pdf:function(m,l){return l<0||m%1!=0||m<0?0:h.pow(l,m)*h.exp(-l)/d.factorial(m)},cdf:function(m,l){var v=[],w=0;if(m<0)return 0;for(;w<=m;w++)v.push(d.poisson.pdf(w,l));return d.sum(v)},mean:function(m){return m},variance:function(m){return m},sampleSmall:function(m){var l=1,v=0,w=h.exp(-m);do v++,l*=d._random_fn();while(l>w);return v-1},sampleLarge:function(m){var l,v,w,b,A,T,S,P,_,I,H=m;for(b=h.sqrt(H),A=h.log(H),T=.02483*(S=.931+2.53*b)-.059,P=1.1239+1.1328/(S-3.4),_=.9277-3.6224/(S-2);;)if(v=h.random()-.5,w=h.random(),I=.5-h.abs(v),l=h.floor((2*T/I+S)*v+H+.43),I>=.07&&w<=_||!(l<0||I<.013&&w>I)&&h.log(w)+h.log(P)-h.log(T/(I*I)+S)<=l*A-H-d.loggam(l+1))return l},sample:function(m){return m<10?this.sampleSmall(m):this.sampleLarge(m)}}),d.extend(d.triangular,{pdf:function(m,l,v,w){return v<=l||w<l||w>v?NaN:m<l||m>v?0:m<w?2*(m-l)/((v-l)*(w-l)):m===w?2/(v-l):2*(v-m)/((v-l)*(v-w))},cdf:function(m,l,v,w){return v<=l||w<l||w>v?NaN:m<=l?0:m>=v?1:m<=w?h.pow(m-l,2)/((v-l)*(w-l)):1-h.pow(v-m,2)/((v-l)*(v-w))},inv:function(m,l,v,w){return v<=l||w<l||w>v?NaN:m<=(w-l)/(v-l)?l+(v-l)*h.sqrt(m*((w-l)/(v-l))):l+(v-l)*(1-h.sqrt((1-m)*(1-(w-l)/(v-l))))},mean:function(m,l,v){return(m+l+v)/3},median:function(m,l,v){return v<=(m+l)/2?l-h.sqrt((l-m)*(l-v))/h.sqrt(2):v>(m+l)/2?m+h.sqrt((l-m)*(v-m))/h.sqrt(2):void 0},mode:function(m,l,v){return v},sample:function(m,l,v){var w=d._random_fn();return w<(v-m)/(l-m)?m+h.sqrt(w*(l-m)*(v-m)):l-h.sqrt((1-w)*(l-m)*(l-v))},variance:function(m,l,v){return(m*m+l*l+v*v-m*l-m*v-l*v)/18}}),d.extend(d.arcsine,{pdf:function(m,l,v){return v<=l?NaN:m<=l||m>=v?0:2/h.PI*h.pow(h.pow(v-l,2)-h.pow(2*m-l-v,2),-.5)},cdf:function(m,l,v){return m<l?0:m<v?2/h.PI*h.asin(h.sqrt((m-l)/(v-l))):1},inv:function(m,l,v){return l+(.5-.5*h.cos(h.PI*m))*(v-l)},mean:function(m,l){return l<=m?NaN:(m+l)/2},median:function(m,l){return l<=m?NaN:(m+l)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(m,l){return(m+l)/2+(l-m)/2*h.sin(2*h.PI*d.uniform.sample(0,1))},variance:function(m,l){return l<=m?NaN:h.pow(l-m,2)/8}}),d.extend(d.laplace,{pdf:function(m,l,v){return v<=0?0:h.exp(-h.abs(m-l)/v)/(2*v)},cdf:function(m,l,v){return v<=0?0:m<l?.5*h.exp((m-l)/v):1-.5*h.exp(-(m-l)/v)},mean:function(m){return m},median:function(m){return m},mode:function(m){return m},variance:function(m,l){return 2*l*l},sample:function(m,l){var v,w=d._random_fn()-.5;return m-l*((v=w)/h.abs(v))*h.log(1-2*h.abs(w))}}),d.extend(d.tukey,{cdf:function(m,l,v){var w=l,b=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],A=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(m<=0)return 0;if(v<2||w<2)return NaN;if(!Number.isFinite(m))return 1;if(v>25e3)return V(m,1,w);var T,S=.5*v,P=S*h.log(v)-v*h.log(2)-d.gammaln(S),_=S-1,I=.25*v;T=v<=100?1:v<=800?.5:v<=5e3?.25:.125,P+=h.log(T);for(var H=0,K=1;K<=50;K++){for(var U=0,ue=(2*K-1)*T,je=1;je<=16;je++){var ce,ye;8<je?(ce=je-8-1,ye=P+_*h.log(ue+b[ce]*T)-(b[ce]*T+ue)*I):(ce=je-1,ye=P+_*h.log(ue-b[ce]*T)+(b[ce]*T-ue)*I),ye>=-30&&(U+=V(8<je?m*h.sqrt(.5*(b[ce]*T+ue)):m*h.sqrt(.5*(-b[ce]*T+ue)),1,w)*A[ce]*h.exp(ye))}if(K*T>=1&&U<=1e-14)break;H+=U}if(U>1e-14)throw new Error("tukey.cdf failed to converge");return H>1&&(H=1),H},inv:function(m,l,v){if(v<2||l<2)return NaN;if(m<0||m>1)return NaN;if(m===0)return 0;if(m===1)return 1/0;var w,b=function(_,I,H){var K=.5-.5*_,U=h.sqrt(h.log(1/(K*K))),ue=U+((((-453642210148e-16*U-.204231210125)*U-.342242088547)*U-1)*U+.322232421088)/((((.0038560700634*U+.10353775285)*U+.531103462366)*U+.588581570495)*U+.099348462606);H<120&&(ue+=(ue*ue*ue+ue)/H/4);var je=.8832-.2368*ue;return H<120&&(je+=-1.214/H+1.208*ue/H),ue*(je*h.log(I-1)+1.4142)}(m,l,v),A=d.tukey.cdf(b,l,v)-m;w=A>0?h.max(0,b-1):b+1;for(var T,S=d.tukey.cdf(w,l,v)-m,P=1;P<50;P++)if(T=w-S*(w-b)/(S-A),A=S,b=w,T<0&&(T=0,S=-m),S=d.tukey.cdf(T,l,v)-m,w=T,h.abs(w-b)<1e-4)return T;throw new Error("tukey.inv failed to converge")}})}(j,Math),function(d,h){var F,V,m=Array.prototype.push,l=d.utils.isArray;function v(w){return l(w)||w instanceof d}d.extend({add:function(w,b){return v(b)?(v(b[0])||(b=[b]),d.map(w,function(A,T,S){return A+b[T][S]})):d.map(w,function(A){return A+b})},subtract:function(w,b){return v(b)?(v(b[0])||(b=[b]),d.map(w,function(A,T,S){return A-b[T][S]||0})):d.map(w,function(A){return A-b})},divide:function(w,b){return v(b)?(v(b[0])||(b=[b]),d.multiply(w,d.inv(b))):d.map(w,function(A){return A/b})},multiply:function(w,b){var A,T,S,P,_,I,H,K;if(w.length===void 0&&b.length===void 0)return w*b;if(_=w.length,I=w[0].length,H=d.zeros(_,S=v(b)?b[0].length:I),K=0,v(b)){for(;K<S;K++)for(A=0;A<_;A++){for(P=0,T=0;T<I;T++)P+=w[A][T]*b[T][K];H[A][K]=P}return _===1&&K===1?H[0][0]:H}return d.map(w,function(U){return U*b})},outer:function(w,b){return d.multiply(w.map(function(A){return[A]}),[b])},dot:function(w,b){v(w[0])||(w=[w]),v(b[0])||(b=[b]);for(var A,T,S=w[0].length===1&&w.length!==1?d.transpose(w):w,P=b[0].length===1&&b.length!==1?d.transpose(b):b,_=[],I=0,H=S.length,K=S[0].length;I<H;I++){for(_[I]=[],A=0,T=0;T<K;T++)A+=S[I][T]*P[I][T];_[I]=A}return _.length===1?_[0]:_},pow:function(w,b){return d.map(w,function(A){return h.pow(A,b)})},exp:function(w){return d.map(w,function(b){return h.exp(b)})},log:function(w){return d.map(w,function(b){return h.log(b)})},abs:function(w){return d.map(w,function(b){return h.abs(b)})},norm:function(w,b){var A=0,T=0;for(isNaN(b)&&(b=2),v(w[0])&&(w=w[0]);T<w.length;T++)A+=h.pow(h.abs(w[T]),b);return h.pow(A,1/b)},angle:function(w,b){return h.acos(d.dot(w,b)/(d.norm(w)*d.norm(b)))},aug:function(w,b){var A,T=[];for(A=0;A<w.length;A++)T.push(w[A].slice());for(A=0;A<T.length;A++)m.apply(T[A],b[A]);return T},inv:function(w){for(var b,A=w.length,T=w[0].length,S=d.identity(A,T),P=d.gauss_jordan(w,S),_=[],I=0;I<A;I++)for(_[I]=[],b=T;b<P[0].length;b++)_[I][b-T]=P[I][b];return _},det:function w(b){if(b.length===2)return b[0][0]*b[1][1]-b[0][1]*b[1][0];for(var A=0,T=0;T<b.length;T++){for(var S=[],P=1;P<b.length;P++){S[P-1]=[];for(var _=0;_<b.length;_++)_<T?S[P-1][_]=b[P][_]:_>T&&(S[P-1][_-1]=b[P][_])}var I=T%2?-1:1;A+=w(S)*b[0][T]*I}return A},gauss_elimination:function(w,b){var A,T,S,P,_=0,I=0,H=w.length,K=w[0].length,U=1,ue=0,je=[];for(A=(w=d.aug(w,b))[0].length,_=0;_<H;_++){for(T=w[_][_],I=_,P=_+1;P<K;P++)T<h.abs(w[P][_])&&(T=w[P][_],I=P);if(I!=_)for(P=0;P<A;P++)S=w[_][P],w[_][P]=w[I][P],w[I][P]=S;for(I=_+1;I<H;I++)for(U=w[I][_]/w[_][_],P=_;P<A;P++)w[I][P]=w[I][P]-U*w[_][P]}for(_=H-1;_>=0;_--){for(ue=0,I=_+1;I<=H-1;I++)ue+=je[I]*w[_][I];je[_]=(w[_][A-1]-ue)/w[_][_]}return je},gauss_jordan:function(w,b){var A,T,S,P=d.aug(w,b),_=P.length,I=P[0].length,H=0;for(T=0;T<_;T++){var K=T;for(S=T+1;S<_;S++)h.abs(P[S][T])>h.abs(P[K][T])&&(K=S);var U=P[T];for(P[T]=P[K],P[K]=U,S=T+1;S<_;S++)for(H=P[S][T]/P[T][T],A=T;A<I;A++)P[S][A]-=P[T][A]*H}for(T=_-1;T>=0;T--){for(H=P[T][T],S=0;S<T;S++)for(A=I-1;A>T-1;A--)P[S][A]-=P[T][A]*P[S][T]/H;for(P[T][T]/=H,A=_;A<I;A++)P[T][A]/=H}return P},triaUpSolve:function(w,b){var A,T=w[0].length,S=d.zeros(1,T)[0],P=!1;return b[0].length!=null&&(b=b.map(function(_){return _[0]}),P=!0),d.arange(T-1,-1,-1).forEach(function(_){A=d.arange(_+1,T).map(function(I){return S[I]*w[_][I]}),S[_]=(b[_]-d.sum(A))/w[_][_]}),P?S.map(function(_){return[_]}):S},triaLowSolve:function(w,b){var A,T=w[0].length,S=d.zeros(1,T)[0],P=!1;return b[0].length!=null&&(b=b.map(function(_){return _[0]}),P=!0),d.arange(T).forEach(function(_){A=d.arange(_).map(function(I){return w[_][I]*S[I]}),S[_]=(b[_]-d.sum(A))/w[_][_]}),P?S.map(function(_){return[_]}):S},lu:function(w){var b,A=w.length,T=d.identity(A),S=d.zeros(w.length,w[0].length);return d.arange(A).forEach(function(P){S[0][P]=w[0][P]}),d.arange(1,A).forEach(function(P){d.arange(P).forEach(function(_){b=d.arange(_).map(function(I){return T[P][I]*S[I][_]}),T[P][_]=(w[P][_]-d.sum(b))/S[_][_]}),d.arange(P,A).forEach(function(_){b=d.arange(P).map(function(I){return T[P][I]*S[I][_]}),S[P][_]=w[b.length][_]-d.sum(b)})}),[T,S]},cholesky:function(w){var b,A=w.length,T=d.zeros(w.length,w[0].length);return d.arange(A).forEach(function(S){b=d.arange(S).map(function(P){return h.pow(T[S][P],2)}),T[S][S]=h.sqrt(w[S][S]-d.sum(b)),d.arange(S+1,A).forEach(function(P){b=d.arange(S).map(function(_){return T[S][_]*T[P][_]}),T[P][S]=(w[S][P]-d.sum(b))/T[S][S]})}),T},gauss_jacobi:function(w,b,A,T){for(var S,P,_,I,H=0,K=0,U=w.length,ue=[],je=[],ce=[];H<U;H++)for(ue[H]=[],je[H]=[],ce[H]=[],K=0;K<U;K++)H>K?(ue[H][K]=w[H][K],je[H][K]=ce[H][K]=0):H<K?(je[H][K]=w[H][K],ue[H][K]=ce[H][K]=0):(ce[H][K]=w[H][K],ue[H][K]=je[H][K]=0);for(_=d.multiply(d.multiply(d.inv(ce),d.add(ue,je)),-1),P=d.multiply(d.inv(ce),b),S=A,I=d.add(d.multiply(_,A),P),H=2;h.abs(d.norm(d.subtract(I,S)))>T;)S=I,I=d.add(d.multiply(_,S),P),H++;return I},gauss_seidel:function(w,b,A,T){for(var S,P,_,I,H,K=0,U=w.length,ue=[],je=[],ce=[];K<U;K++)for(ue[K]=[],je[K]=[],ce[K]=[],S=0;S<U;S++)K>S?(ue[K][S]=w[K][S],je[K][S]=ce[K][S]=0):K<S?(je[K][S]=w[K][S],ue[K][S]=ce[K][S]=0):(ce[K][S]=w[K][S],ue[K][S]=je[K][S]=0);for(I=d.multiply(d.multiply(d.inv(d.add(ce,ue)),je),-1),_=d.multiply(d.inv(d.add(ce,ue)),b),P=A,H=d.add(d.multiply(I,A),_),K=2;h.abs(d.norm(d.subtract(H,P)))>T;)P=H,H=d.add(d.multiply(I,P),_),K+=1;return H},SOR:function(w,b,A,T,S){for(var P,_,I,H,K,U=0,ue=w.length,je=[],ce=[],ye=[];U<ue;U++)for(je[U]=[],ce[U]=[],ye[U]=[],P=0;P<ue;P++)U>P?(je[U][P]=w[U][P],ce[U][P]=ye[U][P]=0):U<P?(ce[U][P]=w[U][P],je[U][P]=ye[U][P]=0):(ye[U][P]=w[U][P],je[U][P]=ce[U][P]=0);for(H=d.multiply(d.inv(d.add(ye,d.multiply(je,S))),d.subtract(d.multiply(ye,1-S),d.multiply(ce,S))),I=d.multiply(d.multiply(d.inv(d.add(ye,d.multiply(je,S))),b),S),_=A,K=d.add(d.multiply(H,A),I),U=2;h.abs(d.norm(d.subtract(K,_)))>T;)_=K,K=d.add(d.multiply(H,_),I),U++;return K},householder:function(w){for(var b,A,T,S,P=w.length,_=w[0].length,I=0,H=[],K=[];I<P-1;I++){for(b=0,S=I+1;S<_;S++)b+=w[S][I]*w[S][I];for(b=(w[I+1][I]>0?-1:1)*h.sqrt(b),A=h.sqrt((b*b-w[I+1][I]*b)/2),(H=d.zeros(P,1))[I+1][0]=(w[I+1][I]-b)/(2*A),T=I+2;T<P;T++)H[T][0]=w[T][I]/(2*A);K=d.subtract(d.identity(P,_),d.multiply(d.multiply(H,d.transpose(H)),2)),w=d.multiply(K,d.multiply(w,K))}return w},QR:(F=d.sum,V=d.arange,function(w){var b,A,T,S=w.length,P=w[0].length,_=d.zeros(P,P);for(w=d.copy(w),A=0;A<P;A++){for(_[A][A]=h.sqrt(F(V(S).map(function(I){return w[I][A]*w[I][A]}))),b=0;b<S;b++)w[b][A]=w[b][A]/_[A][A];for(T=A+1;T<P;T++)for(_[A][T]=F(V(S).map(function(I){return w[I][A]*w[I][T]})),b=0;b<S;b++)w[b][T]=w[b][T]-w[b][A]*_[A][T]}return[w,_]}),lstsq:function(w,b){var A=!1;b[0].length===void 0&&(b=b.map(function(ue){return[ue]}),A=!0);var T=d.QR(w),S=T[0],P=T[1],_=w[0].length,I=d.slice(S,{col:{end:_}}),H=function(ue){var je=(ue=d.copy(ue)).length,ce=d.identity(je);return d.arange(je-1,-1,-1).forEach(function(ye){d.sliceAssign(ce,{row:ye},d.divide(d.slice(ce,{row:ye}),ue[ye][ye])),d.sliceAssign(ue,{row:ye},d.divide(d.slice(ue,{row:ye}),ue[ye][ye])),d.arange(ye).forEach(function(Me){var xe=d.multiply(ue[Me][ye],-1),le=d.slice(ue,{row:Me}),ze=d.multiply(d.slice(ue,{row:ye}),xe);d.sliceAssign(ue,{row:Me},d.add(le,ze));var We=d.slice(ce,{row:Me}),Ye=d.multiply(d.slice(ce,{row:ye}),xe);d.sliceAssign(ce,{row:Me},d.add(We,Ye))})}),ce}(d.slice(P,{row:{end:_}})),K=d.transpose(I);K[0].length===void 0&&(K=[K]);var U=d.multiply(d.multiply(H,K),b);return U.length===void 0&&(U=[[U]]),A?U.map(function(ue){return ue[0]}):U},jacobi:function(w){for(var b,A,T,S,P,_,I,H=1,K=w.length,U=d.identity(K,K),ue=[];H===1;){for(P=w[0][1],T=0,S=1,b=0;b<K;b++)for(A=0;A<K;A++)b!=A&&P<h.abs(w[b][A])&&(P=h.abs(w[b][A]),T=b,S=A);for(_=w[T][T]===w[S][S]?w[T][S]>0?h.PI/4:-h.PI/4:h.atan(2*w[T][S]/(w[T][T]-w[S][S]))/2,(I=d.identity(K,K))[T][T]=h.cos(_),I[T][S]=-h.sin(_),I[S][T]=h.sin(_),I[S][S]=h.cos(_),U=d.multiply(U,I),w=d.multiply(d.multiply(d.inv(I),w),I),H=0,b=1;b<K;b++)for(A=1;A<K;A++)b!=A&&h.abs(w[b][A])>.001&&(H=1)}for(b=0;b<K;b++)ue.push(w[b][b]);return[U,ue]},rungekutta:function(w,b,A,T,S,P){var _,I,H;if(P===2)for(;T<=A;)S+=((_=b*w(T,S))+(I=b*w(T+b,S+_)))/2,T+=b;if(P===4)for(;T<=A;)S+=((_=b*w(T,S))+2*(I=b*w(T+b/2,S+_/2))+2*(H=b*w(T+b/2,S+I/2))+b*w(T+b,S+H))/6,T+=b;return S},romberg:function(w,b,A,T){for(var S,P,_,I,H,K=0,U=(A-b)/2,ue=[],je=[],ce=[];K<T/2;){for(H=w(b),_=b,I=0;_<=A;_+=U,I++)ue[I]=_;for(S=ue.length,_=1;_<S-1;_++)H+=(_%2!=0?4:2)*w(ue[_]);H=U/3*(H+w(A)),ce[K]=H,U/=2,K++}for(P=ce.length,S=1;P!==1;){for(_=0;_<P-1;_++)je[_]=(h.pow(4,S)*ce[_+1]-ce[_])/(h.pow(4,S)-1);P=je.length,ce=je,je=[],S++}return ce},richardson:function(w,b,A,T){function S(ye,Me){for(var xe,le=0,ze=ye.length;le<ze;le++)ye[le]===Me&&(xe=le);return xe}for(var P,_,I,H,K,U=h.abs(A-w[S(w,A)+1]),ue=0,je=[],ce=[];T>=U;)P=S(w,A+T),_=S(w,A),je[ue]=(b[P]-2*b[_]+b[2*_-P])/(T*T),T/=2,ue++;for(H=je.length,I=1;H!=1;){for(K=0;K<H-1;K++)ce[K]=(h.pow(4,I)*je[K+1]-je[K])/(h.pow(4,I)-1);H=ce.length,je=ce,ce=[],I++}return je},simpson:function(w,b,A,T){for(var S,P=(A-b)/T,_=w(b),I=[],H=b,K=0,U=1;H<=A;H+=P,K++)I[K]=H;for(S=I.length;U<S-1;U++)_+=(U%2!=0?4:2)*w(I[U]);return P/3*(_+w(A))},hermite:function(w,b,A,T){for(var S,P=w.length,_=0,I=0,H=[],K=[],U=[],ue=[];I<P;I++){for(H[I]=1,S=0;S<P;S++)I!=S&&(H[I]*=(T-w[S])/(w[I]-w[S]));for(K[I]=0,S=0;S<P;S++)I!=S&&(K[I]+=1/(w[I]-w[S]));U[I]=(1-2*(T-w[I])*K[I])*(H[I]*H[I]),ue[I]=(T-w[I])*(H[I]*H[I]),_+=U[I]*b[I]+ue[I]*A[I]}return _},lagrange:function(w,b,A){for(var T,S,P=0,_=0,I=w.length;_<I;_++){for(S=b[_],T=0;T<I;T++)_!=T&&(S*=(A-w[T])/(w[_]-w[T]));P+=S}return P},cubic_spline:function(w,b,A){for(var T,S,P=w.length,_=0,I=[],H=[],K=[],U=[],ue=[],je=[];_<P-1;_++)U[_]=w[_+1]-w[_];for(K[0]=0,_=1;_<P-1;_++)K[_]=3/U[_]*(b[_+1]-b[_])-3/U[_-1]*(b[_]-b[_-1]);for(_=1;_<P-1;_++)I[_]=[],H[_]=[],I[_][_-1]=U[_-1],I[_][_]=2*(U[_-1]+U[_]),I[_][_+1]=U[_],H[_][0]=K[_];for(S=d.multiply(d.inv(I),H),T=0;T<P-1;T++)ue[T]=(b[T+1]-b[T])/U[T]-U[T]*(S[T+1][0]+2*S[T][0])/3,je[T]=(S[T+1][0]-S[T][0])/(3*U[T]);for(T=0;T<P&&!(w[T]>A);T++);return b[T-=1]+(A-w[T])*ue[T]+d.sq(A-w[T])*S[T]+(A-w[T])*d.sq(A-w[T])*je[T]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(w){var b,A,T,S,P,_=w.length,I=w[0].length,H=0,K=[],U=[],ue=[],je=[],ce=[],ye=[],Me=[];for(H=0;H<_;H++)K[H]=d.sum(w[H])/I;for(H=0;H<I;H++)for(ce[H]=[],b=0;b<_;b++)ce[H][b]=w[b][H]-K[b];for(ce=d.transpose(ce),H=0;H<_;H++)for(ye[H]=[],b=0;b<_;b++)ye[H][b]=d.dot([ce[H]],[ce[b]])/(I-1);for(P=(T=d.jacobi(ye))[0],U=T[1],Me=d.transpose(P),H=0;H<U.length;H++)for(b=H;b<U.length;b++)U[H]<U[b]&&(A=U[H],U[H]=U[b],U[b]=A,ue=Me[H],Me[H]=Me[b],Me[b]=ue);for(S=d.transpose(ce),H=0;H<_;H++)for(je[H]=[],b=0;b<S.length;b++)je[H][b]=d.dot([Me[H]],[S[b]]);return[w,U,Me,je]}}),function(w){for(var b=0;b<w.length;b++)(function(A){d.fn[A]=function(T,S){var P=this;return S?(setTimeout(function(){S.call(P,d.fn[A].call(P,T))},15),this):typeof d[A](this,T)=="number"?d[A](this,T):d(d[A](this,T))}})(w[b])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(j,Math),function(d,h){var F=[].slice,V=d.utils.isNumber,m=d.utils.isArray;function l(v,w,b,A){if(v>1||b>1||v<=0||b<=0)throw new Error("Proportions should be greater than 0 and less than 1");var T=(v*w+b*A)/(w+A);return(v-b)/h.sqrt(T*(1-T)*(1/w+1/A))}d.extend({zscore:function(){var v=F.call(arguments);return V(v[1])?(v[0]-v[1])/v[2]:(v[0]-d.mean(v[1]))/d.stdev(v[1],v[2])},ztest:function(){var v,w=F.call(arguments);return m(w[1])?(v=d.zscore(w[0],w[1],w[3]),w[2]===1?d.normal.cdf(-h.abs(v),0,1):2*d.normal.cdf(-h.abs(v),0,1)):w.length>2?(v=d.zscore(w[0],w[1],w[2]),w[3]===1?d.normal.cdf(-h.abs(v),0,1):2*d.normal.cdf(-h.abs(v),0,1)):(v=w[0],w[1]===1?d.normal.cdf(-h.abs(v),0,1):2*d.normal.cdf(-h.abs(v),0,1))}}),d.extend(d.fn,{zscore:function(v,w){return(v-this.mean())/this.stdev(w)},ztest:function(v,w,b){var A=h.abs(this.zscore(v,b));return w===1?d.normal.cdf(-A,0,1):2*d.normal.cdf(-A,0,1)}}),d.extend({tscore:function(){var v=F.call(arguments);return v.length===4?(v[0]-v[1])/(v[2]/h.sqrt(v[3])):(v[0]-d.mean(v[1]))/(d.stdev(v[1],!0)/h.sqrt(v[1].length))},ttest:function(){var v,w=F.call(arguments);return w.length===5?(v=h.abs(d.tscore(w[0],w[1],w[2],w[3])),w[4]===1?d.studentt.cdf(-v,w[3]-1):2*d.studentt.cdf(-v,w[3]-1)):V(w[1])?(v=h.abs(w[0]),w[2]==1?d.studentt.cdf(-v,w[1]-1):2*d.studentt.cdf(-v,w[1]-1)):(v=h.abs(d.tscore(w[0],w[1])),w[2]==1?d.studentt.cdf(-v,w[1].length-1):2*d.studentt.cdf(-v,w[1].length-1))}}),d.extend(d.fn,{tscore:function(v){return(v-this.mean())/(this.stdev(!0)/h.sqrt(this.cols()))},ttest:function(v,w){return w===1?1-d.studentt.cdf(h.abs(this.tscore(v)),this.cols()-1):2*d.studentt.cdf(-h.abs(this.tscore(v)),this.cols()-1)}}),d.extend({anovafscore:function(){var v,w,b,A,T,S,P,_,I=F.call(arguments);if(I.length===1){for(T=new Array(I[0].length),P=0;P<I[0].length;P++)T[P]=I[0][P];I=T}for(w=new Array,P=0;P<I.length;P++)w=w.concat(I[P]);for(b=d.mean(w),v=0,P=0;P<I.length;P++)v+=I[P].length*h.pow(d.mean(I[P])-b,2);for(v/=I.length-1,S=0,P=0;P<I.length;P++)for(A=d.mean(I[P]),_=0;_<I[P].length;_++)S+=h.pow(I[P][_]-A,2);return v/(S/(w.length-I.length))},anovaftest:function(){var v,w,b,A,T=F.call(arguments);if(V(T[0]))return 1-d.centralF.cdf(T[0],T[1],T[2]);var S=d.anovafscore(T);for(v=T.length-1,b=0,A=0;A<T.length;A++)b+=T[A].length;return w=b-v-1,1-d.centralF.cdf(S,v,w)},ftest:function(v,w,b){return 1-d.centralF.cdf(v,w,b)}}),d.extend(d.fn,{anovafscore:function(){return d.anovafscore(this.toArray())},anovaftes:function(){var v,w=0;for(v=0;v<this.length;v++)w+=this[v].length;return d.ftest(this.anovafscore(),this.length-1,w-this.length)}}),d.extend({qscore:function(){var v,w,b,A,T,S=F.call(arguments);return V(S[0])?(v=S[0],w=S[1],b=S[2],A=S[3],T=S[4]):(v=d.mean(S[0]),w=d.mean(S[1]),b=S[0].length,A=S[1].length,T=S[2]),h.abs(v-w)/(T*h.sqrt((1/b+1/A)/2))},qtest:function(){var v,w=F.call(arguments);w.length===3?(v=w[0],w=w.slice(1)):w.length===7?(v=d.qscore(w[0],w[1],w[2],w[3],w[4]),w=w.slice(5)):(v=d.qscore(w[0],w[1],w[2]),w=w.slice(3));var b=w[0],A=w[1];return 1-d.tukey.cdf(v,A,b-A)},tukeyhsd:function(v){for(var w=d.pooledstdev(v),b=v.map(function(I){return d.mean(I)}),A=v.reduce(function(I,H){return I+H.length},0),T=[],S=0;S<v.length;++S)for(var P=S+1;P<v.length;++P){var _=d.qtest(b[S],b[P],v[S].length,v[P].length,w,A,v.length);T.push([[S,P],_])}return T}}),d.extend({normalci:function(){var v,w=F.call(arguments),b=new Array(2);return v=w.length===4?h.abs(d.normal.inv(w[1]/2,0,1)*w[2]/h.sqrt(w[3])):h.abs(d.normal.inv(w[1]/2,0,1)*d.stdev(w[2])/h.sqrt(w[2].length)),b[0]=w[0]-v,b[1]=w[0]+v,b},tci:function(){var v,w=F.call(arguments),b=new Array(2);return v=w.length===4?h.abs(d.studentt.inv(w[1]/2,w[3]-1)*w[2]/h.sqrt(w[3])):h.abs(d.studentt.inv(w[1]/2,w[2].length-1)*d.stdev(w[2],!0)/h.sqrt(w[2].length)),b[0]=w[0]-v,b[1]=w[0]+v,b},significant:function(v,w){return v<w}}),d.extend(d.fn,{normalci:function(v,w){return d.normalci(v,w,this.toArray())},tci:function(v,w){return d.tci(v,w,this.toArray())}}),d.extend(d.fn,{oneSidedDifferenceOfProportions:function(v,w,b,A){var T=l(v,w,b,A);return d.ztest(T,1)},twoSidedDifferenceOfProportions:function(v,w,b,A){var T=l(v,w,b,A);return d.ztest(T,2)}})}(j,Math),j.models=function(){function d(h,F){var V=h.length,m=F[0].length-1,l=V-m-1,v=j.lstsq(F,h),w=j.multiply(F,v.map(function(_){return[_]})).map(function(_){return _[0]}),b=j.subtract(h,w),A=j.mean(h),T=j.sum(w.map(function(_){return Math.pow(_-A,2)})),S=j.sum(h.map(function(_,I){return Math.pow(_-w[I],2)})),P=T+S;return{exog:F,endog:h,nobs:V,df_model:m,df_resid:l,coef:v,predict:w,resid:b,ybar:A,SST:P,SSE:T,SSR:S,R2:T/P}}return{ols:function(h,F){var V=d(h,F),m=function(w){var b,A,T=(b=w.exog,A=b[0].length,j.arange(A).map(function(U){var ue=j.arange(A).filter(function(je){return je!==U});return d(j.col(b,U).map(function(je){return je[0]}),j.col(b,ue))})),S=Math.sqrt(w.SSR/w.df_resid),P=T.map(function(U){var ue=U.SST,je=U.R2;return S/Math.sqrt(ue*(1-je))}),_=w.coef.map(function(U,ue){return(U-0)/P[ue]}),I=_.map(function(U){var ue=j.studentt.cdf(U,w.df_resid);return 2*(ue>.5?1-ue:ue)}),H=j.studentt.inv(.975,w.df_resid),K=w.coef.map(function(U,ue){var je=H*P[ue];return[U-je,U+je]});return{se:P,t:_,p:I,sigmaHat:S,interval95:K}}(V),l=function(w){var b,A,T,S=w.R2/w.df_model/((1-w.R2)/w.df_resid);return{F_statistic:S,pvalue:1-(b=S,A=w.df_model,T=w.df_resid,j.beta.cdf(b/(T/A+b),A/2,T/2))}}(V),v=1-(1-V.R2)*((V.nobs-1)/V.df_resid);return V.t=m,V.f=l,V.adjust_R2=v,V}}}(),j.extend({buildxmatrix:function(){for(var d=new Array(arguments.length),h=0;h<arguments.length;h++)d[h]=[1].concat(arguments[h]);return j(d)},builddxmatrix:function(){for(var d=new Array(arguments[0].length),h=0;h<arguments[0].length;h++)d[h]=[1].concat(arguments[0][h]);return j(d)},buildjxmatrix:function(d){for(var h=new Array(d.length),F=0;F<d.length;F++)h[F]=d[F];return j.builddxmatrix(h)},buildymatrix:function(d){return j(d).transpose()},buildjymatrix:function(d){return d.transpose()},matrixmult:function(d,h){var F,V,m,l,v;if(d.cols()==h.rows()){if(h.rows()>1){for(l=[],F=0;F<d.rows();F++)for(l[F]=[],V=0;V<h.cols();V++){for(v=0,m=0;m<d.cols();m++)v+=d.toArray()[F][m]*h.toArray()[m][V];l[F][V]=v}return j(l)}for(l=[],F=0;F<d.rows();F++)for(l[F]=[],V=0;V<h.cols();V++){for(v=0,m=0;m<d.cols();m++)v+=d.toArray()[F][m]*h.toArray()[V];l[F][V]=v}return j(l)}},regress:function(d,h){var F=j.xtranspxinv(d),V=d.transpose(),m=j.matrixmult(j(F),V);return j.matrixmult(m,h)},regresst:function(d,h,F){var V=j.regress(d,h),m={anova:{}},l=j.jMatYBar(d,V);m.yBar=l;var v=h.mean();m.anova.residuals=j.residuals(h,l),m.anova.ssr=j.ssr(l,v),m.anova.msr=m.anova.ssr/(d[0].length-1),m.anova.sse=j.sse(h,l),m.anova.mse=m.anova.sse/(h.length-(d[0].length-1)-1),m.anova.sst=j.sst(h,v),m.anova.mst=m.anova.sst/(h.length-1),m.anova.r2=1-m.anova.sse/m.anova.sst,m.anova.r2<0&&(m.anova.r2=0),m.anova.fratio=m.anova.msr/m.anova.mse,m.anova.pvalue=j.anovaftest(m.anova.fratio,d[0].length-1,h.length-(d[0].length-1)-1),m.anova.rmse=Math.sqrt(m.anova.mse),m.anova.r2adj=1-m.anova.mse/m.anova.mst,m.anova.r2adj<0&&(m.anova.r2adj=0),m.stats=new Array(d[0].length);for(var w,b,A,T=j.xtranspxinv(d),S=0;S<V.length;S++)w=Math.sqrt(m.anova.mse*Math.abs(T[S][S])),b=Math.abs(V[S]/w),A=j.ttest(b,h.length-d[0].length-1,F),m.stats[S]=[V[S],w,b,A];return m.regress=V,m},xtranspx:function(d){return j.matrixmult(d.transpose(),d)},xtranspxinv:function(d){var h=j.matrixmult(d.transpose(),d);return j.inv(h)},jMatYBar:function(d,h){var F=j.matrixmult(d,h);return new j(F)},residuals:function(d,h){return j.matrixsubtract(d,h)},ssr:function(d,h){for(var F=0,V=0;V<d.length;V++)F+=Math.pow(d[V]-h,2);return F},sse:function(d,h){for(var F=0,V=0;V<d.length;V++)F+=Math.pow(d[V]-h[V],2);return F},sst:function(d,h){for(var F=0,V=0;V<d.length;V++)F+=Math.pow(d[V]-h,2);return F},matrixsubtract:function(d,h){for(var F=new Array(d.length),V=0;V<d.length;V++){F[V]=new Array(d[V].length);for(var m=0;m<d[V].length;m++)F[V][m]=d[V][m]-h[V][m]}return j(F)}}),j.jStat=j,j)},960:function(X,j,d){const h=d(592);X.exports=function(F){function V(S,P){const _=P.split(".");let I=S;for(const H of _){if(I==null)return;I=I[H]}return I}for(let S=0;S<Object.keys(h).length;S++){let P,_=Object.keys(h)[S],I=[];if(typeof h[_]=="object"){I=Object.keys(h[_]),P=Object.values(h[_]);for(let H=0;H<P.length;H++)if(typeof P[H]=="object"){let K=I[H];h[_][K]&&(I=[...I,...Object.keys(h[_][K]).map(U=>K+"."+U)],I.splice(I.indexOf(K),1))}}if(I.length<1)F[_]=h[_];else for(let H=0;H<I.length;H++)typeof V(h[_],I[H])=="function"&&(F[_]=V(h[_],I[H]))}let m=function(S){return typeof S=="number"&&(S=parseInt(S)),S},l=null,v=null,w=null;F.TABLE=function(){return w},F.COLUMN=F.COL=function(){return w.tracking&&w.tracking.push(T.getColumnNameFromCoords(m(l),m(v))),m(l)+1},F.ROW=function(){return w.tracking&&w.tracking.push(T.getColumnNameFromCoords(m(l),m(v))),m(v)+1},F.CELL=function(){return T.getColumnNameFromCoords(l,v)},F.VALUE=function(S,P,_){return w.getValueFromCoords(m(S)-1,m(P)-1,_)},F.THISROWCELL=function(S){return w.getValueFromCoords(m(S)-1,m(v))};const b=function(S,P){for(let _=0;_<S.length;_++){let I=T.getTokensFromRange(S[_]);P=P.replace(S[_],"["+I.join(",")+"]")}return P},A=function(S){return typeof S=="string"&&(S=S.trim()),!isNaN(S)&&S!==null&&S!==""},T=function(S,P,_,I,H){w=H,l=_,v=I;let K="",U={};if(P)if(P.size){let ce,ye=null;P.forEach(function(Me,xe){ce=xe.replace(/!/g,"."),ce.indexOf(".")!==-1&&(ce=ce.split("."),U[ce[0]]=!0)}),ce=Object.keys(U);for(let Me=0;Me<ce.length;Me++)K+="var "+ce[Me]+" = {};";P.forEach(function(Me,xe){ce=xe.replace(/!/g,"."),Me===null||A(Me)||(ye=Me.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),ye&&ye.length&&(Me=updateRanges(ye,Me))),ce.indexOf(".")>0?K+=ce+" = "+P.get(xe)+`;
`:K+="var "+ce+" = "+Me+`;
`})}else{let ce=Object.keys(P);if(ce.length){let ye,Me={};for(let xe=0;xe<ce.length;xe++)if(ye=ce[xe].replace(/\!/g,"."),ye.indexOf(".")>0){let le=le.split(".");Me[le[0]]={}}ye=Object.keys(Me);for(let xe=0;xe<ye.length;xe++)K+="var "+ye[xe]+" = {};";for(let xe=0;xe<ce.length;xe++){if(ye=ce[xe].replace(/!/g,"."),P[ce[xe]]!==null&&!A(P[ce[xe]])){let le=P[ce[xe]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);le&&le.length&&(P[ce[xe]]=b(le,P[ce[xe]]))}ye.indexOf(".")>0?K+=ye+" = "+P[ce[xe]]+`;
`:K+="var "+ye+" = "+P[ce[xe]]+`;
`}}}let ue=(S=function(ce,ye){let Me="",xe=0,le=["=","!",">","<"];for(let ze=0;ze<ce.length;ze++)ce[ze]==='"'&&(xe=xe===0?1:0),xe===1?Me+=ce[ze]:(Me+=ce[ze].toUpperCase(),ze>0&&ce[ze]==="="&&le.indexOf(ce[ze-1])===-1&&le.indexOf(ce[ze+1])===-1&&(Me+="="));return Me=Me.replace(/\^/g,"**"),Me=Me.replace(/<>/g,"!="),Me=Me.replace(/&/g,"+"),Me=Me.replace(/\$/g,""),Me}(S=(S=S.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ue&&ue.length&&(S=b(ue,S));let je=new Function(K+"; return "+S)();return je===null&&(je=0),je};return T.getColumnNameFromCoords=function(S,P){return I="",(_=parseInt(S))>701?(I+=String.fromCharCode(64+parseInt(_/676)),I+=String.fromCharCode(64+parseInt(_%676/26))):_>25&&(I+=String.fromCharCode(64+parseInt(_/26))),I+String.fromCharCode(65+_%26)+(parseInt(P)+1);var _,I},T.getCoordsFromColumnName=function(S){var P=/^[a-zA-Z]+/.exec(S);if(P){for(var _=0,I=0;I<P[0].length;I++)_+=parseInt(P[0].charCodeAt(I)-64)*Math.pow(26,P[0].length-1-I);--_<0&&(_=0);var H=parseInt(/[0-9]+$/.exec(S))||null;return H>0&&H--,[_,H]}},T.getRangeFromTokens=function(S){S=S.filter(function(H){return H!="#REF!"});for(var P="",_="",I=0;I<S.length;I++)S[I].indexOf(".")>=0?P=".":S[I].indexOf("!")>=0&&(P="!"),P&&(_=S[I].split(P),S[I]=_[1],_=_[0]+P);return S.sort(function(H,K){var U=Helpers.getCoordsFromColumnName(H),ue=Helpers.getCoordsFromColumnName(K);return U[1]>ue[1]?1:U[1]<ue[1]?-1:U[0]>ue[0]?1:U[0]<ue[0]?-1:0}),S.length?_+(S[0]+":")+S[S.length-1]:"#REF!"},T.getTokensFromRange=function(S){if(S.indexOf(".")>0){var P=S.split(".");S=P[1],P=P[0]+"."}else S.indexOf("!")>0?(P=S.split("!"),S=P[1],P=P[0]+"!"):P="";S=S.split(":");var _=T.getCoordsFromColumnName(S[0]),I=T.getCoordsFromColumnName(S[1]);if(_[0]<=I[0])var H=_[0],K=I[0];else H=I[0],K=_[0];if(_[1]===null&&I[1]==null)for(var U=null,ue=null,je=Object.keys(vars),ce=0;ce<je.length;ce++){var ye=T.getCoordsFromColumnName(je[ce]);ye[0]===_[0]&&(U===null||ye[1]<U)&&(U=ye[1]),ye[0]===I[0]&&(ue===null||ye[1]>ue)&&(ue=ye[1])}else _[1]<=I[1]?(U=_[1],ue=I[1]):(U=I[1],ue=_[1]);for(var Me=[],xe=U;xe<=ue;xe++){var le=[];for(ce=H;ce<=K;ce++)le.push(P+T.getColumnNameFromCoords(ce,xe));Me.push(le)}return Me},T.setFormula=function(S){let P=Object.keys(S);for(let _=0;_<P.length;_++)typeof S[P[_]]=="function"&&(F[P[_]]=S[P[_]])},T.basic=!0,T}(typeof window>"u"?d.g:window)},592:function(X,j,d){var h=d(162),F=d(765);const V=new Error("#NULL!"),m=new Error("#DIV/0!"),l=new Error("#VALUE!"),v=new Error("#REF!"),w=new Error("#NAME?"),b=new Error("#NUM!"),A=new Error("#N/A"),T=new Error("#ERROR!"),S=new Error("#GETTING_DATA");var P=Object.freeze({__proto__:null,data:S,div0:m,error:T,na:A,name:w,nil:V,num:b,ref:v,value:l});function _(e){const o=[];return I(e,s=>{o.push(s)}),o}function I(e,o){let s=-1;const g=e.length;for(;++s<g&&o(e[s],s,e)!==!1;);return e}function H(e){let o,s=e.length;for(;s--;)if(o=e[s],typeof o!="number")if(o!==!0)if(o!==!1){if(typeof o=="string"){const g=W(o);e[s]=g instanceof Error?0:g}}else e[s]=0;else e[s]=1;return e}function K(e,o){if(!e)return l;e.every(D=>Array.isArray(D))&&e.length!==0||(e=[[...e]]),e.map((D,B)=>{D.map((G,ae)=>{G||(e[B][ae]=0)})});const s=e.reduce((D,B,G)=>B.length>e[D].length?G:D,0),g=e[s].length;return e.map(D=>[...D,...Array(g-D.length).fill(0)])}function U(){let e;if(arguments.length===1){const s=arguments[0];e=(o=s)!=null&&typeof o.length=="number"&&typeof o!="string"?_.apply(null,arguments):[s]}else e=Array.from(arguments);for(var o;!je(e);)e=ue(e);return e}function ue(e){return e&&e.reduce?e.reduce((o,s)=>{const g=Array.isArray(o),D=Array.isArray(s);return g&&D?o.concat(s):g?(o.push(s),o):D?[o].concat(s):[o,s]}):[e]}function je(e){if(!e)return!1;for(let o=0;o<e.length;++o)if(Array.isArray(e[o]))return!1;return!0}function ce(e,o){return o=o||1,e&&typeof e.slice=="function"?e.slice(o):e}function ye(e){return e?e[0].map((o,s)=>e.map(g=>g[s])):l}function Me(e,o){let s=null;return I(e,(g,D)=>{if(g[0]===o)return s=D,!1}),s??l}function xe(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function le(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function ze(e){return Math.round(e*1e14)/1e14}function We(){return U.apply(null,arguments).filter(e=>typeof e=="number")}function Ye(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const o=e.toUpperCase();if(o==="TRUE")return!0;if(o==="FALSE")return!1}return e instanceof Date&&!isNaN(e)||l}function Be(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const o=parseFloat(e);return o<0||o>=2958466?b:function(s){s<60&&(s+=1);const g=Math.floor(s-25569),D=new Date(86400*g*1e3),B=s-Math.floor(s)+1e-7;let G=Math.floor(86400*B);const ae=G%60;G-=ae;const pe=Math.floor(G/3600),Ae=Math.floor(G/60)%60;let ke=D.getUTCDate(),Ve=D.getUTCMonth();return s>=60&&s<61&&(ke=29,Ve=1),new Date(D.getUTCFullYear(),Ve,ke,pe,Ae,ae)}(o)}return typeof e!="string"||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?l:e}function dt(e){let o,s=e.length;for(;s--;){if(o=Be(e[s]),o===l)return o;e[s]=o}return e}function W(e){return e instanceof Error?e:e==null?0:(typeof e=="boolean"&&(e=+e),isNaN(e)||e===""?l:parseFloat(e))}function Ne(e){let o,s;if(!e||(o=e.length)===0)return l;for(;o--;){if(e[o]instanceof Error)return e[o];if(s=W(e[o]),s instanceof Error)return s;e[o]=s}return e}function Ue(e){return e instanceof Error?e:e==null?"":e.toString()}function jt(){let e=arguments.length;for(;e--;)if(typeof arguments[e]=="string")return!0;return!1}function ot(e){return e!=null}const Ie="=",De=[">",">=","<","<=","=","<>"],Pe="operator",qe="literal",et=[Pe,qe],rt=Pe,at=qe;function pt(e,o){if(et.indexOf(o)===-1)throw new Error("Unsupported token type: "+o);return{value:e,type:o}}function mt(e){return function(o){let s="";const g=[];for(let D=0;D<o.length;D++){const B=o[D];D===0&&De.indexOf(B)>=0?g.push(pt(B,rt)):s+=B}return s.length>0&&g.push(pt(function(D){return typeof D!="string"||/^\d+(\.\d+)?$/.test(D)&&(D=D.indexOf(".")===-1?parseInt(D,10):parseFloat(D)),D}(s),at)),g.length>0&&g[0].type!==rt&&g.unshift(pt(Ie,rt)),g}(function(o){const s=o.length,g=[];let D=0,B="",G="";for(;D<s;){const ae=o.charAt(D);switch(ae){case">":case"<":case"=":G+=ae,B.length>0&&(g.push(B),B="");break;default:G.length>0&&(g.push(G),G=""),B+=ae}D++}return B.length>0&&g.push(B),G.length>0&&g.push(G),g}(e))}const vt=function(e){const o=[];let s;for(let g=0;g<e.length;g++){const D=e[g];switch(D.type){case rt:s=D.value;break;case at:o.push(D.value)}}return function(g,D){let B=!1;switch(D){case">":B=g[0]>g[1];break;case">=":B=g[0]>=g[1];break;case"<":B=g[0]<g[1];break;case"<=":B=g[0]<=g[1];break;case"=":B=g[0]==g[1];break;case"<>":B=g[0]!=g[1]}return B}(o,s)},Ft={};function Tt(e){return[l,v,m,b,w,V].indexOf(e)>=0||typeof e=="number"&&(isNaN(e)||!isFinite(e))}function Dt(e){return Tt(e)||e===A}function Rt(e){return e===!0||e===!1}function gt(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function Ut(e){return typeof e=="string"}function St(){const e=[];for(let o=0;o<arguments.length;++o){let s=!1;const g=arguments[o];for(let D=0;D<e.length&&(s=e[D]===g,!s);++D);s||e.push(g)}return e}function E(e,o,s,g){if(!o||!s)return A;g=!(g===0||g===!1);let D=A;const B=typeof e=="number";let G=!1;for(let ae=0;ae<o.length;ae++){const pe=o[ae];if(pe[0]===e){D=s<pe.length+1?pe[s-1]:v;break}!G&&(B&&g&&pe[0]<=e||g&&typeof pe[0]=="string"&&pe[0].localeCompare(e)<0)&&(D=s<pe.length+1?pe[s-1]:v),B&&pe[0]>e&&(G=!0)}return D}function M(){const e=U(arguments).filter(ot);if(e.length===0)return m;const o=xe.apply(void 0,e);if(o)return o;const s=We(e),g=s.length;let D,B=0,G=0;for(let ae=0;ae<g;ae++)B+=s[ae],G+=1;return D=B/G,isNaN(D)&&(D=b),D}function u(){const e=U(arguments).filter(ot);if(e.length===0)return m;const o=xe.apply(void 0,e);if(o)return o;const s=e,g=s.length;let D,B=0,G=0;for(let ae=0;ae<g;ae++){const pe=s[ae];typeof pe=="number"&&(B+=pe),pe===!0&&B++,pe!==null&&G++}return D=B/G,isNaN(D)&&(D=b),D}Ft.TYPE=e=>{switch(e){case V:return 1;case m:return 2;case l:return 3;case v:return 4;case w:return 5;case b:return 6;case A:return 7;case S:return 8}return A};const a={DIST:function(e,o,s,g,D,B){return arguments.length<4?l:(D=D===void 0?0:D,B=B===void 0?1:B,le(e=W(e),o=W(o),s=W(s),D=W(D),B=W(B))?l:(e=(e-D)/(B-D),g?h.beta.cdf(e,o,s):h.beta.pdf(e,o,s)))},INV:(e,o,s,g,D)=>(g=g===void 0?0:g,D=D===void 0?1:D,le(e=W(e),o=W(o),s=W(s),g=W(g),D=W(D))?l:h.beta.inv(e,o,s)*(D-g)+g)},z={DIST:(e,o,s,g)=>le(e=W(e),o=W(o),s=W(s),g=W(g))?l:g?h.binomial.cdf(e,o,s):h.binomial.pdf(e,o,s)};z.DIST.RANGE=(e,o,s,g)=>{if(g=g===void 0?s:g,le(e=W(e),o=W(o),s=W(s),g=W(g)))return l;let D=0;for(let B=s;B<=g;B++)D+=Qe(e,B)*Math.pow(o,B)*Math.pow(1-o,e-B);return D},z.INV=(e,o,s)=>{if(le(e=W(e),o=W(o),s=W(s)))return l;let g=0;for(;g<=e;){if(h.binomial.cdf(g,e,o)>=s)return g;g++}};const ne={DIST:(e,o,s)=>le(e=W(e),o=W(o))?l:s?h.chisquare.cdf(e,o):h.chisquare.pdf(e,o)};ne.DIST.RT=(e,o)=>!e|!o?A:e<1||o>Math.pow(10,10)?b:typeof e!="number"||typeof o!="number"?l:1-h.chisquare.cdf(e,o),ne.INV=(e,o)=>le(e=W(e),o=W(o))?l:h.chisquare.inv(e,o),ne.INV.RT=(e,o)=>!e|!o?A:e<0||e>1||o<1||o>Math.pow(10,10)?b:typeof e!="number"||typeof o!="number"?l:h.chisquare.inv(1-e,o),ne.TEST=function(e,o){if(arguments.length!==2)return A;if(!(e instanceof Array&&o instanceof Array)||e.length!==o.length||e[0]&&o[0]&&e[0].length!==o[0].length)return l;const s=e.length;let g,D,B;for(D=0;D<s;D++)e[D]instanceof Array||(g=e[D],e[D]=[],e[D].push(g)),o[D]instanceof Array||(g=o[D],o[D]=[],o[D].push(g));const G=e[0].length,ae=G===1?s-1:(s-1)*(G-1);let pe=0;const Ae=Math.PI;for(D=0;D<s;D++)for(B=0;B<G;B++)pe+=Math.pow(e[D][B]-o[D][B],2)/o[D][B];return Math.round(1e6*function(ke,Ve){let _e=Math.exp(-.5*ke);Ve%2==1&&(_e*=Math.sqrt(2*ke/Ae));let Ze=Ve;for(;Ze>=2;)_e=_e*ke/Ze,Ze-=2;let nt=_e,it=Ve;for(;nt>1e-10*_e;)it+=2,nt=nt*ke/it,_e+=nt;return 1-_e}(pe,ae))/1e6};const oe={};function k(){return We(U(arguments)).length}function N(){const e=U(arguments);return e.length-Y(e)}function Y(){const e=U(arguments);let o,s=0;for(let g=0;g<e.length;g++)o=e[g],o!=null&&o!==""||s++;return s}oe.NORM=(e,o,s)=>le(e=W(e),o=W(o),s=W(s))?l:h.normalci(1,e,o,s)[1]-1,oe.T=(e,o,s)=>le(e=W(e),o=W(o),s=W(s))?l:h.tci(1,e,o,s)[1]-1;const J={P:(e,o)=>{if(le(e=Ne(U(e)),o=Ne(U(o))))return l;const s=h.mean(e),g=h.mean(o);let D=0;const B=e.length;for(let G=0;G<B;G++)D+=(e[G]-s)*(o[G]-g);return D/B},S:(e,o)=>le(e=Ne(U(e)),o=Ne(U(o)))?l:h.covariance(e,o)},ie={DIST:(e,o,s)=>le(e=W(e),o=W(o))?l:s?h.exponential.cdf(e,o):h.exponential.pdf(e,o)},ge={};function fe(e,o,s){if(le(e=W(e),o=Ne(U(o)),s=Ne(U(s))))return l;const g=h.mean(s),D=h.mean(o),B=s.length;let G=0,ae=0;for(let Ae=0;Ae<B;Ae++)G+=(s[Ae]-g)*(o[Ae]-D),ae+=Math.pow(s[Ae]-g,2);const pe=G/ae;return D-pe*g+pe*e}function he(e){return(e=W(e))instanceof Error?e:e===0||parseInt(e,10)===e&&e<0?b:h.gammafn(e)}function Le(e){return(e=W(e))instanceof Error?e:h.gammaln(e)}ge.DIST=(e,o,s,g)=>le(e=W(e),o=W(o),s=W(s))?l:g?h.centralF.cdf(e,o,s):h.centralF.pdf(e,o,s),ge.DIST.RT=function(e,o,s){return arguments.length!==3?A:e<0||o<1||s<1?b:typeof e!="number"||typeof o!="number"||typeof s!="number"?l:1-h.centralF.cdf(e,o,s)},ge.INV=(e,o,s)=>le(e=W(e),o=W(o),s=W(s))?l:e<=0||e>1?b:h.centralF.inv(e,o,s),ge.INV.RT=function(e,o,s){return arguments.length!==3?A:e<0||e>1||o<1||o>Math.pow(10,10)||s<1||s>Math.pow(10,10)?b:typeof e!="number"||typeof o!="number"||typeof s!="number"?l:h.centralF.inv(1-e,o,s)},ge.TEST=(e,o)=>{if(!e||!o||!(e instanceof Array&&o instanceof Array))return A;if(e.length<2||o.length<2)return m;const s=(B,G)=>{let ae=0;for(let pe=0;pe<B.length;pe++)ae+=Math.pow(B[pe]-G,2);return ae},g=Lt(e)/e.length,D=Lt(o)/o.length;return s(e,g)/(e.length-1)/(s(o,D)/(o.length-1))},he.DIST=function(e,o,s,g){return arguments.length!==4?A:e<0||o<=0||s<=0||typeof e!="number"||typeof o!="number"||typeof s!="number"?l:g?h.gamma.cdf(e,o,s,!0):h.gamma.pdf(e,o,s,!1)},he.INV=function(e,o,s){return arguments.length!==3?A:e<0||e>1||o<=0||s<=0?b:typeof e!="number"||typeof o!="number"||typeof s!="number"?l:h.gamma.inv(e,o,s)},Le.PRECISE=function(e){return arguments.length!==1?A:e<=0?b:typeof e!="number"?l:h.gammaln(e)};const Te={};function Fe(e,o){return le(e=Ne(U(e)),o=W(o))?e:o<0||e.length<o?l:e.sort((s,g)=>g-s)[o-1]}function Ge(e,o){if(le(e=Ne(U(e)),o=Ne(U(o))))return l;const s=h.mean(e),g=h.mean(o),D=o.length;let B=0,G=0;for(let pe=0;pe<D;pe++)B+=(o[pe]-g)*(e[pe]-s),G+=Math.pow(o[pe]-g,2);const ae=B/G;return[ae,s-ae*g]}Te.DIST=(e,o,s,g,D)=>{if(le(e=W(e),o=W(o),s=W(s),g=W(g)))return l;function B(G,ae,pe,Ae){return Qe(pe,G)*Qe(Ae-pe,ae-G)/Qe(Ae,ae)}return D?function(G,ae,pe,Ae){let ke=0;for(let Ve=0;Ve<=G;Ve++)ke+=B(Ve,ae,pe,Ae);return ke}(e,o,s,g):B(e,o,s,g)};const Xe={};function te(){const e=U(arguments),o=xe.apply(void 0,e);if(o)return o;const s=We(e);return s.length===0?0:Math.max.apply(Math,s)}function me(){const e=U(arguments),o=xe.apply(void 0,e);if(o)return o;const s=H(e);let g=h.median(s);return isNaN(g)&&(g=b),g}function Ee(){const e=U(arguments),o=xe.apply(void 0,e);if(o)return o;const s=We(e);return s.length===0?0:Math.min.apply(Math,s)}Xe.DIST=(e,o,s,g)=>le(e=W(e),o=W(o),s=W(s))?l:g?h.lognormal.cdf(e,o,s):h.lognormal.pdf(e,o,s),Xe.INV=(e,o,s)=>le(e=W(e),o=W(o),s=W(s))?l:h.lognormal.inv(e,o,s);const q={MULT:function(){const e=Ne(U(arguments));if(e instanceof Error)return e;const o=e.length,s={};let g,D=[],B=0;for(let G=0;G<o;G++)g=e[G],s[g]=s[g]?s[g]+1:1,s[g]>B&&(B=s[g],D=[]),s[g]===B&&(D[D.length]=g);return D},SNGL:function(){const e=Ne(U(arguments));return e instanceof Error?e:q.MULT(e).sort((o,s)=>o-s)[0]}},Q={DIST:(e,o,s,g)=>le(e=W(e),o=W(o),s=W(s))?l:g?h.negbin.cdf(e,o,s):h.negbin.pdf(e,o,s)},C={};function O(e,o){if(le(o=Ne(U(o)),e=Ne(U(e))))return l;const s=h.mean(e),g=h.mean(o),D=e.length;let B=0,G=0,ae=0;for(let pe=0;pe<D;pe++)B+=(e[pe]-s)*(o[pe]-g),G+=Math.pow(e[pe]-s,2),ae+=Math.pow(o[pe]-g,2);return B/Math.sqrt(G*ae)}C.DIST=(e,o,s,g)=>le(e=W(e),o=W(o),s=W(s))?l:s<=0?b:g?h.normal.cdf(e,o,s):h.normal.pdf(e,o,s),C.INV=(e,o,s)=>le(e=W(e),o=W(o),s=W(s))?l:h.normal.inv(e,o,s),C.S={},C.S.DIST=(e,o)=>(e=W(e))instanceof Error?l:o?h.normal.cdf(e,0,1):h.normal.pdf(e,0,1),C.S.INV=e=>(e=W(e))instanceof Error?l:h.normal.inv(e,0,1);const Z={EXC:(e,o)=>{if(le(e=Ne(U(e)),o=W(o)))return l;const s=(e=e.sort((B,G)=>B-G)).length;if(o<1/(s+1)||o>1-1/(s+1))return b;const g=o*(s+1)-1,D=Math.floor(g);return ze(g===D?e[g]:e[D]+(g-D)*(e[D+1]-e[D]))},INC:(e,o)=>{if(le(e=Ne(U(e)),o=W(o)))return l;const s=o*((e=e.sort((D,B)=>D-B)).length-1),g=Math.floor(s);return ze(s===g?e[s]:e[g]+(s-g)*(e[g+1]-e[g]))}},se={EXC:(e,o,s)=>{if(s=s===void 0?3:s,le(e=Ne(U(e)),o=W(o),s=W(s)))return l;e=e.sort((ke,Ve)=>ke-Ve);const g=St.apply(null,e),D=e.length,B=g.length,G=Math.pow(10,s);let ae=0,pe=!1,Ae=0;for(;!pe&&Ae<B;)o===g[Ae]?(ae=(e.indexOf(g[Ae])+1)/(D+1),pe=!0):o>=g[Ae]&&(o<g[Ae+1]||Ae===B-1)&&(ae=(e.indexOf(g[Ae])+1+(o-g[Ae])/(g[Ae+1]-g[Ae]))/(D+1),pe=!0),Ae++;return Math.floor(ae*G)/G},INC:(e,o,s)=>{if(s=s===void 0?3:s,le(e=Ne(U(e)),o=W(o),s=W(s)))return l;e=e.sort((ke,Ve)=>ke-Ve);const g=St.apply(null,e),D=e.length,B=g.length,G=Math.pow(10,s);let ae=0,pe=!1,Ae=0;for(;!pe&&Ae<B;)o===g[Ae]?(ae=e.indexOf(g[Ae])/(D-1),pe=!0):o>=g[Ae]&&(o<g[Ae+1]||Ae===B-1)&&(ae=(e.indexOf(g[Ae])+(o-g[Ae])/(g[Ae+1]-g[Ae]))/(D-1),pe=!0),Ae++;return Math.floor(ae*G)/G}},ee={DIST:(e,o,s)=>le(e=W(e),o=W(o))?l:s?h.poisson.cdf(e,o):h.poisson.pdf(e,o)},de={EXC:(e,o)=>{if(le(e=Ne(U(e)),o=W(o)))return l;switch(o){case 1:return Z.EXC(e,.25);case 2:return Z.EXC(e,.5);case 3:return Z.EXC(e,.75);default:return b}},INC:(e,o)=>{if(le(e=Ne(U(e)),o=W(o)))return l;switch(o){case 1:return Z.INC(e,.25);case 2:return Z.INC(e,.5);case 3:return Z.INC(e,.75);default:return b}}},be={};function Oe(){const e=Ne(U(arguments));if(e instanceof Error)return e;const o=h.mean(e),s=e.length;let g=0;for(let D=0;D<s;D++)g+=Math.pow(e[D]-o,3);return s*g/((s-1)*(s-2)*Math.pow(h.stdev(e,!0),3))}function we(e,o){return le(e=Ne(U(e)),o=W(o))?e:e.sort((s,g)=>s-g)[o-1]}be.AVG=(e,o,s)=>{if(le(e=W(e),o=Ne(U(o))))return l;const g=(s=s||!1)?(G,ae)=>G-ae:(G,ae)=>ae-G,D=(o=(o=U(o)).sort(g)).length;let B=0;for(let G=0;G<D;G++)o[G]===e&&B++;return B>1?(2*o.indexOf(e)+B+1)/2:o.indexOf(e)+1},be.EQ=(e,o,s)=>{if(le(e=W(e),o=Ne(U(o))))return l;const g=(s=s||!1)?(D,B)=>D-B:(D,B)=>B-D;return(o=o.sort(g)).indexOf(e)+1},Oe.P=function(){const e=Ne(U(arguments));if(e instanceof Error)return e;const o=h.mean(e),s=e.length;let g=0,D=0;for(let B=0;B<s;B++)D+=Math.pow(e[B]-o,3),g+=Math.pow(e[B]-o,2);return D/=s,g/=s,D/Math.pow(g,1.5)};const Se={P:function(){const e=Ke.P.apply(this,arguments);let o=Math.sqrt(e);return isNaN(o)&&(o=b),o},S:function(){const e=Ke.S.apply(this,arguments);return Math.sqrt(e)}},Re={DIST:(e,o,s)=>s!==1&&s!==2?b:s===1?Re.DIST.RT(e,o):Re.DIST["2T"](e,o)};Re.DIST["2T"]=function(e,o){return arguments.length!==2?A:e<0||o<1?b:typeof e!="number"||typeof o!="number"?l:2*(1-h.studentt.cdf(e,o))},Re.DIST.RT=function(e,o){return arguments.length!==2?A:e<0||o<1?b:typeof e!="number"||typeof o!="number"?l:1-h.studentt.cdf(e,o)},Re.INV=(e,o)=>le(e=W(e),o=W(o))?l:h.studentt.inv(e,o),Re.INV["2T"]=(e,o)=>(e=W(e),o=W(o),e<=0||e>1||o<1?b:le(e,o)?l:Math.abs(h.studentt.inv(e/2,o))),Re.TEST=(e,o)=>{if(le(e=Ne(U(e)),o=Ne(U(o))))return l;const s=h.mean(e),g=h.mean(o);let D,B=0,G=0;for(D=0;D<e.length;D++)B+=Math.pow(e[D]-s,2);for(D=0;D<o.length;D++)G+=Math.pow(o[D]-g,2);B/=e.length-1,G/=o.length-1;const ae=Math.abs(s-g)/Math.sqrt(B/e.length+G/o.length);return Re.DIST["2T"](ae,e.length+o.length-2)};const Ke={};function re(){const e=U(arguments),o=e.length;let s=0,g=0;const D=u(e);for(let B=0;B<o;B++){const G=e[B];s+=Math.pow(typeof G=="number"?G-D:G===!0?1-D:0-D,2),G!==null&&g++}return s/(g-1)}function ve(){const e=U(arguments),o=e.length;let s=0,g=0;const D=u(e);let B;for(let G=0;G<o;G++){const ae=e[G];s+=Math.pow(typeof ae=="number"?ae-D:ae===!0?1-D:0-D,2),ae!==null&&g++}return B=s/g,isNaN(B)&&(B=b),B}Ke.P=function(){const e=We(U(arguments)),o=e.length;let s=0;const g=M(e);let D;for(let B=0;B<o;B++)s+=Math.pow(e[B]-g,2);return D=s/o,isNaN(D)&&(D=b),D},Ke.S=function(){const e=We(U(arguments)),o=e.length;let s=0;const g=M(e);for(let D=0;D<o;D++)s+=Math.pow(e[D]-g,2);return s/(o-1)};const Ce={DIST:(e,o,s,g)=>le(e=W(e),o=W(o),s=W(s))?l:g?1-Math.exp(-Math.pow(e/s,o)):Math.pow(e,o-1)*Math.exp(-Math.pow(e/s,o))*o/Math.pow(s,o)},He={};function Je(e,o,s){const g=xe(e=W(e),o=W(o),s=W(s));if(g)return g;if(o===0)return 0;o=Math.abs(o);const D=-Math.floor(Math.log(o)/Math.log(10));return e>=0?Ct(Math.ceil(e/o)*o,D):s===0?-Ct(Math.floor(Math.abs(e)/o)*o,D):-Ct(Math.ceil(Math.abs(e)/o)*o,D)}function Qe(e,o){return xe(e=W(e),o=W(o))||(e<o?b:ht(e)/(ht(o)*ht(e-o)))}He.TEST=(e,o,s)=>{if(le(e=Ne(U(e)),o=W(o)))return l;s=s||Se.S(e);const g=e.length;return 1-C.S.DIST((M(e)-o)/(s/Math.sqrt(g)),!0)},Je.MATH=Je,Je.PRECISE=Je;const ut=[];function ht(e){if((e=W(e))instanceof Error)return e;const o=Math.floor(e);return o===0||o===1?1:(ut[o]>0||(ut[o]=ht(o-1)*o),ut[o])}function tt(e,o){const s=xe(e=W(e),o=W(o));if(s)return s;if(o===0)return 0;if(!(e>=0&&o>0||e<=0&&o<0))return b;o=Math.abs(o);const g=-Math.floor(Math.log(o)/Math.log(10));return e>=0?Ct(Math.floor(e/o)*o,g):-Ct(Math.ceil(Math.abs(e)/o),g)}tt.MATH=(e,o,s)=>{if(o instanceof Error)return o;o=o===void 0?0:o;const g=xe(e=W(e),o=W(o),s=W(s));if(g)return g;if(o===0)return 0;o=o?Math.abs(o):1;const D=-Math.floor(Math.log(o)/Math.log(10));return e>=0?Ct(Math.floor(e/o)*o,D):s===0||s===void 0?-Ct(Math.ceil(Math.abs(e)/o)*o,D):-Ct(Math.floor(Math.abs(e)/o)*o,D)},tt.PRECISE=tt.MATH;const ct={CEILING:Je};function $e(e,o){const s=xe(e=W(e),o=W(o));if(s)return s;if(e===0&&o===0)return b;const g=Math.pow(e,o);return isNaN(g)?b:g}function Wt(){const e=U(arguments).filter(g=>g!=null);if(e.length===0)return 0;const o=Ne(e);if(o instanceof Error)return o;let s=1;for(let g=0;g<o.length;g++)s*=o[g];return s}function Ct(e,o){return xe(e=W(e),o=W(o))||+(Math.round(+(e+"e"+o))+"e"+-1*o)}function Lt(){let e=0;return I(_(arguments),o=>{if(e instanceof Error)return!1;if(o instanceof Error)e=o;else if(typeof o=="number")e+=o;else if(typeof o=="string"){const s=parseFloat(o);!isNaN(s)&&(e+=s)}else if(Array.isArray(o)){const s=Lt.apply(null,o);s instanceof Error?e=s:e+=s}}),e}var pn=Object.freeze({__proto__:null,ADD:function(e,o){return arguments.length!==2?A:xe(e=W(e),o=W(o))||e+o},DIVIDE:function(e,o){return arguments.length!==2?A:xe(e=W(e),o=W(o))||(o===0?m:e/o)},EQ:function(e,o){return arguments.length!==2?A:e instanceof Error?e:o instanceof Error?o:(e===null&&(e=void 0),o===null&&(o=void 0),e===o)},GT:function(e,o){return arguments.length!==2?A:e instanceof Error?e:o instanceof Error?o:(jt(e,o)?(e=Ue(e),o=Ue(o)):(e=W(e),o=W(o)),xe(e,o)||e>o)},GTE:function(e,o){return arguments.length!==2?A:(jt(e,o)?(e=Ue(e),o=Ue(o)):(e=W(e),o=W(o)),xe(e,o)||e>=o)},LT:function(e,o){return arguments.length!==2?A:(jt(e,o)?(e=Ue(e),o=Ue(o)):(e=W(e),o=W(o)),xe(e,o)||e<o)},LTE:function(e,o){return arguments.length!==2?A:(jt(e,o)?(e=Ue(e),o=Ue(o)):(e=W(e),o=W(o)),xe(e,o)||e<=o)},MINUS:function(e,o){return arguments.length!==2?A:xe(e=W(e),o=W(o))||e-o},MULTIPLY:function(e,o){return arguments.length!==2?A:xe(e=W(e),o=W(o))||e*o},NE:function(e,o){return arguments.length!==2?A:e instanceof Error?e:o instanceof Error?o:(e===null&&(e=void 0),o===null&&(o=void 0),e!==o)},POW:function(e,o){return arguments.length!==2?A:$e(e,o)}});const hn=new Date(Date.UTC(1900,0,1)),gn=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],bn=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],Ht=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function Ot(e,o,s){s=s.toUpperCase(),e=Be(e),o=Be(o);const g=e.getFullYear(),D=e.getMonth(),B=e.getDate(),G=o.getFullYear(),ae=o.getMonth(),pe=o.getDate();let Ae;switch(s){case"Y":Ae=Math.floor(Gt(e,o));break;case"D":Ae=Mt(o,e);break;case"M":Ae=ae-D+12*(G-g),pe<B&&Ae--;break;case"MD":B<=pe?Ae=pe-B:(ae===0?(e.setFullYear(G-1),e.setMonth(12)):(e.setFullYear(G),e.setMonth(ae-1)),Ae=Mt(o,e));break;case"YM":Ae=ae-D+12*(G-g),pe<B&&Ae--,Ae%=12;break;case"YD":ae>D||ae===D&&pe<B?e.setFullYear(G):e.setFullYear(G-1),Ae=Mt(o,e)}return Ae}function _t(e){const o=new Date(e);return o.setHours(0,0,0,0),o}function Mt(e,o){return e=Be(e),o=Be(o),e instanceof Error?e:o instanceof Error?o:rn(_t(e))-rn(_t(o))}function Et(e,o,s){if(s=Ye(s||"false"),e=Be(e),o=Be(o),e instanceof Error)return e;if(o instanceof Error)return o;if(s instanceof Error)return s;const g=e.getMonth();let D,B,G=o.getMonth();if(s)D=e.getDate()===31?30:e.getDate(),B=o.getDate()===31?30:o.getDate();else{const ae=new Date(e.getFullYear(),g+1,0).getDate(),pe=new Date(o.getFullYear(),G+1,0).getDate();D=e.getDate()===ae?30:e.getDate(),o.getDate()===pe?D<30?(G++,B=1):B=30:B=o.getDate()}return 360*(o.getFullYear()-e.getFullYear())+30*(G-g)+(B-D)}function on(e){if((e=Be(e))instanceof Error)return e;(e=_t(e)).setDate(e.getDate()+4-(e.getDay()||7));const o=new Date(e.getFullYear(),0,1);return Math.ceil(((e-o)/864e5+1)/7)}function Bt(e,o,s){return Bt.INTL(e,o,1,s)}function Pt(e,o,s){return Pt.INTL(e,o,1,s)}function qt(e){return new Date(e,1,29).getMonth()===1}function Vt(e,o){return Math.ceil((o-e)/1e3/60/60/24)}function Gt(e,o,s){if((e=Be(e))instanceof Error)return e;if((o=Be(o))instanceof Error)return o;s=s||0;let g=e.getDate();const D=e.getMonth()+1,B=e.getFullYear();let G=o.getDate();const ae=o.getMonth()+1,pe=o.getFullYear();switch(s){case 0:return g===31&&G===31?(g=30,G=30):g===31?g=30:g===30&&G===31&&(G=30),(G+30*ae+360*pe-(g+30*D+360*B))/360;case 1:{const Ae=(Ze,nt)=>{const it=Ze.getFullYear(),xt=new Date(it,2,1);if(qt(it)&&Ze<xt&&nt>=xt)return!0;const ft=nt.getFullYear(),At=new Date(ft,2,1);return qt(ft)&&nt>=At&&Ze<At};let ke=365;if(B===pe||B+1===pe&&(D>ae||D===ae&&g>=G))return(B===pe&&qt(B)||Ae(e,o)||ae===1&&G===29)&&(ke=366),Vt(e,o)/ke;const Ve=pe-B+1,_e=(new Date(pe+1,0,1)-new Date(B,0,1))/1e3/60/60/24/Ve;return Vt(e,o)/_e}case 2:return Vt(e,o)/360;case 3:return Vt(e,o)/365;case 4:return(G+30*ae+360*pe-(g+30*D+360*B))/360}}function rn(e){const o=e>-22038912e5?2:1;return Math.ceil((e-hn)/864e5)+o}function an(e){return(e=W(e))===0?l:e instanceof Error?e:String.fromCharCode(e)}function sn(e){if(le(e))return e;let o=(e=e||"").charCodeAt(0);return isNaN(o)&&(o=l),o}function ln(){const e=U(arguments),o=xe.apply(void 0,e);if(o)return o;let s=0;for(;(s=e.indexOf(!0))>-1;)e[s]="TRUE";let g=0;for(;(g=e.indexOf(!1))>-1;)e[g]="FALSE";return e.join("")}Bt.INTL=(e,o,s,g)=>{if((e=Be(e))instanceof Error)return e;if((o=Be(o))instanceof Error)return o;let D=!1;const B=[],G=[1,2,3,4,5,6,0],ae=new RegExp("^[0|1]{7}$");if(s===void 0)s=Ht[1];else if(typeof s=="string"&&ae.test(s)){D=!0,s=s.split("");for(let Ve=0;Ve<s.length;Ve++)s[Ve]==="1"&&B.push(G[Ve])}else s=Ht[s];if(!(s instanceof Array))return l;g===void 0?g=[]:g instanceof Array||(g=[g]);for(let Ve=0;Ve<g.length;Ve++){const _e=Be(g[Ve]);if(_e instanceof Error)return _e;g[Ve]=_e}const pe=Math.round((o-e)/864e5)+1;let Ae=pe;const ke=e;for(let Ve=0;Ve<pe;Ve++){const _e=new Date().getTimezoneOffset()>0?ke.getUTCDay():ke.getDay();let Ze=D?B.includes(_e):_e===s[0]||_e===s[1];for(let nt=0;nt<g.length;nt++){const it=g[nt];if(it.getDate()===ke.getDate()&&it.getMonth()===ke.getMonth()&&it.getFullYear()===ke.getFullYear()){Ze=!0;break}}Ze&&Ae--,ke.setDate(ke.getDate()+1)}return Ae},Pt.INTL=(e,o,s,g)=>{if((e=Be(e))instanceof Error)return e;if((o=W(o))instanceof Error)return o;if(o<0)return b;if(!((s=s===void 0?Ht[1]:Ht[s])instanceof Array))return l;g===void 0?g=[]:g instanceof Array||(g=[g]);for(let B=0;B<g.length;B++){const G=Be(g[B]);if(G instanceof Error)return G;g[B]=G}let D=0;for(;D<o;){e.setDate(e.getDate()+1);const B=e.getDay();if(B!==s[0]&&B!==s[1]){for(let G=0;G<g.length;G++){const ae=g[G];if(ae.getDate()===e.getDate()&&ae.getMonth()===e.getMonth()&&ae.getFullYear()===e.getFullYear()){D--;break}}D++}}return e};const mn=ln;function cn(e,o=2,s=!1){if(e=W(e),isNaN(e)||(o=W(o),isNaN(o)))return l;if(o<0){const g=Math.pow(10,-o);e=Math.round(e/g)*g}else e=e.toFixed(o);if(s)e=e.toString().replace(/,/g,"");else{const g=e.toString().split(".");g[0]=g[0].replace(/\B(?=(\d{3})+$)/g,","),e=g.join(".")}return e}function yt(e,o){return xe(e,o)||(e=Ue(e),(o=W(o))instanceof Error?o:new Array(o+1).join(e))}const jn=an,vn=sn;function Xt(e){return/^[01]{1,10}$/.test(e)}function bt(e,o,s){if(le(e=W(e),o=W(o)))return e;if((s=s===void 0?"i":s)!=="i"&&s!=="j")return l;if(e===0&&o===0)return 0;if(e===0)return o===1?s:o.toString()+s;if(o===0)return e.toString();{const g=o>0?"+":"";return e.toString()+g+(o===1?s:o.toString()+s)}}function Zt(e,o){return o=o===void 0?0:o,le(e=W(e),o=W(o))?l:h.erf(e)}function Jt(e){return isNaN(e)?l:h.erfc(e)}function Qt(e){const o=lt(e),s=st(e);return le(o,s)?l:Math.sqrt(Math.pow(o,2)+Math.pow(s,2))}function st(e){if(e===void 0||e===!0||e===!1)return l;if(e===0||e==="0")return 0;if(["i","j"].indexOf(e)>=0)return 1;let o=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),s=e.indexOf("-");o===0&&(o=e.indexOf("+",1)),s===0&&(s=e.indexOf("-",1));const g=e.substring(e.length-1,e.length),D=g==="i"||g==="j";return o>=0||s>=0?D?o>=0?isNaN(e.substring(0,o))||isNaN(e.substring(o+1,e.length-1))?b:Number(e.substring(o+1,e.length-1)):isNaN(e.substring(0,s))||isNaN(e.substring(s+1,e.length-1))?b:-Number(e.substring(s+1,e.length-1)):b:D?isNaN(e.substring(0,e.length-1))?b:e.substring(0,e.length-1):isNaN(e)?b:0}function $t(e){const o=lt(e),s=st(e);return le(o,s)?l:o===0&&s===0?m:o===0&&s>0?Math.PI/2:o===0&&s<0?-Math.PI/2:s===0&&o>0?0:s===0&&o<0?-Math.PI:o>0?Math.atan(s/o):o<0&&s>=0?Math.atan(s/o)+Math.PI:Math.atan(s/o)-Math.PI}function zt(e){const o=lt(e),s=st(e);if(le(o,s))return l;let g=e.substring(e.length-1);return g=g==="i"||g==="j"?g:"i",bt(Math.cos(o)*(Math.exp(s)+Math.exp(-s))/2,-Math.sin(o)*(Math.exp(s)-Math.exp(-s))/2,g)}function un(e){const o=lt(e),s=st(e);if(le(o,s))return l;let g=e.substring(e.length-1);return g=g==="i"||g==="j"?g:"i",bt(Math.cos(s)*(Math.exp(o)+Math.exp(-o))/2,Math.sin(s)*(Math.exp(o)-Math.exp(-o))/2,g)}function It(e,o){const s=lt(e),g=st(e),D=lt(o),B=st(o);if(le(s,g,D,B))return l;const G=e.substring(e.length-1),ae=o.substring(o.length-1);let pe="i";if((G==="j"||ae==="j")&&(pe="j"),D===0&&B===0)return b;const Ae=D*D+B*B;return bt((s*D+g*B)/Ae,(g*D-s*B)/Ae,pe)}function lt(e){if(e===void 0||e===!0||e===!1)return l;if(e===0||e==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let o=(e+="").indexOf("+"),s=e.indexOf("-");o===0&&(o=e.indexOf("+",1)),s===0&&(s=e.indexOf("-",1));const g=e.substring(e.length-1,e.length),D=g==="i"||g==="j";return o>=0||s>=0?D?o>=0?isNaN(e.substring(0,o))||isNaN(e.substring(o+1,e.length-1))?b:Number(e.substring(0,o)):isNaN(e.substring(0,s))||isNaN(e.substring(s+1,e.length-1))?b:Number(e.substring(0,s)):b:D?isNaN(e.substring(0,e.length-1))?b:0:isNaN(e)?b:e}function Yt(e){const o=lt(e),s=st(e);if(le(o,s))return l;let g=e.substring(e.length-1);return g=g==="i"||g==="j"?g:"i",bt(Math.sin(o)*(Math.exp(s)+Math.exp(-s))/2,Math.cos(o)*(Math.exp(s)-Math.exp(-s))/2,g)}function dn(e){const o=lt(e),s=st(e);if(le(o,s))return l;let g=e.substring(e.length-1);return g=g==="i"||g==="j"?g:"i",bt(Math.cos(s)*(Math.exp(o)-Math.exp(-o))/2,Math.sin(s)*(Math.exp(o)+Math.exp(-o))/2,g)}Zt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Jt.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const xn=a.DIST,yn=a.INV,wn=z.DIST,Cn=Je.MATH,En=Je.PRECISE,An=ne.DIST,Ln=ne.DIST.RT,Mn=ne.INV,In=ne.INV.RT,Nn=ne.TEST,Dn=J.P,Tn=J.P,Sn=J.S,On=z.INV,kn=Jt.PRECISE,Fn=Zt.PRECISE,Rn=ie.DIST,Hn=ge.DIST,_n=ge.DIST.RT,Bn=ge.INV,Pn=ge.INV.RT,Vn=tt.MATH,zn=tt.PRECISE,Yn=ge.TEST,Un=he.DIST,Wn=he.INV,qn=Le.PRECISE,Gn=Te.DIST,Xn=Xe.INV,Zn=Xe.DIST,Jn=Xe.INV,Qn=q.MULT,$n=q.SNGL,Kn=Q.DIST,eo=Bt.INTL,to=C.DIST,no=C.INV,oo=C.S.DIST,ro=C.S.INV,io=Z.EXC,ao=Z.INC,so=se.EXC,lo=se.INC,co=ee.DIST,uo=de.EXC,fo=de.INC,po=be.AVG,ho=be.EQ,go=Oe.P,bo=Se.P,mo=Se.S,jo=Re.DIST,vo=Re.DIST.RT,xo=Re.INV,yo=Re.TEST,wo=Ke.P,Co=Ke.S,Eo=Ce.DIST,Ao=Pt.INTL,Lo=He.TEST;function Kt(e){const o=[];return I(e,s=>{s&&o.push(s)}),o}function wt(e,o){const s={};for(let B=1;B<e[0].length;++B)s[B]=!0;let g=o[0].length;for(let B=1;B<o.length;++B)o[B].length>g&&(g=o[B].length);for(let B=1;B<e.length;++B)for(let G=1;G<e[B].length;++G){let ae=!1,pe=!1;for(let Ae=0;Ae<o.length;++Ae){const ke=o[Ae];if(ke.length<g)continue;const Ve=ke[0];if(e[B][0]===Ve){pe=!0;for(let _e=1;_e<ke.length;++_e)if(!ae)if(ke[_e]===void 0||ke[_e]==="*")ae=!0;else{const Ze=mt(ke[_e]+""),nt=[pt(e[B][G],at)].concat(Ze);ae=vt(nt)}}}pe&&(s[G]=s[G]&&ae)}const D=[];for(let B=0;B<e[0].length;++B)s[B]&&D.push(B-1);return D}function en(e){return e&&e.getTime&&!isNaN(e.getTime())}function tn(e){return e instanceof Date?e:new Date(e)}function Nt(e,o,s,g,D){if(g=g||0,D=D||0,le(e=W(e),o=W(o),s=W(s),g=W(g),D=W(D)))return l;let B;if(e===0)B=g+s*o;else{const G=Math.pow(1+e,o);B=D===1?g*G+s*(1+e)*(G-1)/e:g*G+s*(G-1)/e}return-B}function fn(e,o,s,g,D,B){if(D=D||0,B=B||0,le(e=W(e),o=W(o),s=W(s),g=W(g),D=W(D),B=W(B)))return l;const G=kt(e,s,g,D,B);return(o===1?B===1?0:-g:B===1?Nt(e,o-2,G,g,1)-G:Nt(e,o-1,G,g,0))*e}function nn(){const e=Ne(U(arguments));if(e instanceof Error)return e;const o=e[0];let s=0;for(let g=1;g<e.length;g++)s+=e[g]/Math.pow(1+o,g);return s}function kt(e,o,s,g,D){if(g=g||0,D=D||0,le(e=W(e),o=W(o),s=W(s),g=W(g),D=W(D)))return l;let B;if(e===0)B=(s+g)/o;else{const G=Math.pow(1+e,o);B=D===1?(g*e/(G-1)+s*e/(1-1/G))/(1+e):g*e/(G-1)+s*e/(1-1/G)}return-B}const Mo={errors:P,symbols:pn};j.ABS=function(e){return(e=W(e))instanceof Error?e:Math.abs(e)},j.ACCRINT=function(e,o,s,g,D,B,G){return e=tn(e),o=tn(o),s=tn(s),en(e)&&en(o)&&en(s)?g<=0||D<=0||[1,2,4].indexOf(B)===-1||[0,1,2,3,4].indexOf(G)===-1||s<=e?b:(D=D||0)*g*Gt(e,s,G=G||0):l},j.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},j.ACOS=function(e){if((e=W(e))instanceof Error)return e;let o=Math.acos(e);return isNaN(o)&&(o=b),o},j.ACOSH=function(e){if((e=W(e))instanceof Error)return e;let o=Math.log(e+Math.sqrt(e*e-1));return isNaN(o)&&(o=b),o},j.ACOT=function(e){return(e=W(e))instanceof Error?e:Math.atan(1/e)},j.ACOTH=function(e){if((e=W(e))instanceof Error)return e;let o=.5*Math.log((e+1)/(e-1));return isNaN(o)&&(o=b),o},j.AGGREGATE=function(e,o,s,g){if(le(e=W(e),W(e)))return l;switch(e){case 1:return M(s);case 2:return k(s);case 3:return N(s);case 4:return te(s);case 5:return Ee(s);case 6:return Wt(s);case 7:return Se.S(s);case 8:return Se.P(s);case 9:return Lt(s);case 10:return Ke.S(s);case 11:return Ke.P(s);case 12:return me(s);case 13:return q.SNGL(s);case 14:return Fe(s,g);case 15:return we(s,g);case 16:return Z.INC(s,g);case 17:return de.INC(s,g);case 18:return Z.EXC(s,g);case 19:return de.EXC(s,g)}},j.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},j.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},j.AND=function(){const e=U(arguments);let o=l;for(let s=0;s<e.length;s++){if(e[s]instanceof Error)return e[s];e[s]!==void 0&&e[s]!==null&&typeof e[s]!="string"&&(o===l&&(o=!0),e[s]||(o=!1))}return o},j.ARABIC=function(e){if(e==null)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return l;let o=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,s=>{o+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[s]}),o},j.ASC=function(){throw new Error("ASC is not implemented")},j.ASIN=function(e){if((e=W(e))instanceof Error)return e;let o=Math.asin(e);return isNaN(o)&&(o=b),o},j.ASINH=function(e){return(e=W(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},j.ATAN=function(e){return(e=W(e))instanceof Error?e:Math.atan(e)},j.ATAN2=function(e,o){return xe(e=W(e),o=W(o))||Math.atan2(e,o)},j.ATANH=function(e){if((e=W(e))instanceof Error)return e;let o=Math.log((1+e)/(1-e))/2;return isNaN(o)&&(o=b),o},j.AVEDEV=function(){const e=U(arguments).filter(ot);if(e.length===0)return b;const o=Ne(e);return o instanceof Error?o:h.sum(h(o).subtract(h.mean(o)).abs()[0])/o.length},j.AVERAGE=M,j.AVERAGEA=u,j.AVERAGEIF=function(e,o,s){if(arguments.length<=1)return A;if(s=Ne(U(s=s||e).filter(ot)),e=U(e),s instanceof Error)return s;let g=0,D=0;const B=o===void 0||o==="*",G=B?null:mt(o+"");for(let ae=0;ae<e.length;ae++){const pe=e[ae];if(B)D+=s[ae],g++;else{const Ae=[pt(pe,at)].concat(G);vt(Ae)&&(D+=s[ae],g++)}}return D/g},j.AVERAGEIFS=function(){const e=_(arguments),o=(e.length-1)/2,s=U(e[0]);let g=0,D=0;for(let G=0;G<s.length;G++){let ae=!1;for(let pe=0;pe<o;pe++){const Ae=e[2*pe+1][G],ke=e[2*pe+2];let Ve=!1;if(ke===void 0||ke==="*")Ve=!0;else{const _e=mt(ke+""),Ze=[pt(Ae,at)].concat(_e);Ve=vt(Ze)}if(!Ve){ae=!1;break}ae=!0}ae&&(D+=s[G],g++)}const B=D/g;return isNaN(B)?0:B},j.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},j.BASE=function(e,o,s){const g=xe(e=W(e),o=W(o),s=W(s));if(g)return g;if(o===0)return b;const D=e.toString(o);return new Array(Math.max(s+1-D.length,0)).join("0")+D},j.BESSELI=function(e,o){return le(e=W(e),o=W(o))?l:F.besseli(e,o)},j.BESSELJ=function(e,o){return le(e=W(e),o=W(o))?l:F.besselj(e,o)},j.BESSELK=function(e,o){return le(e=W(e),o=W(o))?l:F.besselk(e,o)},j.BESSELY=function(e,o){return le(e=W(e),o=W(o))?l:F.bessely(e,o)},j.BETA=a,j.BETADIST=xn,j.BETAINV=yn,j.BIN2DEC=function(e){if(!Xt(e))return b;const o=parseInt(e,2),s=e.toString();return s.length===10&&s.substring(0,1)==="1"?parseInt(s.substring(1),2)-512:o},j.BIN2HEX=function(e,o){if(!Xt(e))return b;const s=e.toString();if(s.length===10&&s.substring(0,1)==="1")return(0xfffffffe00+parseInt(s.substring(1),2)).toString(16);const g=parseInt(e,2).toString(16);return o===void 0?g:isNaN(o)?l:o<0?b:(o=Math.floor(o))>=g.length?yt("0",o-g.length)+g:b},j.BIN2OCT=function(e,o){if(!Xt(e))return b;const s=e.toString();if(s.length===10&&s.substring(0,1)==="1")return(1073741312+parseInt(s.substring(1),2)).toString(8);const g=parseInt(e,2).toString(8);return o===void 0?g:isNaN(o)?l:o<0?b:(o=Math.floor(o))>=g.length?yt("0",o-g.length)+g:b},j.BINOM=z,j.BINOMDIST=wn,j.BITAND=function(e,o){return le(e=W(e),o=W(o))?l:e<0||o<0||Math.floor(e)!==e||Math.floor(o)!==o||e>0xffffffffffff||o>0xffffffffffff?b:e&o},j.BITLSHIFT=function(e,o){return le(e=W(e),o=W(o))?l:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(o)>53?b:o>=0?e<<o:e>>-o},j.BITOR=function(e,o){return le(e=W(e),o=W(o))?l:e<0||o<0||Math.floor(e)!==e||Math.floor(o)!==o||e>0xffffffffffff||o>0xffffffffffff?b:e|o},j.BITRSHIFT=function(e,o){return le(e=W(e),o=W(o))?l:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(o)>53?b:o>=0?e>>o:e<<-o},j.BITXOR=function(e,o){return le(e=W(e),o=W(o))?l:e<0||o<0||Math.floor(e)!==e||Math.floor(o)!==o||e>0xffffffffffff||o>0xffffffffffff?b:e^o},j.CEILING=Je,j.CEILINGMATH=Cn,j.CEILINGPRECISE=En,j.CELL=function(){throw new Error("CELL is not implemented")},j.CHAR=an,j.CHIDIST=An,j.CHIDISTRT=Ln,j.CHIINV=Mn,j.CHIINVRT=In,j.CHISQ=ne,j.CHITEST=Nn,j.CHOOSE=function(){if(arguments.length<2)return A;const e=arguments[0];return e<1||e>254||arguments.length<e+1?l:arguments[e]},j.CLEAN=function(e){return le(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},j.CODE=sn,j.COLUMN=function(e,o){return arguments.length!==2?A:o<0?b:e instanceof Array&&typeof o=="number"?e.length!==0?h.col(e,o):void 0:l},j.COLUMNS=function(e){return arguments.length!==1?A:e instanceof Array?e.length===0?0:h.cols(e):l},j.COMBIN=Qe,j.COMBINA=function(e,o){return xe(e=W(e),o=W(o))||(e<o?b:e===0&&o===0?1:Qe(e+o-1,e-1))},j.COMPLEX=bt,j.CONCAT=mn,j.CONCATENATE=ln,j.CONFIDENCE=oe,j.CONVERT=function(e,o,s){if((e=W(e))instanceof Error)return e;const g=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],D={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},B={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let G,ae=null,pe=null,Ae=o,ke=s,Ve=1,_e=1;for(let Ze=0;Ze<g.length;Ze++)G=g[Ze][2]===null?[]:g[Ze][2],(g[Ze][1]===Ae||G.indexOf(Ae)>=0)&&(ae=g[Ze]),(g[Ze][1]===ke||G.indexOf(ke)>=0)&&(pe=g[Ze]);if(ae===null){const Ze=D[o.substring(0,2)];let nt=B[o.substring(0,1)];o.substring(0,2)==="da"&&(nt=["dekao",10,"da"]),Ze?(Ve=Ze[2],Ae=o.substring(2)):nt&&(Ve=nt[1],Ae=o.substring(nt[2].length));for(let it=0;it<g.length;it++)G=g[it][2]===null?[]:g[it][2],(g[it][1]===Ae||G.indexOf(Ae)>=0)&&(ae=g[it])}if(pe===null){const Ze=D[s.substring(0,2)];let nt=B[s.substring(0,1)];s.substring(0,2)==="da"&&(nt=["dekao",10,"da"]),Ze?(_e=Ze[2],ke=s.substring(2)):nt&&(_e=nt[1],ke=s.substring(nt[2].length));for(let it=0;it<g.length;it++)G=g[it][2]===null?[]:g[it][2],(g[it][1]===ke||G.indexOf(ke)>=0)&&(pe=g[it])}return ae===null||pe===null||ae[3]!==pe[3]?A:e*ae[6]*Ve/(pe[6]*_e)},j.CORREL=function(e,o){return le(e=Ne(U(e)),o=Ne(U(o)))?l:h.corrcoeff(e,o)},j.COS=function(e){return(e=W(e))instanceof Error?e:Math.cos(e)},j.COSH=function(e){return(e=W(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},j.COT=function(e){return(e=W(e))instanceof Error?e:e===0?m:1/Math.tan(e)},j.COTH=function(e){if((e=W(e))instanceof Error)return e;if(e===0)return m;const o=Math.exp(2*e);return(o+1)/(o-1)},j.COUNT=k,j.COUNTA=N,j.COUNTBLANK=Y,j.COUNTIF=function(e,o){if(e=U(e),o===void 0||o==="*")return e.length;let s=0;const g=mt(o+"");for(let D=0;D<e.length;D++){const B=[pt(e[D],at)].concat(g);vt(B)&&s++}return s},j.COUNTIFS=function(){const e=_(arguments),o=new Array(U(e[0]).length);for(let g=0;g<o.length;g++)o[g]=!0;for(let g=0;g<e.length;g+=2){const D=U(e[g]),B=e[g+1];if(B!==void 0&&B!=="*"){const G=mt(B+"");for(let ae=0;ae<D.length;ae++){const pe=[pt(D[ae],at)].concat(G);o[ae]=o[ae]&&vt(pe)}}}let s=0;for(let g=0;g<o.length;g++)o[g]&&s++;return s},j.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},j.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},j.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},j.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},j.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},j.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},j.COVAR=Dn,j.COVARIANCE=J,j.COVARIANCEP=Tn,j.COVARIANCES=Sn,j.CRITBINOM=On,j.CSC=function(e){return(e=W(e))instanceof Error?e:e===0?m:1/Math.sin(e)},j.CSCH=function(e){return(e=W(e))instanceof Error?e:e===0?m:2/(Math.exp(e)-Math.exp(-e))},j.CUMIPMT=function(e,o,s,g,D,B){if(le(e=W(e),o=W(o),s=W(s)))return l;if(e<=0||o<=0||s<=0||g<1||D<1||g>D||B!==0&&B!==1)return b;const G=kt(e,o,s,0,B);let ae=0;g===1&&(B===0&&(ae=-s),g++);for(let pe=g;pe<=D;pe++)ae+=B===1?Nt(e,pe-2,G,s,1)-G:Nt(e,pe-1,G,s,0);return ae*=e,ae},j.CUMPRINC=function(e,o,s,g,D,B){if(le(e=W(e),o=W(o),s=W(s)))return l;if(e<=0||o<=0||s<=0||g<1||D<1||g>D||B!==0&&B!==1)return b;const G=kt(e,o,s,0,B);let ae=0;g===1&&(ae=B===0?G+s*e:G,g++);for(let pe=g;pe<=D;pe++)ae+=B>0?G-(Nt(e,pe-2,G,s,1)-G)*e:G-Nt(e,pe-1,G,s,0)*e;return ae},j.DATE=function(e,o,s){let g;return le(e=W(e),o=W(o),s=W(s))?g=l:(g=new Date(e,o-1,s),g.getFullYear()<0&&(g=b)),g},j.DATEDIF=Ot,j.DATEVALUE=function(e){if(typeof e!="string")return l;const o=Date.parse(e);return isNaN(o)?l:new Date(e)},j.DAVERAGE=function(e,o,s){if(isNaN(o)&&typeof o!="string")return l;const g=wt(e,s);let D=[];if(typeof o=="string"){const G=Me(e,o);D=ce(e[G])}else D=ce(e[o]);let B=0;return I(g,G=>{B+=D[G]}),g.length===0?m:B/g.length},j.DAY=function(e){const o=Be(e);return o instanceof Error?o:o.getDate()},j.DAYS=Mt,j.DAYS360=Et,j.DB=function(e,o,s,g,D){if(D=D===void 0?12:D,le(e=W(e),o=W(o),s=W(s),g=W(g),D=W(D)))return l;if(e<0||o<0||s<0||g<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(D)===-1||g>s)return b;if(o>=e)return 0;const B=(1-Math.pow(o/e,1/s)).toFixed(3),G=e*B*D/12;let ae=G,pe=0;const Ae=g===s?s-1:g;for(let ke=2;ke<=Ae;ke++)pe=(e-ae)*B,ae+=pe;return g===1?G:g===s?(e-ae)*B:pe},j.DBCS=function(){throw new Error("DBCS is not implemented")},j.DCOUNT=function(e,o,s){if(isNaN(o)&&typeof o!="string")return l;const g=wt(e,s);let D=[];if(typeof o=="string"){const G=Me(e,o);D=ce(e[G])}else D=ce(e[o]);const B=[];return I(g,G=>{B.push(D[G])}),k(B)},j.DCOUNTA=function(e,o,s){if(isNaN(o)&&typeof o!="string")return l;const g=wt(e,s);let D=[];if(typeof o=="string"){const G=Me(e,o);D=ce(e[G])}else D=ce(e[o]);const B=[];return I(g,G=>{B.push(D[G])}),N(B)},j.DDB=function(e,o,s,g,D){if(D=D===void 0?2:D,le(e=W(e),o=W(o),s=W(s),g=W(g),D=W(D)))return l;if(e<0||o<0||s<0||g<0||D<=0||g>s)return b;if(o>=e)return 0;let B=0,G=0;for(let ae=1;ae<=g;ae++)G=Math.min(D/s*(e-B),e-o-B),B+=G;return G},j.DEC2BIN=function(e,o){if((e=W(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return b;if(e<0)return"1"+yt("0",9-(512+e).toString(2).length)+(512+e).toString(2);const s=parseInt(e,10).toString(2);return o===void 0?s:isNaN(o)?l:o<0?b:(o=Math.floor(o))>=s.length?yt("0",o-s.length)+s:b},j.DEC2HEX=function(e,o){if((e=W(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return b;if(e<0)return(1099511627776+e).toString(16);const s=parseInt(e,10).toString(16);return o===void 0?s:isNaN(o)?l:o<0?b:(o=Math.floor(o))>=s.length?yt("0",o-s.length)+s:b},j.DEC2OCT=function(e,o){if((e=W(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return b;if(e<0)return(1073741824+e).toString(8);const s=parseInt(e,10).toString(8);return o===void 0?s:isNaN(o)?l:o<0?b:(o=Math.floor(o))>=s.length?yt("0",o-s.length)+s:b},j.DECIMAL=function(e,o){return arguments.length<1?l:xe(e=W(e),o=W(o))||(o===0?b:parseInt(e,o))},j.DEGREES=function(e){return(e=W(e))instanceof Error?e:180*e/Math.PI},j.DELTA=function(e,o){return o=o===void 0?0:o,le(e=W(e),o=W(o))?l:e===o?1:0},j.DEVSQ=function(){const e=Ne(U(arguments));if(e instanceof Error)return e;const o=h.mean(e);let s=0;for(let g=0;g<e.length;g++)s+=Math.pow(e[g]-o,2);return s},j.DGET=function(e,o,s){if(isNaN(o)&&typeof o!="string")return l;const g=wt(e,s);let D=[];return D=ce(typeof o=="string"?e[Me(e,o)]:e[o]),g.length===0?l:g.length>1?b:D[g[0]]},j.DISC=function(e,o,s,g,D){if(le(e=Be(e),o=Be(o),s=W(s),g=W(g),D=(D=W(D))||0))return l;if(s<=0||g<=0)return b;if(e>=o)return l;let B,G;switch(D){case 0:B=360,G=Et(e,o,!1);break;case 1:case 3:B=365,G=Ot(e,o,"D");break;case 2:B=360,G=Ot(e,o,"D");break;case 4:B=360,G=Et(e,o,!0);break;default:return b}return(g-s)/g*B/G},j.DMAX=function(e,o,s){if(isNaN(o)&&typeof o!="string")return l;const g=wt(e,s);let D=[];if(typeof o=="string"){const G=Me(e,o);D=ce(e[G])}else D=ce(e[o]);let B=D[g[0]];return I(g,G=>{B<D[G]&&(B=D[G])}),B},j.DMIN=function(e,o,s){if(isNaN(o)&&typeof o!="string")return l;const g=wt(e,s);let D=[];if(typeof o=="string"){const G=Me(e,o);D=ce(e[G])}else D=ce(e[o]);let B=D[g[0]];return I(g,G=>{B>D[G]&&(B=D[G])}),B},j.DOLLAR=function(e,o=2){if(e=W(e),isNaN(e))return l;const s={style:"currency",currency:"USD",minimumFractionDigits:o>=0?o:0,maximumFractionDigits:o>=0?o:0},g=(e=Ct(e,o)).toLocaleString("en-US",s);return e<0?"$("+g.slice(2)+")":g},j.DOLLARDE=function(e,o){if(le(e=W(e),o=W(o)))return l;if(o<0)return b;if(o>=0&&o<1)return m;o=parseInt(o,10);let s=parseInt(e,10);s+=e%1*Math.pow(10,Math.ceil(Math.log(o)/Math.LN10))/o;const g=Math.pow(10,Math.ceil(Math.log(o)/Math.LN2)+1);return s=Math.round(s*g)/g,s},j.DOLLARFR=function(e,o){if(le(e=W(e),o=W(o)))return l;if(o<0)return b;if(o>=0&&o<1)return m;o=parseInt(o,10);let s=parseInt(e,10);return s+=e%1*Math.pow(10,-Math.ceil(Math.log(o)/Math.LN10))*o,s},j.DPRODUCT=function(e,o,s){if(isNaN(o)&&typeof o!="string")return l;const g=wt(e,s);let D=[];if(typeof o=="string"){const ae=Me(e,o);D=ce(e[ae])}else D=ce(e[o]);let B=[];I(g,ae=>{B.push(D[ae])}),B=Kt(B);let G=1;return I(B,ae=>{G*=ae}),G},j.DSTDEV=function(e,o,s){if(isNaN(o)&&typeof o!="string")return l;const g=wt(e,s);let D=[];if(typeof o=="string"){const G=Me(e,o);D=ce(e[G])}else D=ce(e[o]);let B=[];return I(g,G=>{B.push(D[G])}),B=Kt(B),Se.S(B)},j.DSTDEVP=function(e,o,s){if(isNaN(o)&&typeof o!="string")return l;const g=wt(e,s);let D=[];if(typeof o=="string"){const G=Me(e,o);D=ce(e[G])}else D=ce(e[o]);let B=[];return I(g,G=>{B.push(D[G])}),B=Kt(B),Se.P(B)},j.DSUM=function(e,o,s){if(isNaN(o)&&typeof o!="string")return l;const g=wt(e,s);let D=[];if(typeof o=="string"){const G=Me(e,o);D=ce(e[G])}else D=ce(e[o]);const B=[];return I(g,G=>{B.push(D[G])}),Lt(B)},j.DURATION=function(){throw new Error("DURATION is not implemented")},j.DVAR=function(e,o,s){if(isNaN(o)&&typeof o!="string")return l;const g=wt(e,s);let D=[];if(typeof o=="string"){const G=Me(e,o);D=ce(e[G])}else D=ce(e[o]);const B=[];return I(g,G=>{B.push(D[G])}),Ke.S(B)},j.DVARP=function(e,o,s){if(isNaN(o)&&typeof o!="string")return l;const g=wt(e,s);let D=[];if(typeof o=="string"){const G=Me(e,o);D=ce(e[G])}else D=ce(e[o]);const B=[];return I(g,G=>{B.push(D[G])}),Ke.P(B)},j.EDATE=function(e,o){return(e=Be(e))instanceof Error?e:isNaN(o)?l:(o=parseInt(o,10),e.setMonth(e.getMonth()+o),e)},j.EFFECT=function(e,o){return le(e=W(e),o=W(o))?l:e<=0||o<1?b:(o=parseInt(o,10),Math.pow(1+e/o,o)-1)},j.EOMONTH=function(e,o){return(e=Be(e))instanceof Error?e:isNaN(o)?l:(o=parseInt(o,10),new Date(e.getFullYear(),e.getMonth()+o+1,0))},j.ERF=Zt,j.ERFC=Jt,j.ERFCPRECISE=kn,j.ERFPRECISE=Fn,j.ERROR=Ft,j.EVEN=function(e){return(e=W(e))instanceof Error?e:Je(e,-2,-1)},j.EXACT=function(e,o){return arguments.length!==2?A:xe(e,o)||(e=Ue(e))===Ue(o)},j.EXP=function(e){return arguments.length<1?A:arguments.length>1?T:(e=W(e))instanceof Error?e:e=Math.exp(e)},j.EXPON=ie,j.EXPONDIST=Rn,j.F=ge,j.FACT=ht,j.FACTDOUBLE=function e(o){if((o=W(o))instanceof Error)return o;const s=Math.floor(o);return s<=0?1:s*e(s-2)},j.FALSE=function(){return!1},j.FDIST=Hn,j.FDISTRT=_n,j.FIND=function(e,o,s){if(arguments.length<2)return A;e=Ue(e),s=s===void 0?0:s;const g=(o=Ue(o)).indexOf(e,s-1);return g===-1?l:g+1},j.FINV=Bn,j.FINVRT=Pn,j.FISHER=function(e){return(e=W(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},j.FISHERINV=function(e){if((e=W(e))instanceof Error)return e;const o=Math.exp(2*e);return(o-1)/(o+1)},j.FIXED=cn,j.FLOOR=tt,j.FLOORMATH=Vn,j.FLOORPRECISE=zn,j.FORECAST=fe,j.FREQUENCY=function(e,o){if(le(e=Ne(U(e)),o=Ne(U(o))))return l;const s=e.length,g=o.length,D=[];for(let B=0;B<=g;B++){D[B]=0;for(let G=0;G<s;G++)B===0?e[G]<=o[0]&&(D[0]+=1):B<g?e[G]>o[B-1]&&e[G]<=o[B]&&(D[B]+=1):B===g&&e[G]>o[g-1]&&(D[g]+=1)}return D},j.FTEST=Yn,j.FV=Nt,j.FVSCHEDULE=function(e,o){if(le(e=W(e),o=Ne(U(o))))return l;const s=o.length;let g=e;for(let D=0;D<s;D++)g*=1+o[D];return g},j.GAMMA=he,j.GAMMADIST=Un,j.GAMMAINV=Wn,j.GAMMALN=Le,j.GAMMALNPRECISE=qn,j.GAUSS=function(e){return(e=W(e))instanceof Error?e:h.normal.cdf(e,0,1)-.5},j.GCD=function(){const e=Ne(U(arguments));if(e instanceof Error)return e;const o=e.length,s=e[0];let g=s<0?-s:s;for(let D=1;D<o;D++){const B=e[D];let G=B<0?-B:B;for(;g&&G;)g>G?g%=G:G%=g;g+=G}return g},j.GEOMEAN=function(){const e=Ne(U(arguments));return e instanceof Error?e:h.geomean(e)},j.GESTEP=function(e,o){return le(o=o||0,e=W(e))?e:e>=o?1:0},j.GROWTH=function(e,o,s,g){if((e=Ne(e))instanceof Error)return e;let D;if(o===void 0)for(o=[],D=1;D<=e.length;D++)o.push(D);if(s===void 0)for(s=[],D=1;D<=e.length;D++)s.push(D);if(le(o=Ne(o),s=Ne(s)))return l;g===void 0&&(g=!0);const B=e.length;let G,ae,pe=0,Ae=0,ke=0,Ve=0;for(D=0;D<B;D++){const Ze=o[D],nt=Math.log(e[D]);pe+=Ze,Ae+=nt,ke+=Ze*nt,Ve+=Ze*Ze}pe/=B,Ae/=B,ke/=B,Ve/=B,g?(G=(ke-pe*Ae)/(Ve-pe*pe),ae=Ae-G*pe):(G=ke/Ve,ae=0);const _e=[];for(D=0;D<s.length;D++)_e.push(Math.exp(ae+G*s[D]));return _e},j.HARMEAN=function(){const e=Ne(U(arguments));if(e instanceof Error)return e;const o=e.length;let s=0;for(let g=0;g<o;g++)s+=1/e[g];return o/s},j.HEX2BIN=function(e,o){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return b;const s=!(e.length!==10||e.substring(0,1).toLowerCase()!=="f"),g=s?parseInt(e,16)-1099511627776:parseInt(e,16);if(g<-512||g>511)return b;if(s)return"1"+yt("0",9-(512+g).toString(2).length)+(512+g).toString(2);const D=g.toString(2);return o===void 0?D:isNaN(o)?l:o<0?b:(o=Math.floor(o))>=D.length?yt("0",o-D.length)+D:b},j.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return b;const o=parseInt(e,16);return o>=549755813888?o-1099511627776:o},j.HEX2OCT=function(e,o){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return b;const s=parseInt(e,16);if(s>536870911&&s<0xffe0000000)return b;if(s>=0xffe0000000)return(s-0xffc0000000).toString(8);const g=s.toString(8);return o===void 0?g:isNaN(o)?l:o<0?b:(o=Math.floor(o))>=g.length?yt("0",o-g.length)+g:b},j.HLOOKUP=function(e,o,s,g){return E(e,ye(o),s,g)},j.HOUR=function(e){return(e=Be(e))instanceof Error?e:e.getHours()},j.HYPGEOM=Te,j.HYPGEOMDIST=Gn,j.IF=function(e,o,s){return e instanceof Error?e:((o=!(arguments.length>=2)||o)==null&&(o=0),(s=arguments.length===3&&s)==null&&(s=0),e?o:s)},j.IFERROR=function(e,o){return Dt(e)?o:e},j.IFNA=function(e,o){return e===A?o:e},j.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return A},j.IMABS=Qt,j.IMAGINARY=st,j.IMARGUMENT=$t,j.IMCONJUGATE=function(e){const o=lt(e),s=st(e);if(le(o,s))return l;let g=e.substring(e.length-1);return g=g==="i"||g==="j"?g:"i",s!==0?bt(o,-s,g):e},j.IMCOS=zt,j.IMCOSH=un,j.IMCOT=function(e){return le(lt(e),st(e))?l:It(zt(e),Yt(e))},j.IMCSC=function(e){return e===!0||e===!1?l:le(lt(e),st(e))?b:It("1",Yt(e))},j.IMCSCH=function(e){return e===!0||e===!1?l:le(lt(e),st(e))?b:It("1",dn(e))},j.IMDIV=It,j.IMEXP=function(e){const o=lt(e),s=st(e);if(le(o,s))return l;let g=e.substring(e.length-1);g=g==="i"||g==="j"?g:"i";const D=Math.exp(o);return bt(D*Math.cos(s),D*Math.sin(s),g)},j.IMLN=function(e){const o=lt(e),s=st(e);if(le(o,s))return l;let g=e.substring(e.length-1);return g=g==="i"||g==="j"?g:"i",bt(Math.log(Math.sqrt(o*o+s*s)),Math.atan(s/o),g)},j.IMLOG10=function(e){const o=lt(e),s=st(e);if(le(o,s))return l;let g=e.substring(e.length-1);return g=g==="i"||g==="j"?g:"i",bt(Math.log(Math.sqrt(o*o+s*s))/Math.log(10),Math.atan(s/o)/Math.log(10),g)},j.IMLOG2=function(e){const o=lt(e),s=st(e);if(le(o,s))return l;let g=e.substring(e.length-1);return g=g==="i"||g==="j"?g:"i",bt(Math.log(Math.sqrt(o*o+s*s))/Math.log(2),Math.atan(s/o)/Math.log(2),g)},j.IMPOWER=function(e,o){if(le(o=W(o),lt(e),st(e)))return l;let s=e.substring(e.length-1);s=s==="i"||s==="j"?s:"i";const g=Math.pow(Qt(e),o),D=$t(e);return bt(g*Math.cos(o*D),g*Math.sin(o*D),s)},j.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return l;for(let o=1;o<arguments.length;o++){const s=lt(e),g=st(e),D=lt(arguments[o]),B=st(arguments[o]);if(le(s,g,D,B))return l;e=bt(s*D-g*B,s*B+g*D)}return e},j.IMREAL=lt,j.IMSEC=function(e){return e===!0||e===!1||le(lt(e),st(e))?l:It("1",zt(e))},j.IMSECH=function(e){return le(lt(e),st(e))?l:It("1",un(e))},j.IMSIN=Yt,j.IMSINH=dn,j.IMSQRT=function(e){if(le(lt(e),st(e)))return l;let o=e.substring(e.length-1);o=o==="i"||o==="j"?o:"i";const s=Math.sqrt(Qt(e)),g=$t(e);return bt(s*Math.cos(g/2),s*Math.sin(g/2),o)},j.IMSUB=function(e,o){const s=lt(e),g=st(e),D=lt(o),B=st(o);if(le(s,g,D,B))return l;const G=e.substring(e.length-1),ae=o.substring(o.length-1);let pe="i";return(G==="j"||ae==="j")&&(pe="j"),bt(s-D,g-B,pe)},j.IMSUM=function(){if(!arguments.length)return l;const e=U(arguments);let o=e[0];for(let s=1;s<e.length;s++){const g=lt(o),D=st(o),B=lt(e[s]),G=st(e[s]);if(le(g,D,B,G))return l;o=bt(g+B,D+G)}return o},j.IMTAN=function(e){return e===!0||e===!1||le(lt(e),st(e))?l:It(Yt(e),zt(e))},j.INDEX=function(e,o,s){const g=xe(e,o,s);if(g)return g;if(!Array.isArray(e))return l;const D=e.length>0&&!Array.isArray(e[0]);return D&&!s?(s=o,o=1):(s=s||1,o=o||1),s<0||o<0?l:D&&o===1&&s<=e.length?e[s-1]:o<=e.length&&s<=e[o-1].length?e[o-1][s-1]:v},j.INFO=function(){throw new Error("INFO is not implemented")},j.INT=function(e){return(e=W(e))instanceof Error?e:Math.floor(e)},j.INTERCEPT=function(e,o){return le(e=Ne(e),o=Ne(o))?l:e.length!==o.length?A:fe(0,e,o)},j.INTRATE=function(){throw new Error("INTRATE is not implemented")},j.IPMT=fn,j.IRR=function(e,o){if(o=o||0,le(e=Ne(U(e)),o=W(o)))return l;const s=(_e,Ze,nt)=>{const it=nt+1;let xt=_e[0];for(let ft=1;ft<_e.length;ft++)xt+=_e[ft]/Math.pow(it,(Ze[ft]-Ze[0])/365);return xt},g=(_e,Ze,nt)=>{const it=nt+1;let xt=0;for(let ft=1;ft<_e.length;ft++){const At=(Ze[ft]-Ze[0])/365;xt-=At*_e[ft]/Math.pow(it,At+1)}return xt},D=[];let B=!1,G=!1;for(let _e=0;_e<e.length;_e++)D[_e]=_e===0?0:D[_e-1]+365,e[_e]>0&&(B=!0),e[_e]<0&&(G=!0);if(!B||!G)return b;let ae,pe,Ae,ke=o=o===void 0?.1:o,Ve=!0;do Ae=s(e,D,ke),ae=ke-Ae/g(e,D,ke),pe=Math.abs(ae-ke),ke=ae,Ve=pe>1e-10&&Math.abs(Ae)>1e-10;while(Ve);return ke},j.ISBLANK=function(e){return e===null},j.ISERR=Tt,j.ISERROR=Dt,j.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},j.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},j.ISLOGICAL=Rt,j.ISNA=function(e){return e===A},j.ISNONTEXT=function(e){return typeof e!="string"},j.ISNUMBER=gt,j.ISO=ct,j.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},j.ISOWEEKNUM=on,j.ISPMT=function(e,o,s,g){return le(e=W(e),o=W(o),s=W(s),g=W(g))?l:g*e*(o/s-1)},j.ISREF=function(){throw new Error("ISREF is not implemented")},j.ISTEXT=Ut,j.KURT=function(){const e=Ne(U(arguments));if(e instanceof Error)return e;const o=h.mean(e),s=e.length;let g=0;for(let D=0;D<s;D++)g+=Math.pow(e[D]-o,4);return g/=Math.pow(h.stdev(e,!0),4),s*(s+1)/((s-1)*(s-2)*(s-3))*g-3*(s-1)*(s-1)/((s-2)*(s-3))},j.LARGE=Fe,j.LCM=function(){const e=Ne(U(arguments));if(e instanceof Error)return e;for(var o,s,g,D,B=1;(g=e.pop())!==void 0;){if(g===0)return 0;for(;g>1;){if(g%2){for(o=3,s=Math.floor(Math.sqrt(g));o<=s&&g%o;o+=2);D=o<=s?o:g}else D=2;for(g/=D,B*=D,o=e.length;o;e[--o]%D==0&&(e[o]/=D)==1&&e.splice(o,1));}}return B},j.LEFT=function(e,o){return xe(e,o)||(e=Ue(e),(o=W(o=o===void 0?1:o))instanceof Error||typeof e!="string"?l:e.substring(0,o))},j.LEN=function(e){return arguments.length===0?T:e instanceof Error?e:Array.isArray(e)?l:Ue(e).length},j.LINEST=Ge,j.LN=function(e){return(e=W(e))instanceof Error?e:e===0?b:Math.log(e)},j.LOG=function(e,o){return xe(e=W(e),o=W(o))||(e===0||o===0?b:Math.log(e)/Math.log(o))},j.LOG10=function(e){return(e=W(e))instanceof Error?e:e===0?b:Math.log(e)/Math.log(10)},j.LOGEST=function(e,o){if(le(e=Ne(U(e)),o=Ne(U(o)))||e.length!==o.length)return l;for(let g=0;g<e.length;g++)e[g]=Math.log(e[g]);const s=Ge(e,o);return s[0]=Math.round(1e6*Math.exp(s[0]))/1e6,s[1]=Math.round(1e6*Math.exp(s[1]))/1e6,s},j.LOGINV=Xn,j.LOGNORM=Xe,j.LOGNORMDIST=Zn,j.LOGNORMINV=Jn,j.LOOKUP=function(e,o,s){o=U(o),s=s?U(s):o;const g=typeof e=="number";let D=A;for(let B=0;B<o.length;B++){if(o[B]===e)return s[B];if(g&&o[B]<=e||typeof o[B]=="string"&&o[B].localeCompare(e)<0)D=s[B];else if(g&&o[B]>e)return D}return D},j.LOWER=function(e){return arguments.length!==1?l:le(e=Ue(e))?e:e.toLowerCase()},j.MATCH=function(e,o,s){if(!e||!o||(arguments.length===2&&(s=1),!((o=U(o))instanceof Array))||s!==-1&&s!==0&&s!==1)return A;let g,D;for(let B=0;B<o.length;B++)if(s===1){if(o[B]===e)return B+1;o[B]<e&&(D?o[B]>D&&(g=B+1,D=o[B]):(g=B+1,D=o[B]))}else if(s===0){if(typeof e=="string"&&typeof o[B]=="string"){const G=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+G+"$").test(o[B].toLowerCase()))return B+1}else if(o[B]===e)return B+1}else if(s===-1){if(o[B]===e)return B+1;o[B]>e&&(D?o[B]<D&&(g=B+1,D=o[B]):(g=B+1,D=o[B]))}return g||A},j.MAX=te,j.MAXA=function(){const e=U(arguments),o=xe.apply(void 0,e);if(o)return o;let s=H(e);return s=s.map(g=>g??0),s.length===0?0:Math.max.apply(Math,s)},j.MDURATION=function(){throw new Error("MDURATION is not implemented")},j.MEDIAN=me,j.MID=function(e,o,s){if(o==null)return l;if(le(o=W(o),s=W(s))||typeof e!="string")return s;const g=o-1,D=g+s;return e.substring(g,D)},j.MIN=Ee,j.MINA=function(){const e=U(arguments),o=xe.apply(void 0,e);if(o)return o;let s=H(e);return s=s.map(g=>g??0),s.length===0?0:Math.min.apply(Math,s)},j.MINUTE=function(e){return(e=Be(e))instanceof Error?e:e.getMinutes()},j.MIRR=function(e,o,s){if(le(e=Ne(U(e)),o=W(o),s=W(s)))return l;const g=e.length,D=[],B=[];for(let pe=0;pe<g;pe++)e[pe]<0?D.push(e[pe]):B.push(e[pe]);const G=-nn(s,B)*Math.pow(1+s,g-1),ae=nn(o,D)*(1+o);return Math.pow(G/ae,1/(g-1))-1},j.MMULT=function(e,o){return!Array.isArray(e)||!Array.isArray(o)||e.some(s=>!s.length)||o.some(s=>!s.length)||ue(e).some(s=>typeof s!="number")||ue(o).some(s=>typeof s!="number")||e[0].length!==o.length?l:Array(e.length).fill(0).map(()=>Array(o[0].length).fill(0)).map((s,g)=>s.map((D,B)=>e[g].reduce((G,ae,pe)=>G+ae*o[pe][B],0)))},j.MOD=function(e,o){const s=xe(e=W(e),o=W(o));if(s)return s;if(o===0)return m;let g=Math.abs(e%o);return g=e<0?o-g:g,o>0?g:-g},j.MODE=q,j.MODEMULT=Qn,j.MODESNGL=$n,j.MONTH=function(e){return(e=Be(e))instanceof Error?e:e.getMonth()+1},j.MROUND=function(e,o){return xe(e=W(e),o=W(o))||(e*o==0?0:e*o<0?b:Math.round(e/o)*o)},j.MULTINOMIAL=function(){const e=Ne(U(arguments));if(e instanceof Error)return e;let o=0,s=1;for(let g=0;g<e.length;g++)o+=e[g],s*=ht(e[g]);return ht(o)/s},j.MUNIT=function(e){return arguments.length>1?A:!(e=parseInt(e))||e<=0?l:Array(e).fill(0).map(()=>Array(e).fill(0)).map((o,s)=>(o[s]=1,o))},j.N=function(e){return gt(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:Dt(e)?e:0},j.NA=function(){return A},j.NEGBINOM=Q,j.NEGBINOMDIST=Kn,j.NETWORKDAYS=Bt,j.NETWORKDAYSINTL=eo,j.NOMINAL=function(e,o){return le(e=W(e),o=W(o))?l:e<=0||o<1?b:(o=parseInt(o,10),(Math.pow(e+1,1/o)-1)*o)},j.NORM=C,j.NORMDIST=to,j.NORMINV=no,j.NORMSDIST=oo,j.NORMSINV=ro,j.NOT=function(e){return typeof e=="string"?l:e instanceof Error?e:!e},j.NOW=function(){return new Date},j.NPER=function(e,o,s,g,D){if(D=D===void 0?0:D,g=g===void 0?0:g,le(e=W(e),o=W(o),s=W(s),g=W(g),D=W(D)))return l;if(e===0)return-(s+g)/o;{const B=o*(1+e*D)-g*e,G=s*e+o*(1+e*D);return Math.log(B/G)/Math.log(1+e)}},j.NPV=nn,j.NUMBERVALUE=function(e,o,s){return typeof(e=ot(e)?e:"")=="number"?e:typeof e!="string"?A:(o=o===void 0?".":o,s=s===void 0?",":s,Number(e.replace(o,".").replace(s,"")))},j.OCT2BIN=function(e,o){if(!/^[0-7]{1,10}$/.test(e))return b;const s=!(e.length!==10||e.substring(0,1)!=="7"),g=s?parseInt(e,8)-1073741824:parseInt(e,8);if(g<-512||g>511)return b;if(s)return"1"+yt("0",9-(512+g).toString(2).length)+(512+g).toString(2);const D=g.toString(2);return o===void 0?D:isNaN(o)?l:o<0?b:(o=Math.floor(o))>=D.length?yt("0",o-D.length)+D:b},j.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return b;const o=parseInt(e,8);return o>=536870912?o-1073741824:o},j.OCT2HEX=function(e,o){if(!/^[0-7]{1,10}$/.test(e))return b;const s=parseInt(e,8);if(s>=536870912)return"ff"+(s+3221225472).toString(16);const g=s.toString(16);return o===void 0?g:isNaN(o)?l:o<0?b:(o=Math.floor(o))>=g.length?yt("0",o-g.length)+g:b},j.ODD=function(e){if((e=W(e))instanceof Error)return e;let o=Math.ceil(Math.abs(e));return o=1&o?o:o+1,e>=0?o:-o},j.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},j.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},j.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},j.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},j.OR=function(){const e=U(arguments);let o=l;for(let s=0;s<e.length;s++){if(e[s]instanceof Error)return e[s];e[s]!==void 0&&e[s]!==null&&typeof e[s]!="string"&&(o===l&&(o=!1),e[s]&&(o=!0))}return o},j.PDURATION=function(e,o,s){return le(e=W(e),o=W(o),s=W(s))?l:e<=0?b:(Math.log(s)-Math.log(o))/Math.log(1+e)},j.PEARSON=O,j.PERCENTILE=Z,j.PERCENTILEEXC=io,j.PERCENTILEINC=ao,j.PERCENTRANK=se,j.PERCENTRANKEXC=so,j.PERCENTRANKINC=lo,j.PERMUT=function(e,o){return le(e=W(e),o=W(o))?l:ht(e)/ht(e-o)},j.PERMUTATIONA=function(e,o){return le(e=W(e),o=W(o))?l:Math.pow(e,o)},j.PHI=function(e){return(e=W(e))instanceof Error?l:Math.exp(-.5*e*e)/2.5066282746310002},j.PI=function(){return Math.PI},j.PMT=kt,j.POISSON=ee,j.POISSONDIST=co,j.POWER=$e,j.PPMT=function(e,o,s,g,D,B){return D=D||0,B=B||0,le(e=W(e),s=W(s),g=W(g),D=W(D),B=W(B))?l:kt(e,s,g,D,B)-fn(e,o,s,g,D,B)},j.PRICE=function(){throw new Error("PRICE is not implemented")},j.PRICEDISC=function(e,o,s,g,D){if(le(e=Be(e),o=Be(o),s=W(s),g=W(g),D=(D=W(D))||0))return l;if(s<=0||g<=0)return b;if(e>=o)return l;let B,G;switch(D){case 0:B=360,G=Et(e,o,!1);break;case 1:case 3:B=365,G=Ot(e,o,"D");break;case 2:B=360,G=Ot(e,o,"D");break;case 4:B=360,G=Et(e,o,!0);break;default:return b}return g-s*g*G/B},j.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},j.PROB=function(e,o,s,g){if(s===void 0)return 0;if(g=g===void 0?s:g,le(e=Ne(U(e)),o=Ne(U(o)),s=W(s),g=W(g)))return l;if(s===g)return e.indexOf(s)>=0?o[e.indexOf(s)]:0;const D=e.sort((ae,pe)=>ae-pe),B=D.length;let G=0;for(let ae=0;ae<B;ae++)D[ae]>=s&&D[ae]<=g&&(G+=o[e.indexOf(D[ae])]);return G},j.PRODUCT=Wt,j.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},j.PROPER=function(e){return le(e)?e:isNaN(e)&&typeof e=="number"?l:(e=Ue(e)).replace(/\w\S*/g,o=>o.charAt(0).toUpperCase()+o.substr(1).toLowerCase())},j.PV=function(e,o,s,g,D){return g=g||0,D=D||0,le(e=W(e),o=W(o),s=W(s),g=W(g),D=W(D))?l:e===0?-s*o-g:((1-Math.pow(1+e,o))/e*s*(1+e*D)-g)/Math.pow(1+e,o)},j.QUARTILE=de,j.QUARTILEEXC=uo,j.QUARTILEINC=fo,j.QUOTIENT=function(e,o){return xe(e=W(e),o=W(o))||parseInt(e/o,10)},j.RADIANS=function(e){return(e=W(e))instanceof Error?e:e*Math.PI/180},j.RAND=function(){return Math.random()},j.RANDBETWEEN=function(e,o){return xe(e=W(e),o=W(o))||e+Math.ceil((o-e+1)*Math.random())-1},j.RANK=be,j.RANKAVG=po,j.RANKEQ=ho,j.RATE=function(e,o,s,g,D,B){if(B=B===void 0?.01:B,g=g===void 0?0:g,D=D===void 0?0:D,le(e=W(e),o=W(o),s=W(s),g=W(g),D=W(D),B=W(B)))return l;const G=1e-10;let ae=B;D=D?1:0;for(let pe=0;pe<20;pe++){if(ae<=-1)return b;let Ae,ke,Ve;if(Math.abs(ae)<G?Ae=s*(1+e*ae)+o*(1+ae*D)*e+g:(ke=Math.pow(1+ae,e),Ae=s*ke+o*(1/ae+D)*(ke-1)+g),Math.abs(Ae)<G)return ae;if(Math.abs(ae)<G)Ve=s*e+o*D*e;else{ke=Math.pow(1+ae,e);const _e=e*Math.pow(1+ae,e-1);Ve=s*_e+o*(1/ae+D)*_e+o*(-1/(ae*ae))*(ke-1)}ae-=Ae/Ve}return ae},j.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},j.REPLACE=function(e,o,s,g){return le(o=W(o),s=W(s))||typeof e!="string"||typeof g!="string"?l:e.substr(0,o-1)+g+e.substr(o-1+s)},j.REPT=yt,j.RIGHT=function(e,o){return xe(e,o)||(e=Ue(e),(o=W(o=o===void 0?1:o))instanceof Error?o:e.substring(e.length-o))},j.ROMAN=function(e){if((e=W(e))instanceof Error)return e;const o=String(e).split(""),s=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let g="",D=3;for(;D--;)g=(s[+o.pop()+10*D]||"")+g;return new Array(+o.join("")+1).join("M")+g},j.ROUND=Ct,j.ROUNDDOWN=function(e,o){return xe(e=W(e),o=W(o))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,o))/Math.pow(10,o)},j.ROUNDUP=function(e,o){return xe(e=W(e),o=W(o))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,o))/Math.pow(10,o)},j.ROW=function(e,o){return arguments.length!==2?A:o<0?b:e instanceof Array&&typeof o=="number"?e.length!==0?h.row(e,o):void 0:l},j.ROWS=function(e){return arguments.length!==1?A:e instanceof Array?e.length===0?0:h.rows(e):l},j.RRI=function(e,o,s){return le(e=W(e),o=W(o),s=W(s))?l:e===0||o===0?b:Math.pow(s/o,1/e)-1},j.RSQ=function(e,o){return le(e=Ne(U(e)),o=Ne(U(o)))?l:Math.pow(O(e,o),2)},j.SEARCH=function(e,o,s){let g;return typeof e!="string"||typeof o!="string"?l:(s=s===void 0?0:s,g=o.toLowerCase().indexOf(e.toLowerCase(),s-1)+1,g===0?l:g)},j.SEC=function(e){return(e=W(e))instanceof Error?e:1/Math.cos(e)},j.SECH=function(e){return(e=W(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},j.SECOND=function(e){return(e=Be(e))instanceof Error?e:e.getSeconds()},j.SERIESSUM=function(e,o,s,g){if(le(e=W(e),o=W(o),s=W(s),g=Ne(g)))return l;let D=g[0]*Math.pow(e,o);for(let B=1;B<g.length;B++)D+=g[B]*Math.pow(e,o+B*s);return D},j.SHEET=function(){throw new Error("SHEET is not implemented")},j.SHEETS=function(){throw new Error("SHEETS is not implemented")},j.SIGN=function(e){return(e=W(e))instanceof Error?e:e<0?-1:e===0?0:1},j.SIN=function(e){return(e=W(e))instanceof Error?e:Math.sin(e)},j.SINH=function(e){return(e=W(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},j.SKEW=Oe,j.SKEWP=go,j.SLN=function(e,o,s){return le(e=W(e),o=W(o),s=W(s))?l:s===0?b:(e-o)/s},j.SLOPE=function(e,o){if(le(e=Ne(U(e)),o=Ne(U(o))))return l;const s=h.mean(o),g=h.mean(e),D=o.length;let B=0,G=0;for(let ae=0;ae<D;ae++)B+=(o[ae]-s)*(e[ae]-g),G+=Math.pow(o[ae]-s,2);return B/G},j.SMALL=we,j.SORT=function(e,o=1,s=1,g=!1){if(!e||!Array.isArray(e))return A;if(e.length===0)return 0;if(!(o=W(o))||o<1||(s=W(s))!==1&&s!==-1)return l;if(typeof(g=Ye(g))!="boolean")return w;const D=ae=>ae.sort((pe,Ae)=>(pe=Ue(pe[o-1]),Ae=Ue(Ae[o-1]),s===1?pe<Ae?-1*s:s:pe>Ae?s:-1*s)),B=K(e),G=g?ye(B):B;return o>=1&&o<=G[0].length?g?ye(D(G)):D(G):l},j.SQRT=function(e){return(e=W(e))instanceof Error?e:e<0?b:Math.sqrt(e)},j.SQRTPI=function(e){return(e=W(e))instanceof Error?e:Math.sqrt(e*Math.PI)},j.STANDARDIZE=function(e,o,s){return le(e=W(e),o=W(o),s=W(s))?l:(e-o)/s},j.STDEV=Se,j.STDEVA=function(){const e=re.apply(this,arguments);return Math.sqrt(e)},j.STDEVP=bo,j.STDEVPA=function(){const e=ve.apply(this,arguments);let o=Math.sqrt(e);return isNaN(o)&&(o=b),o},j.STDEVS=mo,j.STEYX=function(e,o){if(le(e=Ne(U(e)),o=Ne(U(o))))return l;const s=h.mean(o),g=h.mean(e),D=o.length;let B=0,G=0,ae=0;for(let pe=0;pe<D;pe++)B+=Math.pow(e[pe]-g,2),G+=(o[pe]-s)*(e[pe]-g),ae+=Math.pow(o[pe]-s,2);return Math.sqrt((B-G*G/ae)/(D-2))},j.SUBSTITUTE=function(e,o,s,g){if(arguments.length<3)return A;if(e&&o){if(g===void 0)return e.split(o).join(s);{if(g=Math.floor(Number(g)),Number.isNaN(g)||g<=0)return l;let D=0,B=0;for(;D>-1&&e.indexOf(o,D)>-1;)if(D=e.indexOf(o,D+1),B++,D>-1&&B===g)return e.substring(0,D)+s+e.substring(D+o.length);return e}}return e},j.SUBTOTAL=function(e,o){if((e=W(e))instanceof Error)return e;switch(e){case 1:case 101:return M(o);case 2:case 102:return k(o);case 3:case 103:return N(o);case 4:case 104:return te(o);case 5:case 105:return Ee(o);case 6:case 106:return Wt(o);case 7:case 107:return Se.S(o);case 8:case 108:return Se.P(o);case 9:case 109:return Lt(o);case 10:case 110:return Ke.S(o);case 11:case 111:return Ke.P(o)}},j.SUM=Lt,j.SUMIF=function(e,o,s){if(e=U(e),s=s?U(s):e,e instanceof Error)return e;if(o==null||o instanceof Error)return 0;let g=0;const D=o==="*",B=D?null:mt(o+"");for(let G=0;G<e.length;G++){const ae=e[G],pe=s[G];if(D)g+=ae;else{const Ae=[pt(ae,at)].concat(B);g+=vt(Ae)?pe:0}}return g},j.SUMIFS=function(){const e=_(arguments),o=Ne(U(e.shift()));if(o instanceof Error)return o;const s=e,g=s.length/2;for(let B=0;B<g;B++)s[2*B]=U(s[2*B]);let D=0;for(let B=0;B<o.length;B++){let G=!1;for(let ae=0;ae<g;ae++){const pe=s[2*ae][B],Ae=s[2*ae+1];let ke=!1;if(Ae===void 0||Ae==="*")ke=!0;else{const Ve=mt(Ae+""),_e=[pt(pe,at)].concat(Ve);ke=vt(_e)}if(!ke){G=!1;break}G=!0}G&&(D+=o[B])}return D},j.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return l;const e=arguments.length+1;let o,s,g,D,B=0;for(let G=0;G<arguments[0].length;G++)if(arguments[0][G]instanceof Array)for(let ae=0;ae<arguments[0][G].length;ae++){for(o=1,s=1;s<e;s++){const pe=arguments[s-1][G][ae];if(pe instanceof Error)return pe;if(D=W(pe),D instanceof Error)return D;o*=D}B+=o}else{for(o=1,s=1;s<e;s++){const ae=arguments[s-1][G];if(ae instanceof Error)return ae;if(g=W(ae),g instanceof Error)return g;o*=g}B+=o}return B},j.SUMSQ=function(){const e=Ne(U(arguments));if(e instanceof Error)return e;let o=0;const s=e.length;for(let g=0;g<s;g++)o+=gt(e[g])?e[g]*e[g]:0;return o},j.SUMX2MY2=function(e,o){if(le(e=Ne(U(e)),o=Ne(U(o))))return l;let s=0;for(let g=0;g<e.length;g++)s+=e[g]*e[g]-o[g]*o[g];return s},j.SUMX2PY2=function(e,o){if(le(e=Ne(U(e)),o=Ne(U(o))))return l;let s=0;e=Ne(U(e)),o=Ne(U(o));for(let g=0;g<e.length;g++)s+=e[g]*e[g]+o[g]*o[g];return s},j.SUMXMY2=function(e,o){if(le(e=Ne(U(e)),o=Ne(U(o))))return l;let s=0;e=U(e),o=U(o);for(let g=0;g<e.length;g++)s+=Math.pow(e[g]-o[g],2);return s},j.SWITCH=function(){let e;if(arguments.length>0){const o=arguments[0],s=arguments.length-1,g=Math.floor(s/2);let D=!1;const B=s%2!=0,G=s%2==0?null:arguments[arguments.length-1];if(g){for(let ae=0;ae<g;ae++)if(o===arguments[2*ae+1]){e=arguments[2*ae+2],D=!0;break}}D||(e=B?G:A)}else e=l;return e},j.SYD=function(e,o,s,g){return le(e=W(e),o=W(o),s=W(s),g=W(g))?l:s===0||g<1||g>s?b:(e-o)*(s-(g=parseInt(g,10))+1)*2/(s*(s+1))},j.T=function(e){return e instanceof Error||typeof e=="string"?e:""},j.TAN=function(e){return(e=W(e))instanceof Error?e:Math.tan(e)},j.TANH=function(e){if((e=W(e))instanceof Error)return e;const o=Math.exp(2*e);return(o-1)/(o+1)},j.TBILLEQ=function(e,o,s){return le(e=Be(e),o=Be(o),s=W(s))?l:s<=0||e>o||o-e>31536e6?b:365*s/(360-s*Et(e,o,!1))},j.TBILLPRICE=function(e,o,s){return le(e=Be(e),o=Be(o),s=W(s))?l:s<=0||e>o||o-e>31536e6?b:100*(1-s*Et(e,o,!1)/360)},j.TBILLYIELD=function(e,o,s){return le(e=Be(e),o=Be(o),s=W(s))?l:s<=0||e>o||o-e>31536e6?b:360*(100-s)/(s*Et(e,o,!1))},j.TDIST=jo,j.TDISTRT=vo,j.TEXT=function(e,o){if(e===void 0||e instanceof Error||o instanceof Error)return A;if(o==null)return"";if(typeof o=="number")return String(o);if(typeof o!="string")return l;const s=o.startsWith("$")?"$":"",g=o.endsWith("%");return g&&(e*=100),e=(e=cn(e,(o=o.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!o.includes(","))).startsWith("-")?"-"+s+(e=e.replace("-","")):s+e,g&&(e+="%"),e},j.TEXTJOIN=function(e,o,...s){if(typeof o!="boolean"&&(o=Ye(o)),arguments.length<3)return A;e=e??"";let g=U(s),D=o?g.filter(B=>B):g;if(Array.isArray(e)){e=U(e);let B=D.map(ae=>[ae]),G=0;for(let ae=0;ae<B.length-1;ae++)B[ae].push(e[G]),G++,G===e.length&&(G=0);return D=U(B),D.join("")}return D.join(e)},j.TIME=function(e,o,s){return le(e=W(e),o=W(o),s=W(s))?l:e<0||o<0||s<0?b:(3600*e+60*o+s)/86400},j.TIMEVALUE=function(e){return(e=Be(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},j.TINV=xo,j.TODAY=function(){return _t(new Date)},j.TRANSPOSE=function(e){return e?ye(K(e)):A},j.TREND=function(e,o,s){if(le(e=Ne(U(e)),o=Ne(U(o)),s=Ne(U(s))))return l;const g=Ge(e,o),D=g[0],B=g[1],G=[];return s.forEach(ae=>{G.push(D*ae+B)}),G},j.TRIM=function(e){return(e=Ue(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},j.TRIMMEAN=function(e,o){if(le(e=Ne(U(e)),o=W(o)))return l;const s=tt(e.length*o,2)/2;return h.mean((D=(D=s)||1,(g=ce(e.sort((B,G)=>B-G),s))&&typeof g.slice=="function"?g.slice(0,g.length-D):g));var g,D},j.TRUE=function(){return!0},j.TRUNC=function(e,o){return xe(e=W(e),o=W(o))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,o))/Math.pow(10,o)},j.TTEST=yo,j.TYPE=function(e){return gt(e)?1:Ut(e)?2:Rt(e)?4:Dt(e)?16:Array.isArray(e)?64:void 0},j.UNICHAR=jn,j.UNICODE=vn,j.UNIQUE=St,j.UPPER=function(e){return(e=Ue(e))instanceof Error?e:e.toUpperCase()},j.VALUE=function(e){const o=xe(e);if(o)return o;if(typeof e=="number")return e;if(ot(e)||(e=""),typeof e!="string")return l;const s=/(%)$/.test(e)||/^(%)/.test(e);if((e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let g=Number(e);return isNaN(g)?l:(g=g||0,s&&(g*=.01),g)},j.VAR=Ke,j.VARA=re,j.VARP=wo,j.VARPA=ve,j.VARS=Co,j.VDB=function(){throw new Error("VDB is not implemented")},j.VLOOKUP=E,j.WEEKDAY=function(e,o){if((e=Be(e))instanceof Error)return e;o===void 0&&(o=1);const s=e.getDay();return bn[o][s]},j.WEEKNUM=function(e,o){if((e=Be(e))instanceof Error)return e;if(o===void 0&&(o=1),o===21)return on(e);const s=gn[o];let g=new Date(e.getFullYear(),0,1);const D=g.getDay()<s?1:0;return g-=24*Math.abs(g.getDay()-s)*60*60*1e3,Math.floor((e-g)/864e5/7+1)+D},j.WEIBULL=Ce,j.WEIBULLDIST=Eo,j.WORKDAY=Pt,j.WORKDAYINTL=Ao,j.XIRR=function(e,o,s){if(le(e=Ne(U(e)),o=dt(U(o)),s=W(s)))return l;const g=(_e,Ze,nt)=>{const it=nt+1;let xt=_e[0];for(let ft=1;ft<_e.length;ft++)xt+=_e[ft]/Math.pow(it,Mt(Ze[ft],Ze[0])/365);return xt},D=(_e,Ze,nt)=>{const it=nt+1;let xt=0;for(let ft=1;ft<_e.length;ft++){const At=Mt(Ze[ft],Ze[0])/365;xt-=At*_e[ft]/Math.pow(it,At+1)}return xt};let B=!1,G=!1;for(let _e=0;_e<e.length;_e++)e[_e]>0&&(B=!0),e[_e]<0&&(G=!0);if(!B||!G)return b;let ae,pe,Ae,ke=s=s||.1,Ve=!0;do Ae=g(e,o,ke),ae=ke-Ae/D(e,o,ke),pe=Math.abs(ae-ke),ke=ae,Ve=pe>1e-10&&Math.abs(Ae)>1e-10;while(Ve);return ke},j.XNPV=function(e,o,s){if(le(e=W(e),o=Ne(U(o)),s=dt(U(s))))return l;let g=0;for(let D=0;D<o.length;D++)g+=o[D]/Math.pow(1+e,Mt(s[D],s[0])/365);return g},j.XOR=function(){const e=U(arguments);let o=l;for(let s=0;s<e.length;s++){if(e[s]instanceof Error)return e[s];e[s]!==void 0&&e[s]!==null&&typeof e[s]!="string"&&(o===l&&(o=0),e[s]&&o++)}return o===l?o:!!(1&Math.floor(Math.abs(o)))},j.YEAR=function(e){return(e=Be(e))instanceof Error?e:e.getFullYear()},j.YEARFRAC=Gt,j.YIELD=function(){throw new Error("YIELD is not implemented")},j.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},j.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},j.Z=He,j.ZTEST=Lo,j.utils=Mo}},p={};function L(X){var j=p[X];if(j!==void 0)return j.exports;var d=p[X]={exports:{}};return f[X].call(d.exports,d,d.exports,L),d.exports}L.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var R=L(960);c=R}(),c)},138:function(module,__unused_webpack_exports,__webpack_require__){if(!formula)var formula=__webpack_require__(243);var factory;factory=function(){var Version=(info={title:"Jspreadsheet",version:"4.13.2",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}},function(){return info}),info,isFormula=function(r){var c=(""+r)[0];return c=="="||c=="#"},getMask=function(r){if(r.format||r.mask||r.locale){var c={};return r.mask?c.mask=r.mask:r.format?c.mask=r.format:(c.locale=r.locale,c.options=r.options),r.decimal&&(c.options||(c.options={}),c.options={decimal:r.decimal}),c}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if(el.tagName=="TABLE"){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text")for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==1&&obj.options.tableOverflow==0&&obj.options.fullscreen==0&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(r){r==null&&(r=!obj.options.fullscreen),obj.options.fullscreen!=r&&(obj.options.fullscreen=r,r==1?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(r){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var c=obj.options.onevent.apply(this,arguments);typeof obj.options[r]=="function"&&(c=obj.options[r].apply(this,Array.prototype.slice.call(arguments,1)))}if(r=="onafterchanges"&&obj.options.persistance){var f=obj.options.persistance==1?obj.options.url:obj.options.persistance,p=obj.prepareJson(arguments[2]);obj.save(f,p)}return c},obj.prepareTable=function(){var r=obj.options.columns.length;if(obj.options.data&&obj.options.data[0]!==void 0){var c=Object.keys(obj.options.data[0]);c.length>r&&(r=c.length)}obj.options.minDimensions[0]>r&&(r=obj.options.minDimensions[0]);for(var f=[],p=0;p<r;p++)obj.options.colHeaders[p]||(obj.options.colHeaders[p]=""),obj.options.colWidths[p]||(obj.options.colWidths[p]=obj.options.defaultColWidth),obj.options.colAlignments[p]||(obj.options.colAlignments[p]=obj.options.defaultColAlign),obj.options.columns[p]?obj.options.columns[p].type||(obj.options.columns[p].type="text"):obj.options.columns[p]={type:"text"},obj.options.columns[p].name||(obj.options.columns[p].name=c&&c[p]?c[p]:p),obj.options.columns[p].source||(obj.options.columns[p].source=[]),obj.options.columns[p].options||(obj.options.columns[p].options=[]),obj.options.columns[p].editor||(obj.options.columns[p].editor=null),obj.options.columns[p].allowEmpty||(obj.options.columns[p].allowEmpty=!1),obj.options.columns[p].title||(obj.options.columns[p].title=obj.options.colHeaders[p]?obj.options.colHeaders[p]:""),obj.options.columns[p].width||(obj.options.columns[p].width=obj.options.colWidths[p]?obj.options.colWidths[p]:obj.options.defaultColWidth),obj.options.columns[p].align||(obj.options.columns[p].align=obj.options.colAlignments[p]?obj.options.colAlignments[p]:"center"),obj.options.columns[p].type=="autocomplete"||obj.options.columns[p].type=="dropdown"?obj.options.columns[p].url&&f.push({url:obj.options.columns[p].url,index:p,method:"GET",dataType:"json",success:function(L){for(var R=0;R<L.length;R++)obj.options.columns[this.index].source.push(L[R])}}):obj.options.columns[p].type=="calendar"&&(obj.options.columns[p].options.format||(obj.options.columns[p].options.format="DD/MM/YYYY"));f.length?jSuites.ajax(f,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(b){obj.scrollControls(b)},obj.content.onwheel=function(b){obj.wheelControls(b)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var r=document.createElement("div"),c=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),r.appendChild(c),r.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var f=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var p=0;p<obj.options.paginationOptions.length;p++){var L=document.createElement("option");L.value=obj.options.paginationOptions[p],L.innerHTML=obj.options.paginationOptions[p],obj.paginationDropdown.appendChild(L)}obj.paginationDropdown.value=obj.options.pagination,f.appendChild(document.createTextNode(obj.options.text.show)),f.appendChild(obj.paginationDropdown),f.appendChild(document.createTextNode(obj.options.text.entries))}var R,X=document.createElement("div");if(X.classList.add("jexcel_filter"),X.appendChild(f),X.appendChild(r),obj.colgroupContainer=document.createElement("colgroup"),(R=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(R),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var j=0;j<obj.options.nestedHeaders.length;j++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[j]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(R=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(R),p=0;p<obj.options.columns.length;p++)obj.createCellHeader(p),obj.headerContainer.appendChild(obj.headers[p]),obj.colgroupContainer.appendChild(obj.colgroup[p]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==1){obj.filter=document.createElement("tr");var d=document.createElement("td");for(obj.filter.appendChild(d),p=0;p<obj.options.columns.length;p++)(d=document.createElement("td")).innerHTML="&nbsp;",d.setAttribute("data-x",p),d.className="jexcel_column_filter",obj.options.columns[p].type=="hidden"&&(d.style.display="none"),obj.filter.appendChild(d);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==0&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var h=document.createElement("a");h.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";try{if(typeof sessionStorage<"u"&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var F=document.createElement("img");F.src="//bossanova.uk/jspreadsheet/logo.png",h.appendChild(F)}}catch{}var V=document.createElement("span");V.innerHTML="Jspreadsheet CE",h.appendChild(V),obj.ads.appendChild(h),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var m=document.createElement("div"),l=document.createElement("div");if(obj.pagination.appendChild(m),obj.pagination.appendChild(l),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==1&&el.appendChild(X),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==1?el.classList.add("fullscreen"):obj.options.tableOverflow==1&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=1&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==1&&obj.thead.classList.add("draggable"),obj.options.columnResize==1&&obj.thead.classList.add("resizable"),obj.options.rowDrag==1&&obj.tbody.classList.add("draggable"),obj.options.rowResize==1&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var v=Object.keys(obj.options.classes);for(p=0;p<v.length;p++){var w=jexcel.getIdFromColumnName(v[p],!0);obj.records[w[1]][w[0]].classList.add(obj.options.classes[v[p]])}}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(r){obj.options.data=r.data?r.data:r,obj.setData(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(r){if(r&&(typeof r=="string"&&(r=JSON.parse(r)),obj.options.data=r),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){r=[];for(var c=0;c<obj.options.data.length;c++){for(var f=[],p=0;p<obj.options.columns.length;p++)f[p]=obj.options.data[c][obj.options.columns[p].name];r.push(f)}obj.options.data=r}c=0,p=0;var L=obj.options.columns.length,R=obj.options.data.length,X=obj.options.minDimensions[0],j=obj.options.minDimensions[1],d=X>L?X:L,h=j>R?j:R;for(c=0;c<h;c++)for(p=0;p<d;p++)obj.options.data[c]==null&&(obj.options.data[c]=[]),obj.options.data[c][p]==null&&(obj.options.data[c][p]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==1){var F=0,V=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,F=obj.options.pagination*obj.pageNumber,V=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<V&&(V=obj.options.data.length)):(F=0,V=obj.options.data.length);for(c=0;c<obj.options.data.length;c++){var m=obj.createRow(c,obj.options.data[c]);c>=F&&c<V&&obj.tbody.appendChild(m)}if(obj.options.lazyLoading==1||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var l=Object.keys(obj.options.mergeCells);for(p=0;p<l.length;p++){var v=obj.options.mergeCells[l[p]];obj.setMerge(l[p],v[0],v[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(r,c){for(var f=[],p=0,L=0,R=c==1||obj.options.copyCompatibility==0,X=obj.options.columns.length,j=obj.options.data.length,d=0;d<j;d++){p=0;for(var h=0;h<X;h++)r&&!obj.records[d][h].classList.contains("highlight")||(f[L]||(f[L]=[]),f[L][p]=R?obj.options.data[d][h]:obj.records[d][h].innerHTML,p++);p>0&&L++}return f},obj.getJsonRow=function(r){for(var c=obj.options.data[r],f=obj.options.columns.length,p={},L=0;L<f;L++)obj.options.columns[L].name||(obj.options.columns[L].name=L),p[obj.options.columns[L].name]=c[L];return p},obj.getJson=function(r){for(var c=[],f=obj.options.columns.length,p=obj.options.data.length,L=0;L<p;L++){for(var R=null,X=0;X<f;X++)r&&!obj.records[L][X].classList.contains("highlight")||(R==null&&(R={}),obj.options.columns[X].name||(obj.options.columns[X].name=X),R[obj.options.columns[X].name]=obj.options.data[L][X]);R!=null&&c.push(R)}return c},obj.prepareJson=function(r){for(var c=[],f=0;f<r.length;f++){var p=r[f].x,L=r[f].y,R=obj.options.columns[p].name?obj.options.columns[p].name:p;c[L]||(c[L]={row:L,data:{}}),c[L].data[R]=r[f].newValue}return c.filter(function(X){return X!=null})},obj.save=function(r,c){var f=obj.dispatch("onbeforesave",el,obj,c);if(f)c=f;else if(f===!1)return!1;jSuites.ajax({url:r,method:"POST",dataType:"json",data:{data:JSON.stringify(c)},success:function(p){obj.dispatch("onsave",el,obj,c)}})},obj.getRowData=function(r){return obj.options.data[r]},obj.setRowData=function(r,c){for(var f=0;f<obj.headers.length;f++){var p=jexcel.getColumnNameFromId([f,r]);c[f]!=null&&obj.setValue(p,c[f])}},obj.getColumnData=function(r){for(var c=[],f=0;f<obj.options.data.length;f++)c.push(obj.options.data[f][r]);return c},obj.setColumnData=function(r,c){for(var f=0;f<obj.rows.length;f++){var p=jexcel.getColumnNameFromId([r,f]);c[f]!=null&&obj.setValue(p,c[f])}},obj.createRow=function(r,c){obj.records[r]||(obj.records[r]=[]),c||(c=obj.options.data[r]),obj.rows[r]=document.createElement("tr"),obj.rows[r].setAttribute("data-y",r);var f=null;obj.options.defaultRowHeight&&(obj.rows[r].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[r]&&(obj.options.rows[r].height&&(obj.rows[r].style.height=obj.options.rows[r].height),obj.options.rows[r].title&&(f=obj.options.rows[r].title)),f||(f=parseInt(r+1));var p=document.createElement("td");p.innerHTML=f,p.setAttribute("data-y",r),p.className="jexcel_row",obj.rows[r].appendChild(p);for(var L=0;L<obj.options.columns.length;L++)obj.records[r][L]=obj.createCell(L,r,c[L]),obj.rows[r].appendChild(obj.records[r][L]);return obj.rows[r]},obj.parseValue=function(r,c,f,p){(""+f).substr(0,1)=="="&&obj.options.parseFormulas==1&&(f=obj.executeFormula(f,r,c));var L=obj.options.columns[r];if(L&&!isFormula(f)){var R=null;if(R=getMask(L)){f&&f==Number(f)&&(f=Number(f));var X=jSuites.mask.render(f,R,!0);if(p&&R.mask){var j=R.mask.split(";");j[1]&&(j[1].match(new RegExp("\\[Red\\]","gi"))&&(f<0?p.classList.add("red"):p.classList.remove("red")),j[1].match(new RegExp("\\(","gi"))&&f<0&&(X="("+X+")"))}X&&(f=X)}}return f};var validDate=function(r){return(r=""+r).substr(4,1)=="-"&&r.substr(7,1)=="-"||(r=r.split("-"))[0].length==4&&r[0]==Number(r[0])&&r[1].length==2&&r[1]==Number(r[1])};obj.createCell=function(r,c,f){var p=document.createElement("td");if(p.setAttribute("data-x",r),p.setAttribute("data-y",c),(""+f).substr(0,1)=="="&&obj.options.secureFormulas==1){var L=secureFormula(f);L!=f&&(f=L)}if(obj.options.columns[r].editor)obj.options.stripHTML===!1||obj.options.columns[r].stripHTML===!1?p.innerHTML=f:p.textContent=f,typeof obj.options.columns[r].editor.createCell=="function"&&(p=obj.options.columns[r].editor.createCell(p));else if(obj.options.columns[r].type=="hidden")p.style.display="none",p.textContent=f;else if(obj.options.columns[r].type=="checkbox"||obj.options.columns[r].type=="radio"){var R=document.createElement("input");R.type=obj.options.columns[r].type,R.name="c"+r,R.checked=f==1||f==1||f=="true",R.onclick=function(){obj.setValue(p,this.checked)},obj.options.columns[r].readOnly!=1&&obj.options.editable!=0||R.setAttribute("disabled","disabled"),p.appendChild(R),obj.options.data[c][r]=R.checked}else if(obj.options.columns[r].type=="calendar"){var X=null;if(!validDate(f)){var j=jSuites.calendar.extractDateFromString(f,obj.options.columns[r].options.format);j&&(X=j)}p.textContent=jSuites.calendar.getDateString(X||f,obj.options.columns[r].options.format)}else if(obj.options.columns[r].type=="dropdown"||obj.options.columns[r].type=="autocomplete")p.classList.add("jexcel_dropdown"),p.textContent=obj.getDropDownValue(r,f);else if(obj.options.columns[r].type=="color")if(obj.options.columns[r].render=="square"){var d=document.createElement("div");d.className="color",d.style.backgroundColor=f,p.appendChild(d)}else p.style.color=f,p.textContent=f;else if(obj.options.columns[r].type=="image"){if(f&&f.substr(0,10)=="data:image"){var h=document.createElement("img");h.src=f,p.appendChild(h)}}else obj.options.columns[r].type=="html"||obj.options.stripHTML===!1||obj.options.columns[r].stripHTML===!1?p.innerHTML=stripScript(obj.parseValue(r,c,f,p)):p.textContent=obj.parseValue(r,c,f,p);obj.options.columns[r].readOnly==1&&(p.className="readonly");var F=obj.options.columns[r].align?obj.options.columns[r].align:"center";return p.style.textAlign=F,obj.options.columns[r].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[r].wordWrap==1||p.innerHTML.length>200)&&(p.style.whiteSpace="pre-wrap"),r>0&&this.options.textOverflow==1&&(f||p.innerHTML?obj.records[c][r-1].style.overflow="hidden":r==obj.options.columns.length-1&&(p.style.overflow="hidden")),p},obj.createCellHeader=function(r){var c=obj.options.columns[r].width?obj.options.columns[r].width:obj.options.defaultColWidth,f=obj.options.columns[r].align?obj.options.columns[r].align:obj.options.defaultColAlign;obj.headers[r]=document.createElement("td"),obj.options.stripHTML?obj.headers[r].textContent=obj.options.columns[r].title?obj.options.columns[r].title:jexcel.getColumnName(r):obj.headers[r].innerHTML=obj.options.columns[r].title?obj.options.columns[r].title:jexcel.getColumnName(r),obj.headers[r].setAttribute("data-x",r),obj.headers[r].style.textAlign=f,obj.options.columns[r].title&&obj.headers[r].setAttribute("title",obj.headers[r].innerText),obj.options.columns[r].id&&obj.headers[r].setAttribute("id",obj.options.columns[r].id),obj.colgroup[r]=document.createElement("col"),obj.colgroup[r].setAttribute("width",c),obj.options.columns[r].type=="hidden"&&(obj.headers[r].style.display="none",obj.colgroup[r].style.display="none")},obj.updateNestedHeader=function(r,c,f){obj.options.nestedHeaders[c][r].title&&(obj.options.nestedHeaders[c][r].title=f,obj.options.nestedHeaders[c].element.children[r+1].textContent=f)},obj.createNestedHeader=function(r){var c=document.createElement("tr");c.classList.add("jexcel_nested");var f=document.createElement("td");c.appendChild(f),r.element=c;for(var p=0,L=0;L<r.length;L++){r[L].colspan||(r[L].colspan=1),r[L].align||(r[L].align="center"),r[L].title||(r[L].title=""),r[L].id||(r[L].id="");for(var R=r[L].colspan,X=[],j=0;j<R;j++)obj.options.columns[p]&&obj.options.columns[p].type=="hidden"&&R++,X.push(p),p++;(f=document.createElement("td")).setAttribute("data-column",X.join(",")),f.setAttribute("colspan",r[L].colspan),f.setAttribute("align",r[L].align),f.setAttribute("id",r[L].id),f.textContent=r[L].title,c.appendChild(f)}return c},obj.createToolbar=function(r){r?obj.options.toolbar=r:r=obj.options.toolbar;for(var c=0;c<r.length;c++)if(r[c].type=="i")(R=document.createElement("i")).classList.add("jexcel_toolbar_item"),R.classList.add("material-icons"),R.setAttribute("data-k",r[c].k),R.setAttribute("data-v",r[c].v),R.setAttribute("id",r[c].id),r[c].tooltip&&R.setAttribute("title",r[c].tooltip),r[c].onclick&&(r[c].onclick,1)?R.onclick=function(X){var j=X;return function(){r[j].onclick(el,obj,this)}}(c):R.onclick=function(){var X=this.getAttribute("data-k"),j=this.getAttribute("data-v");obj.setStyle(obj.highlighted,X,j)},R.textContent=r[c].content,obj.toolbar.appendChild(R);else if(r[c].type=="select"){var f=!1;(R=document.createElement("select")).classList.add("jexcel_toolbar_item"),R.setAttribute("data-k",r[c].k),r[c].tooltip&&R.setAttribute("title",r[c].tooltip),r[c].onchange&&(r[c].onchange,1)?(R.onchange=r[c].onchange,f=!0):R.onchange=function(){var X=this.getAttribute("data-k");obj.setStyle(obj.highlighted,X,this.value)};for(var p=0;p<r[c].v.length;p++){var L=document.createElement("option");L.value=r[c].v[p],L.textContent=r[c].v[p],r[c].selectedValue&&L.value===r[c].selectedValue&&(L.selected=!0),R.appendChild(L)}f&&R.dispatchEvent(new Event("change")),obj.toolbar.appendChild(R)}else if(r[c].type=="color"){var R;(R=document.createElement("i")).classList.add("jexcel_toolbar_item"),R.classList.add("material-icons"),R.setAttribute("data-k",r[c].k),R.setAttribute("data-v",""),r[c].tooltip&&R.setAttribute("title",r[c].tooltip),obj.toolbar.appendChild(R),R.textContent=r[c].content,jSuites.color(R,{onchange:function(X,j){var d=X.getAttribute("data-k");obj.setStyle(obj.highlighted,d,j)}})}},obj.setMerge=function(r,c,f,p){var L=!1;if(!r){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var R=parseInt(obj.highlighted[0].getAttribute("data-x")),X=parseInt(obj.highlighted[0].getAttribute("data-y")),j=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),d=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));r=jexcel.getColumnNameFromId([R,X]),c=j-R+1,f=d-X+1}var h=jexcel.getIdFromColumnName(r,!0);if(obj.options.mergeCells[r])obj.records[h[1]][h[0]].getAttribute("data-merged")&&(L=obj.options.text.cellAlreadyMerged);else if((!c||c<2)&&(!f||f<2))L=obj.options.text.invalidMergeProperties;else for(var F=h[1];F<h[1]+f;F++)for(var V=h[0];V<h[0]+c;V++)jexcel.getColumnNameFromId([V,F]),obj.records[F][V].getAttribute("data-merged")&&(L=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(L)alert(L);else{c>1?obj.records[h[1]][h[0]].setAttribute("colspan",c):c=1,f>1?obj.records[h[1]][h[0]].setAttribute("rowspan",f):f=1,obj.options.mergeCells[r]=[c,f,[]],obj.records[h[1]][h[0]].setAttribute("data-merged","true"),obj.records[h[1]][h[0]].style.overflow="hidden";for(var m=[],l=h[1];l<h[1]+f;l++)for(var v=h[0];v<h[0]+c;v++)h[0]==v&&h[1]==l||(m.push(obj.options.data[l][v]),obj.updateCell(v,l,"",!0),obj.options.mergeCells[r][2].push(obj.records[l][v]),obj.records[l][v].style.display="none",obj.records[l][v]=obj.records[h[1]][h[0]]);obj.updateSelection(obj.records[h[1]][h[0]]),p||(obj.setHistory({action:"setMerge",column:r,colspan:c,rowspan:f,data:m}),obj.dispatch("onmerge",el,r,c,f))}},obj.getMerge=function(r){var c={};if(r)c=obj.options.mergeCells[r]?[obj.options.mergeCells[r][0],obj.options.mergeCells[r][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var f=Object.keys(obj.options.mergeCells),p=0;p<f.length;p++)c[f[p]]=[obj.options.mergeCells[f[p]][0],obj.options.mergeCells[f[p]][1]]}return c},obj.removeMerge=function(r,c,f){if(obj.options.mergeCells[r]){var p=jexcel.getIdFromColumnName(r,!0);obj.records[p[1]][p[0]].removeAttribute("colspan"),obj.records[p[1]][p[0]].removeAttribute("rowspan"),obj.records[p[1]][p[0]].removeAttribute("data-merged");for(var L=obj.options.mergeCells[r],R=0,X=0;X<L[1];X++)for(var j=0;j<L[0];j++)(X>0||j>0)&&(obj.records[p[1]+X][p[0]+j]=L[2][R],obj.records[p[1]+X][p[0]+j].style.display="",c&&c[R]&&obj.updateCell(p[0]+j,p[1]+X,c[R]),R++);obj.updateSelection(obj.records[p[1]][p[0]],obj.records[p[1]+X-1][p[0]+j-1]),f||delete obj.options.mergeCells[r]}},obj.destroyMerged=function(r){if(obj.options.mergeCells){obj.options.mergeCells;for(var c=Object.keys(obj.options.mergeCells),f=0;f<c.length;f++)obj.removeMerge(c[f],null,r)}},obj.isColMerged=function(r,c){var f=[];if(obj.options.mergeCells)for(var p=Object.keys(obj.options.mergeCells),L=0;L<p.length;L++){var R=jexcel.getIdFromColumnName(p[L],!0),X=obj.options.mergeCells[p[L]][0],j=R[0],d=R[0]+(X>1?X-1:0);c==null?j<=r&&d>=r&&f.push(p[L]):c?j<r&&d>=r&&f.push(p[L]):j<=r&&d>r&&f.push(p[L])}return f},obj.isRowMerged=function(r,c){var f=[];if(obj.options.mergeCells)for(var p=Object.keys(obj.options.mergeCells),L=0;L<p.length;L++){var R=jexcel.getIdFromColumnName(p[L],!0),X=obj.options.mergeCells[p[L]][1],j=R[1],d=R[1]+(X>1?X-1:0);c==null?j<=r&&d>=r&&f.push(p[L]):c?j<r&&d>=r&&f.push(p[L]):j<=r&&d>r&&f.push(p[L])}return f},obj.openFilter=function(r){if(obj.options.filters){r=parseInt(r),obj.resetSelection();var c=[];if(obj.options.columns[r].type=="checkbox")c.push({id:"true",name:"True"}),c.push({id:"false",name:"False"});else{for(var f=[],p=!1,L=0;L<obj.options.data.length;L++){var R=obj.options.data[L][r],X=obj.records[L][r].innerHTML;R&&X?f[R]=X:p=!0}var j=Object.keys(f);for(c=[],L=0;L<j.length;L++)c.push({id:j[L],name:f[j[L]]});p&&c.push({value:"",id:"",name:"(Blanks)"})}var d=document.createElement("div");obj.filter.children[r+1].innerHTML="",obj.filter.children[r+1].appendChild(d),obj.filter.children[r+1].style.paddingLeft="0px",obj.filter.children[r+1].style.paddingRight="0px",obj.filter.children[r+1].style.overflow="initial";var h={data:c,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[r]!==void 0?obj.filters[r]:null,width:"100%",position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(F){obj.resetFilters(),obj.filters[r]=F.dropdown.getValue(!0),obj.filter.children[r+1].innerHTML=F.dropdown.getText(),obj.filter.children[r+1].style.paddingLeft="",obj.filter.children[r+1].style.paddingRight="",obj.filter.children[r+1].style.overflow="",obj.closeFilter(r),obj.refreshSelection()}};jSuites.dropdown(d,h)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var r=0;r<obj.filter.children.length;r++)obj.filter.children[r].innerHTML="&nbsp;",obj.filters[r]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(r){if(!r)for(var c=0;c<obj.filter.children.length;c++)obj.filters[c]&&(r=c);var f=function(R,X,j){for(var d=0;d<R.length;d++){var h=""+obj.options.data[j][X],F=""+obj.records[j][X].innerHTML;if(R[d]==h||R[d]==F)return!0}return!1},p=obj.filters[r];obj.results=[];for(var L=0;L<obj.options.data.length;L++)f(p,r,L)&&obj.results.push(L);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(r,c,f){var p=r.getAttribute("data-y"),L=r.getAttribute("data-x");obj.dispatch("oneditionstart",el,r,L,p),L>0&&(obj.records[p][L-1].style.overflow="hidden");var R=function(T){var S=r.getBoundingClientRect(),P=document.createElement(T);return P.style.width=S.width+"px",P.style.height=S.height-2+"px",P.style.minHeight=S.height-2+"px",r.classList.add("editor"),r.innerHTML="",r.appendChild(P),obj.dispatch("oncreateeditor",el,r,L,p,P),P};if(r.classList.contains("readonly")!=1){if(obj.edition=[obj.records[p][L],obj.records[p][L].innerHTML,L,p],obj.options.columns[L].editor)obj.options.columns[L].editor.openEditor(r,el,c,f);else if(obj.options.columns[L].type!="hidden")if(obj.options.columns[L].type=="checkbox"||obj.options.columns[L].type=="radio"){var X=!r.children[0].checked;obj.setValue(r,X),obj.edition=null}else if(obj.options.columns[L].type=="dropdown"||obj.options.columns[L].type=="autocomplete"){if(X=obj.options.data[p][L],obj.options.columns[L].multiple&&!Array.isArray(X)&&(X=X.split(";")),typeof obj.options.columns[L].filter=="function")var j=obj.options.columns[L].filter(el,r,L,p,obj.options.columns[L].source);else j=obj.options.columns[L].source;for(var d=[],h=0;h<j.length;h++)d.push(j[h]);var F=R("div"),V={data:d,multiple:!!obj.options.columns[L].multiple,autocomplete:!(!obj.options.columns[L].autocomplete&&obj.options.columns[L].type!="autocomplete"),opened:!0,value:X,width:"100%",height:F.style.minHeight,position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(){obj.closeEditor(r,!0)}};obj.options.columns[L].options&&obj.options.columns[L].options.type&&(V.type=obj.options.columns[L].options.type),jSuites.dropdown(F,V)}else if(obj.options.columns[L].type=="calendar"||obj.options.columns[L].type=="color")X=obj.options.data[p][L],(F=R("input")).value=X,obj.options.tableOverflow!=1&&obj.options.fullscreen!=1||(obj.options.columns[L].options.position=!0),obj.options.columns[L].options.value=obj.options.data[p][L],obj.options.columns[L].options.opened=!0,obj.options.columns[L].options.onclose=function(T,S){obj.closeEditor(r,!0)},obj.options.columns[L].type=="color"?jSuites.color(F,obj.options.columns[L].options):jSuites.calendar(F,obj.options.columns[L].options),F.focus();else if(obj.options.columns[L].type=="html"){X=obj.options.data[p][L],(F=R("div")).style.position="relative",(v=document.createElement("div")).classList.add("jexcel_richtext"),F.appendChild(v),jSuites.editor(v,{focus:!0,value:X});var m=r.getBoundingClientRect(),l=v.getBoundingClientRect();window.innerHeight<m.bottom+l.height?v.style.top=m.top-(l.height+2)+"px":v.style.top=m.top+"px"}else if(obj.options.columns[L].type=="image"){var v,w=r.children[0];(F=R("div")).style.position="relative",(v=document.createElement("div")).classList.add("jclose"),w&&w.src&&v.appendChild(w),F.appendChild(v),jSuites.image(v,obj.options.imageOptions),m=r.getBoundingClientRect(),l=v.getBoundingClientRect(),window.innerHeight<m.bottom+l.height?v.style.top=m.top-(l.height+2)+"px":v.style.top=m.top+"px"}else{X=c==1?"":obj.options.data[p][L],obj.options.columns[L].wordWrap==0||obj.options.wordWrap!=1&&obj.options.columns[L].wordWrap!=1?F=R("input"):F=R("textarea"),F.focus(),F.value=X,V=obj.options.columns[L];var b=null;if(!isFormula(X)&&(b=getMask(V))){if(!V.disabledMaskOnEdition)if(V.mask){var A=V.mask.split(";");F.setAttribute("data-mask",A[0])}else V.locale&&F.setAttribute("data-locale",V.locale);b.input=F,F.mask=b,jSuites.mask.render(X,b,!1)}F.onblur=function(){obj.closeEditor(r,!0)},F.scrollLeft=F.scrollWidth}}},obj.closeEditor=function(r,c){var f=parseInt(r.getAttribute("data-x")),p=parseInt(r.getAttribute("data-y"));if(c==1){if(obj.options.columns[f].editor)var L=obj.options.columns[f].editor.closeEditor(r,c);else if(!(obj.options.columns[f].type=="checkbox"||obj.options.columns[f].type=="radio"||obj.options.columns[f].type=="hidden"))if(obj.options.columns[f].type=="dropdown"||obj.options.columns[f].type=="autocomplete")L=r.children[0].dropdown.close(!0);else if(obj.options.columns[f].type=="calendar")L=r.children[0].calendar.close(!0);else if(obj.options.columns[f].type=="color")L=r.children[0].color.close(!0);else if(obj.options.columns[f].type=="html")L=r.children[0].children[0].editor.getData();else if(obj.options.columns[f].type=="image"){var R=r.children[0].children[0].children[0];L=R&&R.tagName=="IMG"?R.src:""}else if(obj.options.columns[f].type=="numeric")(""+(L=r.children[0].value)).substr(0,1)!="="&&L==""&&(L=obj.options.columns[f].allowEmpty?"":0),r.children[0].onblur=null;else{L=r.children[0].value,r.children[0].onblur=null;var X,j=obj.options.columns[f];if((X=getMask(j))&&L!==""&&!isFormula(L)&&typeof L!="number"){var d=jSuites.mask.extract(L,X,!0);d&&d.value!==""&&(L=d.value)}}obj.options.data[p][f]==L?r.innerHTML=obj.edition[1]:obj.setValue(r,L)}else obj.options.columns[f].editor?obj.options.columns[f].editor.closeEditor(r,c):obj.options.columns[f].type=="dropdown"||obj.options.columns[f].type=="autocomplete"?r.children[0].dropdown.close(!0):obj.options.columns[f].type=="calendar"?r.children[0].calendar.close(!0):obj.options.columns[f].type=="color"?r.children[0].color.close(!0):r.children[0].onblur=null,r.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,r,f,p,L,c),r.classList.remove("editor"),obj.edition=null},obj.getCell=function(r){var c=(r=jexcel.getIdFromColumnName(r,!0))[0],f=r[1];return obj.records[f][c]},obj.getColumnOptions=function(r,c){var f=obj.options.columns[r];return f||(f={type:"text"}),f},obj.getCellFromCoords=function(r,c){return obj.records[c][r]},obj.getLabel=function(r){var c=(r=jexcel.getIdFromColumnName(r,!0))[0],f=r[1];return obj.records[f][c].innerHTML},obj.getLabelFromCoords=function(r,c){return obj.records[c][r].innerHTML},obj.getValue=function(r,c){if(typeof r=="object")var f=r.getAttribute("data-x"),p=r.getAttribute("data-y");else f=(r=jexcel.getIdFromColumnName(r,!0))[0],p=r[1];var L=null;return f!=null&&p!=null&&(obj.records[p]&&obj.records[p][f]&&(c||obj.options.copyCompatibility==1)?L=obj.records[p][f].innerHTML:obj.options.data[p]&&obj.options.data[p][f]!="undefined"&&(L=obj.options.data[p][f])),L},obj.getValueFromCoords=function(r,c,f){var p=null;return r!=null&&c!=null&&(obj.records[c]&&obj.records[c][r]&&f||obj.options.copyCompatibility==1?p=obj.records[c][r].innerHTML:obj.options.data[c]&&obj.options.data[c][r]!="undefined"&&(p=obj.options.data[c][r])),p},obj.setValue=function(r,c,f){var p=[];if(typeof r=="string"){var L=(d=jexcel.getIdFromColumnName(r,!0))[0],R=d[1];p.push(obj.updateCell(L,R,c,f)),obj.updateFormulaChain(L,R,p)}else if(L=null,R=null,r&&r.getAttribute&&(L=r.getAttribute("data-x"),R=r.getAttribute("data-y")),L!=null&&R!=null)p.push(obj.updateCell(L,R,c,f)),obj.updateFormulaChain(L,R,p);else{var X=Object.keys(r);if(X.length>0)for(var j=0;j<X.length;j++){var d;typeof r[j]=="string"?(L=(d=jexcel.getIdFromColumnName(r[j],!0))[0],R=d[1]):r[j].x!=null&&r[j].y!=null?(L=r[j].x,R=r[j].y,r[j].newValue!=null?c=r[j].newValue:r[j].value!=null&&(c=r[j].value)):(L=r[j].getAttribute("data-x"),R=r[j].getAttribute("data-y")),L!=null&&R!=null&&(p.push(obj.updateCell(L,R,c,f)),obj.updateFormulaChain(L,R,p))}}obj.setHistory({action:"setValue",records:p,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,p)},obj.setValueFromCoords=function(r,c,f,p){var L=[];L.push(obj.updateCell(r,c,f,p)),obj.updateFormulaChain(r,c,L),obj.setHistory({action:"setValue",records:L,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,L)},obj.setCheckRadioValue=function(){for(var r=[],c=Object.keys(obj.highlighted),f=0;f<c.length;f++){var p=obj.highlighted[f].getAttribute("data-x"),L=obj.highlighted[f].getAttribute("data-y");obj.options.columns[p].type!="checkbox"&&obj.options.columns[p].type!="radio"||r.push(obj.updateCell(p,L,!obj.options.data[L][p]))}r.length&&(obj.setHistory({action:"setValue",records:r,selection:obj.selectedCell}),obj.onafterchanges(el,r))};var stripScript=function(r){var c=new Option;c.innerHTML=r;var f=null;for(r=c.getElementsByTagName("script");f=r[0];)f.parentNode.removeChild(f);return c.innerHTML};obj.updateCell=function(r,c,f,p){if(obj.records[c][r].classList.contains("readonly")!=1||p){var L;(""+f).substr(0,1)=="="&&obj.options.secureFormulas==1&&(L=secureFormula(f))!=f&&(f=L),(L=obj.dispatch("onbeforechange",el,obj.records[c][r],r,c,f))!=null&&(f=L),obj.options.columns[r].editor&&typeof obj.options.columns[r].editor.updateCell=="function"&&(f=obj.options.columns[r].editor.updateCell(obj.records[c][r],f,p)),F={x:r,y:c,col:r,row:c,newValue:f,oldValue:obj.options.data[c][r]};let V=obj.options.columns[r].editor;if(V)obj.options.data[c][r]=f,typeof V.setValue=="function"&&V.setValue(obj.records[c][r],f);else if(obj.options.columns[r].type=="checkbox"||obj.options.columns[r].type=="radio"){if(obj.options.columns[r].type=="radio")for(var R=0;R<obj.options.data.length;R++)obj.options.data[R][r]=!1;obj.records[c][r].children[0].checked=f==1||f==1||f=="true"||f=="TRUE",obj.options.data[c][r]=obj.records[c][r].children[0].checked}else if(obj.options.columns[r].type=="dropdown"||obj.options.columns[r].type=="autocomplete")obj.options.data[c][r]=f,obj.records[c][r].textContent=obj.getDropDownValue(r,f);else if(obj.options.columns[r].type=="calendar"){var X=null;if(!validDate(f)){var j=jSuites.calendar.extractDateFromString(f,obj.options.columns[r].options.format);j&&(X=j)}obj.options.data[c][r]=f,obj.records[c][r].textContent=jSuites.calendar.getDateString(X||f,obj.options.columns[r].options.format)}else if(obj.options.columns[r].type=="color")if(obj.options.data[c][r]=f,obj.options.columns[r].render=="square"){var d=document.createElement("div");d.className="color",d.style.backgroundColor=f,obj.records[c][r].textContent="",obj.records[c][r].appendChild(d)}else obj.records[c][r].style.color=f,obj.records[c][r].textContent=f;else if(obj.options.columns[r].type=="image"){if(f=""+f,obj.options.data[c][r]=f,obj.records[c][r].innerHTML="",f&&f.substr(0,10)=="data:image"){var h=document.createElement("img");h.src=f,obj.records[c][r].appendChild(h)}}else obj.options.data[c][r]=f,obj.options.columns[r].type=="html"?obj.records[c][r].innerHTML=stripScript(obj.parseValue(r,c,f)):obj.options.stripHTML===!1||obj.options.columns[r].stripHTML===!1?obj.records[c][r].innerHTML=stripScript(obj.parseValue(r,c,f,obj.records[c][r])):obj.records[c][r].textContent=obj.parseValue(r,c,f,obj.records[c][r]),obj.options.columns[r].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[r].wordWrap==1||obj.records[c][r].innerHTML.length>200)?obj.records[c][r].style.whiteSpace="pre-wrap":obj.records[c][r].style.whiteSpace="";r>0&&(obj.records[c][r-1].style.overflow=f?"hidden":""),obj.dispatch("onchange",el,obj.records[c]&&obj.records[c][r]?obj.records[c][r]:null,r,c,f,F.oldValue)}else var F={x:r,y:c,col:r,row:c};return F},obj.copyData=function(r,c){var f=obj.getData(!0,!0),p=obj.selectedContainer,L=parseInt(r.getAttribute("data-x")),R=parseInt(r.getAttribute("data-y")),X=parseInt(c.getAttribute("data-x")),j=parseInt(c.getAttribute("data-y")),d=[],h=!1;if(p[0]==L){if(R<p[1])var F=R-p[1];else F=1;var V=0}else V=L<p[0]?L-p[0]:1,F=0;for(var m=0,l=0,v=R;v<=j;v++)if(!obj.rows[v]||obj.rows[v].style.display!="none"){f[l]==null&&(l=0),m=0,p[0]!=L&&(V=L<p[0]?L-p[0]:1);for(var w=L;w<=X;w++){if(obj.records[v][w]&&!obj.records[v][w].classList.contains("readonly")&&obj.records[v][w].style.display!="none"&&h==0){if(!obj.selection.length&&obj.options.data[v][w]!=""){h=!0;continue}(f[l]==null||f[l][m]==null)&&(m=0);var b=f[l][m];if(b&&!f[1]&&obj.options.autoIncrement==1){if(obj.options.columns[w].type=="text"||obj.options.columns[w].type=="number")if((""+b).substr(0,1)=="="){var A=b.match(/([A-Z]+[0-9]+)/g);if(A){for(var T=[],S=0;S<A.length;S++){var P=jexcel.getIdFromColumnName(A[S],1);P[0]+=V,P[1]+=F,P[1]<0&&(P[1]=0);var _=jexcel.getColumnNameFromId([P[0],P[1]]);_!=A[S]&&(T[A[S]]=_)}T&&(b=obj.updateFormula(b,T))}}else b==Number(b)&&(b=Number(b)+F);else if(obj.options.columns[w].type=="calendar"){var I=new Date(b);I.setDate(I.getDate()+F),b=I.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(I.getMonth()+1))+"-"+jexcel.doubleDigitFormat(I.getDate())+" 00:00:00"}}d.push(obj.updateCell(w,v,b)),obj.updateFormulaChain(w,v,d)}m++,p[0]!=L&&V++}l++,F++}obj.setHistory({action:"setValue",records:d,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,d)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(r,c,f){if(r==1){if(obj.selectedCell&&(c>=obj.selectedCell[1]&&c<=obj.selectedCell[3]||f>=obj.selectedCell[1]&&f<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(c>=obj.selectedCell[0]&&c<=obj.selectedCell[2]||f>=obj.selectedCell[0]&&f<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(r){if(obj.highlighted.length){h=1;for(var c=0;c<obj.highlighted.length;c++){obj.highlighted[c].classList.remove("highlight"),obj.highlighted[c].classList.remove("highlight-left"),obj.highlighted[c].classList.remove("highlight-right"),obj.highlighted[c].classList.remove("highlight-top"),obj.highlighted[c].classList.remove("highlight-bottom"),obj.highlighted[c].classList.remove("highlight-selected");var f=parseInt(obj.highlighted[c].getAttribute("data-x")),p=parseInt(obj.highlighted[c].getAttribute("data-y"));if(obj.highlighted[c].getAttribute("data-merged"))var L=parseInt(obj.highlighted[c].getAttribute("colspan")),R=parseInt(obj.highlighted[c].getAttribute("rowspan")),X=L>0?f+(L-1):f,j=R>0?p+(R-1):p;else X=f,j=p;for(var d=f;d<=X;d++)obj.headers[d]&&obj.headers[d].classList.remove("selected");for(d=p;d<=j;d++)obj.rows[d]&&obj.rows[d].classList.remove("selected")}}else var h=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",r==1&&h==1&&obj.dispatch("onblur",el),h},obj.updateSelection=function(r,c,f){var p=r.getAttribute("data-x"),L=r.getAttribute("data-y");if(c)var R=c.getAttribute("data-x"),X=c.getAttribute("data-y");else R=p,X=L;obj.updateSelectionFromCoords(p,L,R,X,f)},obj.updateSelectionFromCoords=function(r,c,f,p,L){var R=obj.resetSelection();if(c==null&&(c=0,p=obj.rows.length-1),f==null&&(f=r),p==null&&(p=c),r>=obj.headers.length&&(r=obj.headers.length-1),c>=obj.rows.length&&(c=obj.rows.length-1),f>=obj.headers.length&&(f=obj.headers.length-1),p>=obj.rows.length&&(p=obj.rows.length-1),obj.selectedCell=[r,c,f,p],r!=null){if(obj.records[c][r]&&obj.records[c][r].classList.add("highlight-selected"),parseInt(r)<parseInt(f))var X=parseInt(r),j=parseInt(f);else X=parseInt(f),j=parseInt(r);if(parseInt(c)<parseInt(p))var d=parseInt(c),h=parseInt(p);else d=parseInt(p),h=parseInt(c);for(var F=X;F<=j;F++)for(var V=d;V<=h;V++)if(obj.records[V][F]&&obj.records[V][F].getAttribute("data-merged")){var m=parseInt(obj.records[V][F].getAttribute("data-x")),l=parseInt(obj.records[V][F].getAttribute("data-y")),v=parseInt(obj.records[V][F].getAttribute("colspan")),w=parseInt(obj.records[V][F].getAttribute("rowspan"));v>1&&(m<X&&(X=m),m+v>j&&(j=m+v-1)),w&&(l<d&&(d=l),l+w>h&&(h=l+w-1))}var b=null,A=null,T=null,S=null;for(V=d;V<=h;V++)obj.rows[V].style.display!="none"&&(T==null&&(T=V),S=V);for(F=X;F<=j;F++){for(V=d;V<=h;V++)obj.rows[V].style.display!="none"&&obj.records[V][F].style.display!="none"&&(obj.records[V][F].classList.add("highlight"),obj.highlighted.push(obj.records[V][F]));obj.options.columns[F].type!="hidden"&&(b==null&&(b=F),A=F)}for(b||(b=0),A||(A=0),F=b;F<=A;F++)obj.options.columns[F].type!="hidden"&&(obj.records[T]&&obj.records[T][F]&&obj.records[T][F].classList.add("highlight-top"),obj.records[S]&&obj.records[S][F]&&obj.records[S][F].classList.add("highlight-bottom"),obj.headers[F].classList.add("selected"));for(V=T;V<=S;V++)obj.rows[V]&&obj.rows[V].style.display!="none"&&(obj.records[V][b].classList.add("highlight-left"),obj.records[V][A].classList.add("highlight-right"),obj.rows[V].classList.add("selected"));obj.selectedContainer=[b,T,A,S]}R==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,b,T,A,S,L),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var r=0;r<obj.selection.length;r++)obj.selection[r].classList.remove("selection"),obj.selection[r].classList.remove("selection-left"),obj.selection[r].classList.remove("selection-right"),obj.selection[r].classList.remove("selection-top"),obj.selection[r].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(r,c){obj.removeCopySelection();var f=obj.selectedContainer[0],p=obj.selectedContainer[1],L=obj.selectedContainer[2],R=obj.selectedContainer[3];if(r!=null&&c!=null){if(r-L>0)var X=parseInt(L)+1,j=parseInt(r);else X=parseInt(r),j=parseInt(f)-1;if(c-R>0)var d=parseInt(R)+1,h=parseInt(c);else d=parseInt(c),h=parseInt(p)-1;j-X<=h-d?(X=parseInt(f),j=parseInt(L)):(d=parseInt(p),h=parseInt(R));for(var F=d;F<=h;F++)for(var V=X;V<=j;V++)obj.records[F][V]&&obj.rows[F].style.display!="none"&&obj.records[F][V].style.display!="none"&&(obj.records[F][V].classList.add("selection"),obj.records[d][V].classList.add("selection-top"),obj.records[h][V].classList.add("selection-bottom"),obj.records[F][X].classList.add("selection-left"),obj.records[F][j].classList.add("selection-right"),obj.selection.push(obj.records[F][V]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var r=obj.highlighted[obj.highlighted.length-1],c=r.getAttribute("data-x"),f=obj.content.getBoundingClientRect(),p=f.left,L=f.top,R=r.getBoundingClientRect(),X=R.left,j=R.top,d=R.width,h=R.height,F=X-p+obj.content.scrollLeft+d-4,V=j-L+obj.content.scrollTop+h-4;if(obj.corner.style.top=V+"px",obj.corner.style.left=F+"px",obj.options.freezeColumns){var m=obj.getFreezeWidth();c>obj.options.freezeColumns-1&&X-p+d<m?obj.corner.style.display="none":obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(r){var c=obj.content.getBoundingClientRect(),f=c.left,p=c.top,L=c.width,R=c.height,X=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),j=X.left,d=X.top,h=X.width,F=X.height;if(r==0||r==1)var V=j-f+obj.content.scrollLeft,m=d-p+obj.content.scrollTop-2;else V=j-f+obj.content.scrollLeft+h,m=d-p+obj.content.scrollTop+F;m>obj.content.scrollTop+30&&m<obj.content.scrollTop+R||(m<obj.content.scrollTop+30?obj.content.scrollTop=m-F:obj.content.scrollTop=m-(R-2));var l=obj.getFreezeWidth();V>obj.content.scrollLeft+l&&V<obj.content.scrollLeft+L||(V<obj.content.scrollLeft+30?(obj.content.scrollLeft=V,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):V<obj.content.scrollLeft+l?obj.content.scrollLeft=V-l-1:obj.content.scrollLeft=V-(L-20))},obj.getWidth=function(r){if(r===void 0)for(var c=[],f=0;f<obj.headers.length;f++)c.push(obj.options.columns[f].width);else typeof r=="object"&&(r=r.getAttribute("data-x")),c=obj.colgroup[r].getAttribute("width");return c},obj.setWidth=function(r,c,f){if(c){if(Array.isArray(r)){f||(f=[]);for(var p=0;p<r.length;p++){f[p]||(f[p]=obj.colgroup[r[p]].getAttribute("width"));var L=Array.isArray(c)&&c[p]?c[p]:c;obj.colgroup[r[p]].setAttribute("width",L),obj.options.columns[r[p]].width=L}}else f||(f=obj.colgroup[r].getAttribute("width")),obj.colgroup[r].setAttribute("width",c),obj.options.columns[r].width=c;obj.setHistory({action:"setWidth",column:r,oldValue:f,newValue:c}),obj.dispatch("onresizecolumn",el,r,c,f),obj.updateCornerPosition()}},obj.setHeight=function(r,c,f){c>0&&(typeof r=="object"&&(r=r.getAttribute("data-y")),f||(f=obj.rows[r].getAttribute("height"))||(f=obj.rows[r].getBoundingClientRect().height),c=parseInt(c),obj.rows[r].style.height=c+"px",obj.options.rows[r]||(obj.options.rows[r]={}),obj.options.rows[r].height=c,obj.setHistory({action:"setHeight",row:r,oldValue:f,newValue:c}),obj.dispatch("onresizerow",el,r,c,f),obj.updateCornerPosition())},obj.getHeight=function(r){if(r===void 0)for(var c=[],f=0;f<obj.rows.length;f++){var p=obj.rows[f].style.height;p&&(c[f]=p)}else typeof r=="object"&&(r=$(r).getAttribute("data-y")),c=obj.rows[r].style.height;return c},obj.setFooter=function(r){if(r&&(obj.options.footers=r),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var c=0;c<obj.options.footers.length;c++){if(obj.tfoot.children[c])var f=obj.tfoot.children[c];else{f=document.createElement("tr");var p=document.createElement("td");f.appendChild(p),obj.tfoot.appendChild(f)}for(var L=0;L<obj.headers.length;L++){if(obj.options.footers[c][L]||(obj.options.footers[c][L]=""),obj.tfoot.children[c].children[L+1])p=obj.tfoot.children[c].children[L+1];else{p=document.createElement("td"),f.appendChild(p);var R=obj.options.columns[L].align?obj.options.columns[L].align:"center";p.style.textAlign=R}p.textContent=obj.parseValue(+obj.records.length+L,c,obj.options.footers[c][L]),p.style.display=obj.colgroup[L].style.display}}}},obj.getHeader=function(r){return obj.headers[r].textContent},obj.setHeader=function(r,c){if(obj.headers[r]){var f=obj.headers[r].textContent;c||(c=prompt(obj.options.text.columnName,f)),c&&(obj.headers[r].textContent=c,obj.headers[r].setAttribute("title",c),obj.options.columns[r].title=c),obj.setHistory({action:"setHeader",column:r,oldValue:f,newValue:c}),obj.dispatch("onchangeheader",el,r,f,c)}},obj.getHeaders=function(r){for(var c=[],f=0;f<obj.headers.length;f++)c.push(obj.getHeader(f));return r?c:c.join(obj.options.csvDelimiter)},obj.getMeta=function(r,c){return r?c?obj.options.meta[r]&&obj.options.meta[r][c]?obj.options.meta[r][c]:null:obj.options.meta[r]?obj.options.meta[r]:null:obj.options.meta},obj.setMeta=function(r,c,f){if(obj.options.meta||(obj.options.meta={}),c&&f)obj.options.meta[r]||(obj.options.meta[r]={}),obj.options.meta[r][c]=f;else for(var p=Object.keys(r),L=0;L<p.length;L++){obj.options.meta[p[L]]||(obj.options.meta[p[L]]={});for(var R=Object.keys(r[p[L]]),X=0;X<R.length;X++)obj.options.meta[p[L]][R[X]]=r[p[L]][R[X]]}obj.dispatch("onchangemeta",el,r,c,f)},obj.updateMeta=function(r){if(obj.options.meta){for(var c={},f=Object.keys(obj.options.meta),p=0;p<f.length;p++)r[f[p]]?c[r[f[p]]]=obj.options.meta[f[p]]:c[f[p]]=obj.options.meta[f[p]];obj.options.meta=c}},obj.getStyle=function(r,c){if(r)return r=jexcel.getIdFromColumnName(r,!0),c?obj.records[r[1]][r[0]].style[c]:obj.records[r[1]][r[0]].getAttribute("style");for(var f={},p=obj.options.data[0].length,L=obj.options.data.length,R=0;R<L;R++)for(var X=0;X<p;X++){var j=c?obj.records[R][X].style[c]:obj.records[R][X].getAttribute("style");j&&(f[jexcel.getColumnNameFromId([X,R])]=j)}return f},obj.resetStyle=function(r,c){for(var f=Object.keys(r),p=0;p<f.length;p++){var L=jexcel.getIdFromColumnName(f[p],!0);obj.records[L[1]]&&obj.records[L[1]][L[0]]&&obj.records[L[1]][L[0]].setAttribute("style","")}obj.setStyle(r,null,null,null,c)},obj.setStyle=function(r,c,f,p,L){var R={},X={},j=function(b,A,T){var S=jexcel.getIdFromColumnName(b,!0);if(obj.records[S[1]]&&obj.records[S[1]][S[0]]&&(obj.records[S[1]][S[0]].classList.contains("readonly")==0||p)){var P=obj.records[S[1]][S[0]].style[A];P!=T||p?obj.records[S[1]][S[0]].style[A]=T:(T="",obj.records[S[1]][S[0]].style[A]=""),X[b]||(X[b]=[]),R[b]||(R[b]=[]),X[b].push([A+":"+P]),R[b].push([A+":"+T])}};if(c&&f)if(typeof r=="string")j(r,c,f);else for(var d=[],h=0;h<r.length;h++){var F=r[h].getAttribute("data-x"),V=r[h].getAttribute("data-y"),m=jexcel.getColumnNameFromId([F,V]);d[m]||(j(m,c,f),d[m]=!0)}else{var l=Object.keys(r);for(h=0;h<l.length;h++){var v=r[l[h]];typeof v=="string"&&(v=v.split(";"));for(var w=0;w<v.length;w++)typeof v[w]=="string"&&(v[w]=v[w].split(":")),v[w][0].trim()&&j(l[h],v[w][0].trim(),v[w][1])}}for(l=Object.keys(X),h=0;h<l.length;h++)X[l[h]]=X[l[h]].join(";");for(l=Object.keys(R),h=0;h<l.length;h++)R[l[h]]=R[l[h]].join(";");L||obj.setHistory({action:"setStyle",oldValue:X,newValue:R}),obj.dispatch("onchangestyle",el,r,c,f)},obj.getComments=function(r,c){if(r)return typeof r=="string"&&(r=jexcel.getIdFromColumnName(r,!0)),c?[obj.records[r[1]][r[0]].getAttribute("title"),obj.records[r[1]][r[0]].getAttribute("author")]:obj.records[r[1]][r[0]].getAttribute("title")||"";for(var f={},p=0;p<obj.options.data.length;p++)for(var L=0;L<obj.options.columns.length;L++){var R=obj.records[p][L].getAttribute("title");R&&(f[r=jexcel.getColumnNameFromId([L,p])]=R)}return f},obj.setComments=function(r,c,f){if(typeof r=="string")var p=jexcel.getIdFromColumnName(r,!0);else p=r;var L=obj.records[p[1]][p[0]].getAttribute("title"),R=[L,f=obj.records[p[1]][p[0]].getAttribute("data-author")];obj.records[p[1]][p[0]].setAttribute("title",c||""),obj.records[p[1]][p[0]].setAttribute("data-author",f||""),c?obj.records[p[1]][p[0]].classList.add("jexcel_comments"):obj.records[p[1]][p[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:r,newValue:[c,f],oldValue:R}),obj.dispatch("oncomments",el,c,L,p,p[0],p[1])},obj.getConfig=function(){var r=obj.options;return r.style=obj.getStyle(),r.mergeCells=obj.getMerge(),r.comments=obj.getComments(),r},obj.orderBy=function(r,c){if(r>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}c=c==null?obj.headers[r].classList.contains("arrow-down")?1:0:c?1:0;var f=[];if(obj.options.columns[r].type=="number"||obj.options.columns[r].type=="numeric"||obj.options.columns[r].type=="percentage"||obj.options.columns[r].type=="autonumber"||obj.options.columns[r].type=="color")for(var p=0;p<obj.options.data.length;p++)f[p]=[p,Number(obj.options.data[p][r])];else if(obj.options.columns[r].type=="calendar"||obj.options.columns[r].type=="checkbox"||obj.options.columns[r].type=="radio")for(p=0;p<obj.options.data.length;p++)f[p]=[p,obj.options.data[p][r]];else for(p=0;p<obj.options.data.length;p++)f[p]=[p,obj.records[p][r].textContent.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(R){return function(X,j){var d=X[1],h=j[1];return R?d===""&&h!==""?1:d!==""&&h===""||d>h?-1:d<h?1:0:d===""&&h!==""?1:d!==""&&h===""?-1:d>h?1:d<h?-1:0}}),f=f.sort(obj.options.sorting(c));var L=[];for(p=0;p<f.length;p++)L[p]=f[p][0];return obj.setHistory({action:"orderBy",rows:L,column:r,order:c}),obj.updateOrderArrow(r,c),obj.updateOrder(L),obj.dispatch("onsort",el,r,c),!0}},obj.updateOrderArrow=function(r,c){for(var f=0;f<obj.headers.length;f++)obj.headers[f].classList.remove("arrow-up"),obj.headers[f].classList.remove("arrow-down");c?obj.headers[r].classList.add("arrow-up"):obj.headers[r].classList.add("arrow-down")},obj.updateOrder=function(r){for(var c=[],f=0;f<r.length;f++)c[f]=obj.options.data[r[f]];for(obj.options.data=c,c=[],f=0;f<r.length;f++)c[f]=obj.records[r[f]];for(obj.records=c,c=[],f=0;f<r.length;f++)c[f]=obj.rows[r[f]];if(obj.rows=c,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==1)obj.loadPage(0);else for(f=0;f<obj.rows.length;f++)obj.tbody.appendChild(obj.rows[f])},obj.moveRow=function(r,c,f){if(Object.keys(obj.options.mergeCells).length>0){if(r>c)var p=1;else p=0;if(obj.isRowMerged(r).length||obj.isRowMerged(c,p).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}f||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[c])>=0?r>c?obj.tbody.insertBefore(obj.rows[r],obj.rows[c]):obj.tbody.insertBefore(obj.rows[r],obj.rows[c].nextSibling):obj.tbody.removeChild(obj.rows[r])),obj.rows.splice(c,0,obj.rows.splice(r,1)[0]),obj.records.splice(c,0,obj.records.splice(r,1)[0]),obj.options.data.splice(c,0,obj.options.data.splice(r,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:r,newValue:c}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,r,c)},obj.insertRow=function(r,c,f){if(obj.options.allowInsertRow==1){var p=[];if(r>0)var L=r;else L=1,r&&(p=r);f=!!f;var R=obj.options.data.length-1;if((c==null||c>=parseInt(R)||c<0)&&(c=R),obj.dispatch("onbeforeinsertrow",el,c,L,f)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(c,f).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var X=f?c:c+1,j=obj.records.splice(X),d=obj.options.data.splice(X),h=obj.rows.splice(X),F=[],V=[],m=[],l=X;l<L+X;l++){obj.options.data[l]=[];for(var v=0;v<obj.options.columns.length;v++)obj.options.data[l][v]=p[v]?p[v]:"";var w=obj.createRow(l,obj.options.data[l]);h[0]?Array.prototype.indexOf.call(obj.tbody.children,h[0])>=0&&obj.tbody.insertBefore(w,h[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[c])>=0&&obj.tbody.appendChild(w),F.push(obj.records[l]),V.push(obj.options.data[l]),m.push(w)}Array.prototype.push.apply(obj.records,j),Array.prototype.push.apply(obj.options.data,d),Array.prototype.push.apply(obj.rows,h),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:c,numOfRows:L,insertBefore:f,rowRecords:F,rowData:V,rowNode:m}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,c,L,F,f)}},obj.deleteRow=function(r,c){if(obj.options.allowDeleteRow==1)if(obj.options.allowDeletingAllRows==1||obj.options.data.length>1){if(r==null){var f=obj.getSelectedRows();f[0]?(r=parseInt(f[0].getAttribute("data-y")),c=f.length):(r=obj.options.data.length-1,c=1)}var p=obj.options.data.length-1;if((r==null||r>p||r<0)&&(r=p),c||(c=1),r+c>=obj.options.data.length&&(c=obj.options.data.length-r),obj.dispatch("onbeforedeleterow",el,r,c)===!1)return!1;if(parseInt(r)>-1){var L=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var R=r;R<r+c;R++)obj.isRowMerged(R,!1).length&&(L=!0);if(L){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(obj.options.allowDeletingAllRows==0&&p+1===c&&(c--,console.error("Jspreadsheet: It is not possible to delete the last row")),R=r;R<r+c;R++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[R])>=0&&(obj.rows[R].className="",obj.rows[R].parentNode.removeChild(obj.rows[R]));var X=obj.records.splice(r,c),j=obj.options.data.splice(r,c),d=obj.rows.splice(r,c);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,r,r+c-1),obj.setHistory({action:"deleteRow",rowNumber:r,numOfRows:c,insertBefore:1,rowRecords:X,rowData:j,rowNode:d}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,r,c,X)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(r,c){if(Object.keys(obj.options.mergeCells).length>0){if(r>c)var f=1;else f=0;if(obj.isColMerged(r).length||obj.isColMerged(c,f).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((r=parseInt(r))>(c=parseInt(c))){obj.headerContainer.insertBefore(obj.headers[r],obj.headers[c]),obj.colgroupContainer.insertBefore(obj.colgroup[r],obj.colgroup[c]);for(var p=0;p<obj.rows.length;p++)obj.rows[p].insertBefore(obj.records[p][r],obj.records[p][c])}else for(obj.headerContainer.insertBefore(obj.headers[r],obj.headers[c].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[r],obj.colgroup[c].nextSibling),p=0;p<obj.rows.length;p++)obj.rows[p].insertBefore(obj.records[p][r],obj.records[p][c].nextSibling);for(obj.options.columns.splice(c,0,obj.options.columns.splice(r,1)[0]),obj.headers.splice(c,0,obj.headers.splice(r,1)[0]),obj.colgroup.splice(c,0,obj.colgroup.splice(r,1)[0]),p=0;p<obj.rows.length;p++)obj.options.data[p].splice(c,0,obj.options.data[p].splice(r,1)[0]),obj.records[p].splice(c,0,obj.records[p].splice(r,1)[0]);if(obj.options.footers)for(p=0;p<obj.options.footers.length;p++)obj.options.footers[p].splice(c,0,obj.options.footers[p].splice(r,1)[0]);obj.setHistory({action:"moveColumn",oldValue:r,newValue:c}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,r,c)},obj.insertColumn=function(r,c,f,p){if(obj.options.allowInsertColumn==1){var L=[];if(r>0)var R=r;else R=1,r&&(L=r);f=!!f;var X=obj.options.columns.length-1;if((c==null||c>=parseInt(X)||c<0)&&(c=X),obj.dispatch("onbeforeinsertcolumn",el,c,R,f)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(c,f).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}p||(p=[]);for(var j=0;j<R;j++)p[j]||(p[j]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var d=f?c:c+1;obj.options.columns=jexcel.injectArray(obj.options.columns,d,p);for(var h=obj.headers.splice(d),F=obj.colgroup.splice(d),V=[],m=[],l=[],v=[],w=[],b=d;b<R+d;b++)obj.createCellHeader(b),obj.headerContainer.insertBefore(obj.headers[b],obj.headerContainer.children[b+1]),obj.colgroupContainer.insertBefore(obj.colgroup[b],obj.colgroupContainer.children[b+1]),V.push(obj.headers[b]),m.push(obj.colgroup[b]);if(obj.options.footers)for(var A=0;A<obj.options.footers.length;A++){for(w[A]=[],j=0;j<R;j++)w[A].push("");obj.options.footers[A].splice(d,0,w[A])}for(var T=0;T<obj.options.data.length;T++){var S=obj.options.data[T].splice(d),P=obj.records[T].splice(d);for(v[T]=[],l[T]=[],b=d;b<R+d;b++){var _=L[T]?L[T]:"";obj.options.data[T][b]=_;var I=obj.createCell(b,T,obj.options.data[T][b]);obj.records[T][b]=I,obj.rows[T]&&obj.rows[T].insertBefore(I,obj.rows[T].children[b+1]),v[T].push(_),l[T].push(I)}Array.prototype.push.apply(obj.options.data[T],S),Array.prototype.push.apply(obj.records[T],P)}if(Array.prototype.push.apply(obj.headers,h),Array.prototype.push.apply(obj.colgroup,F),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(A=0;A<obj.options.nestedHeaders.length;A++){var H=parseInt(obj.options.nestedHeaders[A][obj.options.nestedHeaders[A].length-1].colspan)+R;obj.options.nestedHeaders[A][obj.options.nestedHeaders[A].length-1].colspan=H,obj.thead.children[A].children[obj.thead.children[A].children.length-1].setAttribute("colspan",H);var K=obj.thead.children[A].children[obj.thead.children[A].children.length-1].getAttribute("data-column");for(K=K.split(","),b=d;b<R+d;b++)K.push(b);obj.thead.children[A].children[obj.thead.children[A].children.length-1].setAttribute("data-column",K)}else H=parseInt(obj.options.nestedHeaders[0].colspan)+R,obj.options.nestedHeaders[0].colspan=H,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",H);obj.setHistory({action:"insertColumn",columnNumber:c,numOfColumns:R,insertBefore:f,columns:p,headers:V,colgroup:m,records:l,footers:w,data:v}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,c,R,l,f)}},obj.deleteColumn=function(r,c){if(obj.options.allowDeleteColumn==1)if(obj.headers.length>1){if(r==null){var f=obj.getSelectedColumns(!0);f.length?(r=parseInt(f[0]),c=parseInt(f.length)):(r=obj.headers.length-1,c=1)}var p=obj.options.data[0].length-1;if((r==null||r>p||r<0)&&(r=p),c||(c=1),c>obj.options.data[0].length-r&&(c=obj.options.data[0].length-r),obj.dispatch("onbeforedeletecolumn",el,r,c)===!1)return!1;if(parseInt(r)>-1){var L=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var R=r;R<r+c;R++)obj.isColMerged(R,!1).length&&(L=!0);if(L){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var X=obj.options.columns.splice(r,c);for(R=r;R<r+c;R++)obj.colgroup[R].className="",obj.headers[R].className="",obj.colgroup[R].parentNode.removeChild(obj.colgroup[R]),obj.headers[R].parentNode.removeChild(obj.headers[R]);for(var j=obj.headers.splice(r,c),d=obj.colgroup.splice(r,c),h=[],F=[],V=[],m=0;m<obj.options.data.length;m++)for(R=r;R<r+c;R++)obj.records[m][R].className="",obj.records[m][R].parentNode.removeChild(obj.records[m][R]);for(m=0;m<obj.options.data.length;m++)F[m]=obj.options.data[m].splice(r,c),h[m]=obj.records[m].splice(r,c);if(obj.options.footers)for(m=0;m<obj.options.footers.length;m++)V[m]=obj.options.footers[m].splice(r,c);if(obj.conditionalSelectionUpdate(0,r,r+c-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var l=0;l<obj.options.nestedHeaders.length;l++){var v=parseInt(obj.options.nestedHeaders[l][obj.options.nestedHeaders[l].length-1].colspan)-c;obj.options.nestedHeaders[l][obj.options.nestedHeaders[l].length-1].colspan=v,obj.thead.children[l].children[obj.thead.children[l].children.length-1].setAttribute("colspan",v)}else v=parseInt(obj.options.nestedHeaders[0].colspan)-c,obj.options.nestedHeaders[0].colspan=v,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",v);obj.setHistory({action:"deleteColumn",columnNumber:r,numOfColumns:c,insertBefore:1,columns:X,headers:j,colgroup:d,records:h,footers:V,data:F}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,r,c,h)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(r){for(var c=[],f=0;f<obj.rows.length;f++)obj.rows[f].classList.contains("selected")&&(r?c.push(f):c.push(obj.rows[f]));return c},obj.getSelectedColumns=function(){for(var r=[],c=0;c<obj.headers.length;c++)obj.headers[c].classList.contains("selected")&&r.push(c);return r},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var r=0;r<obj.headers.length;r++)(R=obj.headers[r].getAttribute("data-x"))!=r&&(obj.headers[r].setAttribute("data-x",r),obj.headers[r].getAttribute("title")||(obj.headers[r].innerHTML=jexcel.getColumnName(r)));for(var c=0;c<obj.rows.length;c++)obj.rows[c]&&(X=obj.rows[c].getAttribute("data-y"))!=c&&(obj.rows[c].setAttribute("data-y",c),obj.rows[c].children[0].setAttribute("data-y",c),obj.rows[c].children[0].innerHTML=c+1);var f=[],p=[],L=function(l,v,w,b){if(l!=w&&obj.records[b][w].setAttribute("data-x",w),v!=b&&obj.records[b][w].setAttribute("data-y",b),l!=w||v!=b){var A=jexcel.getColumnNameFromId([l,v]),T=jexcel.getColumnNameFromId([w,b]);f[A]=T}};for(c=0;c<obj.records.length;c++)for(r=0;r<obj.records[0].length;r++)if(obj.records[c][r]){var R=obj.records[c][r].getAttribute("data-x"),X=obj.records[c][r].getAttribute("data-y");if(obj.records[c][r].getAttribute("data-merged")){var j=jexcel.getColumnNameFromId([R,X]),d=jexcel.getColumnNameFromId([r,c]);if(p[j]==null)if(j==d)p[j]=!1;else{var h=parseInt(r-R),F=parseInt(c-X);p[j]=[d,h,F]}}else L(R,X,r,c)}var V=Object.keys(p);if(V.length){for(r=0;r<V.length;r++)if(p[V[r]]){var m=jexcel.getIdFromColumnName(V[r],!0);for(L(R=m[0],X=m[1],R+p[V[r]][1],X+p[V[r]][2]),j=V[r],d=p[V[r]][0],c=0;c<obj.options.mergeCells[j][2].length;c++)R=parseInt(obj.options.mergeCells[j][2][c].getAttribute("data-x")),X=parseInt(obj.options.mergeCells[j][2][c].getAttribute("data-y")),obj.options.mergeCells[j][2][c].setAttribute("data-x",R+p[V[r]][1]),obj.options.mergeCells[j][2][c].setAttribute("data-y",X+p[V[r]][2]);obj.options.mergeCells[d]=obj.options.mergeCells[j],delete obj.options.mergeCells[j]}}obj.updateFormulas(f),obj.updateMeta(f),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var r=0,c=obj.rows.length-1;c>=0;c--){for(var f=!1,p=0;p<obj.headers.length;p++)obj.options.data[c][p]&&(f=!0);if(f)break;r++}obj.options.minSpareRows-r>0&&obj.insertRow(obj.options.minSpareRows-r)}if(obj.options.minSpareCols>0){var L=0;for(p=obj.headers.length-1;p>=0;p--){for(f=!1,c=0;c<obj.rows.length;c++)obj.options.data[c][p]&&(f=!0);if(f)break;L++}obj.options.minSpareCols-L>0&&obj.insertColumn(obj.options.minSpareCols-L)}if(typeof obj.options.updateTable=="function"){for(obj.options.detachForUpdates&&el.removeChild(obj.content),c=0;c<obj.rows.length;c++)for(p=0;p<obj.headers.length;p++)obj.options.updateTable(el,obj.records[c][p],p,c,obj.options.data[c][p],obj.records[c][p].textContent,jexcel.getColumnNameFromId([p,c]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(r){if(r=obj.getCell(r))return!!r.classList.contains("readonly")},obj.setReadOnly=function(r,c){(r=obj.getCell(r))&&(c?r.classList.add("readonly"):r.classList.remove("readonly"))},obj.showRow=function(r){obj.rows[r].style.display=""},obj.hideRow=function(r){obj.rows[r].style.display="none"},obj.showColumn=function(r){obj.headers[r].style.display="",obj.colgroup[r].style.display="",obj.filter&&obj.filter.children.length>r+1&&(obj.filter.children[r+1].style.display="");for(var c=0;c<obj.options.data.length;c++)obj.records[c][r].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(r){obj.headers[r].style.display="none",obj.colgroup[r].style.display="none",obj.filter&&obj.filter.children.length>r+1&&(obj.filter.children[r+1].style.display="none");for(var c=0;c<obj.options.data.length;c++)obj.records[c][r].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(r,c,f){var p=jexcel.getColumnNameFromId([r,c]);if(obj.formula[p]&&obj.formula[p].length>0)if(chainLoopProtection[p])obj.records[c][r].innerHTML="#ERROR",obj.formula[p]="";else{chainLoopProtection[p]=!0;for(var L=0;L<obj.formula[p].length;L++){var R=jexcel.getIdFromColumnName(obj.formula[p][L],!0),X=""+obj.options.data[R[1]][R[0]];X.substr(0,1)=="="?f.push(obj.updateCell(R[0],R[1],X,!0)):Object.keys(obj.formula)[L]=null,obj.updateFormulaChain(R[0],R[1],f)}}chainLoopProtection=[]},obj.updateFormulas=function(r){for(var c=0;c<obj.options.data.length;c++)for(var f=0;f<obj.options.data[0].length;f++)if((j=""+obj.options.data[c][f]).substr(0,1)=="="){var p=obj.updateFormula(j,r);p!=j&&(obj.options.data[c][f]=p)}var L=[],R=Object.keys(obj.formula);for(c=0;c<R.length;c++){var X=R[c],j=obj.formula[X];for(r[X]&&(X=r[X]),L[X]=[],f=0;f<j.length;f++){var d=j[f];r[d]&&(d=r[d]),L[X].push(d)}}obj.formula=L},obj.updateFormula=function(r,c){for(var f=/[A-Z]/,p=/[0-9]/,L="",R=null,X=null,j="",d=0;d<r.length;d++)f.exec(r[d])?(R=1,X=0,j+=r[d]):p.exec(r[d])?(X=R?1:0,j+=r[d]):(R&&X&&(j=c[j]?c[j]:j),L+=j,L+=r[d],R=0,X=0,j="");return j&&(R&&X&&(j=c[j]?c[j]:j),L+=j),L};var secureFormula=function(r){for(var c="",f=0,p=0;p<r.length;p++)r[p]=='"'&&(f=f==0?1:0),c+=f==1?r[p]:r[p].toUpperCase();return c};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(r){for(var c=0;c<r.length;c++){var f=[],p=r[c].split(":"),L=jexcel.getIdFromColumnName(p[0],!0),R=jexcel.getIdFromColumnName(p[1],!0);if(L[0]<=R[0])var X=L[0],j=R[0];else X=R[0],j=L[0];if(L[1]<=R[1])var d=L[1],h=R[1];else d=R[1],h=L[1];for(var F=d;F<=h;F++)for(var V=X;V<=j;V++)f.push(jexcel.getColumnNameFromId([V,F]));expression=expression.replace(r[c],f.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(obj.options.data[position[1]]!==void 0&&obj.options.data[position[1]][position[0]]!==void 0)var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==1)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==1&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(r){var res="#ERROR";console.log(r)}return res};return execute(expression,x,y)},obj.parseNumber=function(r,c){var f=c&&obj.options.columns[c].decimal?obj.options.columns[c].decimal:".",p=""+r;return(p=p.split(f))[0]=p[0].match(/[+-]?[0-9]/g),p[0]&&(p[0]=p[0].join("")),p[1]&&(p[1]=p[1].match(/[0-9]*/g).join("")),p[0]&&Number.isInteger(Number(p[0]))?p[1]?r=+(p[0]+"."+p[1]):r=+(p[0]+".00"):r=null,r},obj.row=function(r){},obj.col=function(r){},obj.up=function(r,c){if(r?obj.selectedCell[3]>0&&obj.up.visible(1,c?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,c?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var f=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-f<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var p=obj.whichPage(obj.selectedCell[3]);p!=obj.pageNumber&&obj.page(p)}obj.updateScroll(1)},obj.up.visible=function(r,c){if(r==0)var f=parseInt(obj.selectedCell[0]),p=parseInt(obj.selectedCell[1]);else f=parseInt(obj.selectedCell[2]),p=parseInt(obj.selectedCell[3]);if(c==0){for(var L=0;L<p;L++)if(obj.records[L][f].style.display!="none"&&obj.rows[L].style.display!="none"){p=L;break}}else p=obj.up.get(f,p);r==0?(obj.selectedCell[0]=f,obj.selectedCell[1]=p):(obj.selectedCell[2]=f,obj.selectedCell[3]=p)},obj.up.get=function(r,c){r=parseInt(r);for(var f=(c=parseInt(c))-1;f>=0;f--)if(obj.records[f][r].style.display!="none"&&obj.rows[f].style.display!="none"){if(obj.records[f][r].getAttribute("data-merged")&&obj.records[f][r]==obj.records[c][r])continue;c=f;break}return c},obj.down=function(r,c){if(r?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,c?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,c?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var f=obj.whichPage(obj.selectedCell[3]);f!=obj.pageNumber&&obj.page(f)}obj.updateScroll(3)},obj.down.visible=function(r,c){if(r==0)var f=parseInt(obj.selectedCell[0]),p=parseInt(obj.selectedCell[1]);else f=parseInt(obj.selectedCell[2]),p=parseInt(obj.selectedCell[3]);if(c==0){for(var L=obj.rows.length-1;L>p;L--)if(obj.records[L][f].style.display!="none"&&obj.rows[L].style.display!="none"){p=L;break}}else p=obj.down.get(f,p);r==0?(obj.selectedCell[0]=f,obj.selectedCell[1]=p):(obj.selectedCell[2]=f,obj.selectedCell[3]=p)},obj.down.get=function(r,c){r=parseInt(r);for(var f=(c=parseInt(c))+1;f<obj.rows.length;f++)if(obj.records[f][r].style.display!="none"&&obj.rows[f].style.display!="none"){if(obj.records[f][r].getAttribute("data-merged")&&obj.records[f][r]==obj.records[c][r])continue;c=f;break}return c},obj.right=function(r,c){r?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,c?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,c?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(r,c){if(r==0)var f=parseInt(obj.selectedCell[0]),p=parseInt(obj.selectedCell[1]);else f=parseInt(obj.selectedCell[2]),p=parseInt(obj.selectedCell[3]);if(c==0){for(var L=obj.headers.length-1;L>f;L--)if(obj.records[p][L].style.display!="none"){f=L;break}}else f=obj.right.get(f,p);r==0?(obj.selectedCell[0]=f,obj.selectedCell[1]=p):(obj.selectedCell[2]=f,obj.selectedCell[3]=p)},obj.right.get=function(r,c){r=parseInt(r),c=parseInt(c);for(var f=r+1;f<obj.headers.length;f++)if(obj.records[c][f].style.display!="none"){if(obj.records[c][f].getAttribute("data-merged")&&obj.records[c][f]==obj.records[c][r])continue;r=f;break}return r},obj.left=function(r,c){r?obj.selectedCell[2]>0&&obj.left.visible(1,c?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,c?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(r,c){if(r==0)var f=parseInt(obj.selectedCell[0]),p=parseInt(obj.selectedCell[1]);else f=parseInt(obj.selectedCell[2]),p=parseInt(obj.selectedCell[3]);if(c==0){for(var L=0;L<f;L++)if(obj.records[p][L].style.display!="none"){f=L;break}}else f=obj.left.get(f,p);r==0?(obj.selectedCell[0]=f,obj.selectedCell[1]=p):(obj.selectedCell[2]=f,obj.selectedCell[3]=p)},obj.left.get=function(r,c){r=parseInt(r),c=parseInt(c);for(var f=r-1;f>=0;f--)if(obj.records[c][f].style.display!="none"){if(obj.records[c][f].getAttribute("data-merged")&&obj.records[c][f]==obj.records[c][r])continue;r=f;break}return r},obj.first=function(r,c){if(r?c?obj.selectedCell[3]=0:obj.left.visible(1,0):(c?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=0&&obj.selectedCell[3]!=0){if(obj.options.pagination>0){var f=obj.whichPage(obj.selectedCell[3]);f!=obj.pageNumber&&obj.page(f)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(r,c){if(r?c?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(c?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var f=obj.whichPage(obj.selectedCell[3]);f!=obj.pageNumber&&obj.page(f)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(r){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)c=obj.rows;else var c=obj.results;var f=100;r!=null&&r!=-1||(r=Math.ceil(c.length/f)-1);var p=r*f,L=r*f+f;L>c.length&&(L=c.length),(p=L-100)<0&&(p=0);for(var R=p;R<L;R++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[R]):obj.tbody.appendChild(obj.rows[c[R]]),obj.tbody.children.length>f&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)r=obj.rows;else var r=obj.results;var c=0;if(r.length>100){var f=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(f=r.indexOf(f)),f>0)for(var p=0;p<30;p++)(f-=1)>-1&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.insertBefore(obj.rows[f],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[r[f]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),c=1))}return c},obj.loadDown=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)r=obj.rows;else var r=obj.results;var c=0;if(r.length>100){var f=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(f=r.indexOf(f)),f<obj.rows.length-1)for(var p=0;p<=30;p++)f<r.length&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[f]):obj.tbody.appendChild(obj.rows[r[f]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),c=1)),f+=1}return c},obj.loadValidation=function(){if(obj.selectedCell){var r=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,c=parseInt(obj.selectedCell[3]/100),f=parseInt(obj.rows.length/100);if(r!=c&&c<=f&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(c),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(r){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],r){var c=function(p){obj.results.indexOf(p)==-1&&obj.results.push(p)},f=r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");f=new RegExp(f,"i"),obj.options.data.forEach(function(p,L){if(function(h,F,V){for(var m=0;m<h.length;m++)if((""+h[m]).toLowerCase().search(F)>=0||(""+obj.records[V][m].innerHTML).toLowerCase().search(F)>=0)return!0;return!1}(p,f,L)){var R=obj.isRowMerged(L);if(R.length)for(var X=0;X<R.length;X++)for(var j=jexcel.getIdFromColumnName(R[X],!0),d=0;d<obj.options.mergeCells[R[X]][1];d++)c(j[1]+d);else c(L)}})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var r,c=0;for(r=obj.options.lazyLoading==1?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var f=0;f<obj.rows.length;f++)!obj.results||obj.results.indexOf(f)>-1?(c<r&&(obj.tbody.appendChild(obj.rows[f]),c++),obj.rows[f].style.display=""):obj.rows[f].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),r},obj.whichPage=function(r){return obj.options.search!=1&&obj.options.filters!=1||!obj.results||(r=obj.results.indexOf(r)),Math.ceil((parseInt(r)+1)/parseInt(obj.options.pagination))-1},obj.page=function(r){var c=obj.pageNumber;if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)f=obj.rows;else var f=obj.results;var p=parseInt(obj.options.pagination);r!=null&&r!=-1||(r=Math.ceil(f.length/p)-1),obj.pageNumber=r;var L=r*p,R=r*p+p;for(R>f.length&&(R=f.length),L<0&&(L=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var X=L;X<R;X++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[X]):obj.tbody.appendChild(obj.rows[f[X]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,r,c)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)r=obj.rows.length;else var r=obj.results.length;if(r){var c=Math.ceil(r/obj.options.pagination);if(obj.pageNumber<6)var f=1,p=c<10?c:10;else c-obj.pageNumber<5?(p=c,(f=c-9)<1&&(f=1)):(f=obj.pageNumber-4,p=obj.pageNumber+5);f>1&&((R=document.createElement("div")).className="jexcel_page",R.innerHTML="<",R.title=1,obj.pagination.children[1].appendChild(R));for(var L=f;L<=p;L++){var R;(R=document.createElement("div")).className="jexcel_page",R.innerHTML=L,obj.pagination.children[1].appendChild(R),obj.pageNumber==L-1&&R.classList.add("jexcel_page_selected")}p<c&&((R=document.createElement("div")).className="jexcel_page",R.innerHTML=">",R.title=c,obj.pagination.children[1].appendChild(R)),obj.pagination.children[0].innerHTML=function(X){var j=Array.prototype.slice.call(arguments,1);return X.replace(/{(\d+)}/g,function(d,h){return j[h]!==void 0?j[h]:d})}(obj.options.text.showingPage,obj.pageNumber+1,c)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(r){if(obj.options.allowExport==0)console.error("Export not allowed");else{var c="";c+=obj.copy(!1,obj.options.csvDelimiter,!0,r,!0);var f=new Blob(["\uFEFF"+c],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(f,obj.options.csvFileName+".csv");else{var p=document.createElement("a"),L=URL.createObjectURL(f);p.href=L,p.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(p),p.click(),p.parentNode.removeChild(p)}}},obj.setHistory=function(r){if(obj.ignoreHistory!=1){var c=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,c+1),obj.history[c]=r}},obj.copy=function(r,c,f,p,L){c||(c="	");for(var R=new RegExp(c,"ig"),X=[],j=[],d=[],h=[],F=[],V=obj.options.data[0].length,m=obj.options.data.length,l="",v=!1,w="",b="",A=0,T=0,S=0,P=0,_=!0,I=0;I<m;I++)for(var H=0;H<V;H++)r&&!obj.records[I][H].classList.contains("highlight")||(S<=H&&(S=H),P<=I&&(P=I));if(V===S+1&&m===P+1&&(_=!1),L&&obj.options.includeHeadersOnDownload==1||!L&&obj.options.includeHeadersOnCopy==1&&!_||p){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(l=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],I=0;I<l.length;I++){var K=[];for(H=0;H<l[I].length;H++){var U=parseInt(l[I][H].colspan);K.push(l[I][H].title);for(var ue=0;ue<U-1;ue++)K.push("")}b+=K.join(c)+`\r
`}v=!0}for(obj.style=[],I=0;I<m;I++){for(j=[],d=[],H=0;H<V;H++)if(!r||obj.records[I][H].classList.contains("highlight")){v==1&&X.push(obj.headers[H].textContent);var je=obj.options.data[I][H];if(je.match&&(je.match(R)||je.match(/,/g)||je.match(/\n/)||je.match(/\"/))&&(je='"'+(je=je.replace(new RegExp('"',"g"),'""'))+'"'),j.push(je),obj.options.columns[H].type=="checkbox"||obj.options.columns[H].type=="radio")var ce=je;else(ce=obj.options.stripHTMLOnCopy==1?obj.records[I][H].textContent:obj.records[I][H].innerHTML).match&&(ce.match(R)||ce.match(/,/g)||ce.match(/\n/)||ce.match(/\"/))&&(ce='"'+(ce=ce.replace(new RegExp('"',"g"),'""'))+'"');d.push(ce),l=(l=obj.records[I][H].getAttribute("style")).replace("display: none;",""),obj.style.push(l||"")}j.length&&(v&&(A=j.length,h.push(X.join(c))),h.push(j.join(c))),d.length&&(T++,v&&(F.push(X.join(c)),v=!1),F.push(d.join(c)))}V==A&&m==T&&(w=b);var ye=w+h.join(`\r
`),Me=w+F.join(`\r
`);if(f||(obj.options.copyCompatibility==1?obj.textarea.value=Me:obj.textarea.value=ye,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==1?obj.data=Me:obj.data=ye,obj.hashString=obj.hash(obj.data),!f){if(obj.removeCopyingSelection(),obj.highlighted)for(H=0;H<obj.highlighted.length;H++)obj.highlighted[H].classList.add("copying"),obj.highlighted[H].classList.contains("highlight-left")&&obj.highlighted[H].classList.add("copying-left"),obj.highlighted[H].classList.contains("highlight-right")&&obj.highlighted[H].classList.add("copying-right"),obj.highlighted[H].classList.contains("highlight-top")&&obj.highlighted[H].classList.add("copying-top"),obj.highlighted[H].classList.contains("highlight-bottom")&&obj.highlighted[H].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==1?F:h,obj.hashString)}return obj.data},obj.paste=function(r,c,f){var p=obj.dispatch("onbeforepaste",el,f,r,c);if(p===!1)return!1;p&&(f=p);var L=obj.hash(f),R=L==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==1&&L==obj.hashString&&(f=obj.data),f=obj.parseCSV(f,"	"),r!=null&&c!=null&&f){for(var X=0,j=0,d=[],h={},F={},V=0,m=parseInt(r),l=parseInt(c),v=null;v=f[j];){for(X=0,m=parseInt(r);v[X]!=null;){var w=obj.updateCell(m,l,v[X]);if(d.push(w),obj.updateFormulaChain(m,l,d),R&&R[V]){var b=jexcel.getColumnNameFromId([m,l]);h[b]=R[V],F[b]=obj.getStyle(b),obj.records[l][m].setAttribute("style",R[V]),V++}if(v[++X]!=null){if(m>=obj.headers.length-1){if(obj.options.allowInsertColumn!=1)break;obj.insertColumn()}m=obj.right.get(m,l)}}if(f[++j]){if(l>=obj.rows.length-1){if(obj.options.allowInsertRow!=1)break;obj.insertRow()}l=obj.down.get(r,l)}}obj.updateSelectionFromCoords(r,c,m,l),obj.setHistory({action:"setValue",records:d,selection:obj.selectedCell,newStyle:h,oldStyle:F}),obj.updateTable(),obj.dispatch("onpaste",el,f),obj.onafterchanges(el,d)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var r=document.querySelectorAll(".jexcel .copying"),c=0;c<r.length;c++)r[c].classList.remove("copying"),r[c].classList.remove("copying-left"),r[c].classList.remove("copying-right"),r[c].classList.remove("copying-top"),r[c].classList.remove("copying-bottom")},obj.historyProcessRow=function(r,c){var f=c.insertBefore?+c.rowNumber:c.rowNumber+1;if(obj.options.search==1&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),r==1){for(var p=c.numOfRows,L=f;L<p+f;L++)obj.rows[L].parentNode.removeChild(obj.rows[L]);obj.records.splice(f,p),obj.options.data.splice(f,p),obj.rows.splice(f,p),obj.conditionalSelectionUpdate(1,f,p+f-1)}else{obj.records=jexcel.injectArray(obj.records,f,c.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,f,c.rowData),obj.rows=jexcel.injectArray(obj.rows,f,c.rowNode);var R=0;for(L=f;L<c.numOfRows+f;L++)obj.tbody.insertBefore(c.rowNode[R],obj.tbody.children[L]),R++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(r,c){var f=c.insertBefore?c.columnNumber:c.columnNumber+1;if(r==1){var p=c.numOfColumns;obj.options.columns.splice(f,p);for(var L=f;L<p+f;L++)obj.headers[L].parentNode.removeChild(obj.headers[L]),obj.colgroup[L].parentNode.removeChild(obj.colgroup[L]);obj.headers.splice(f,p),obj.colgroup.splice(f,p);for(var R=0;R<c.data.length;R++){for(L=f;L<p+f;L++)obj.records[R][L].parentNode.removeChild(obj.records[R][L]);obj.records[R].splice(f,p),obj.options.data[R].splice(f,p)}if(obj.options.footers)for(R=0;R<obj.options.footers.length;R++)obj.options.footers[R].splice(f,p)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,f,c.columns),obj.headers=jexcel.injectArray(obj.headers,f,c.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,f,c.colgroup);var X=0;for(L=f;L<c.numOfColumns+f;L++)obj.headerContainer.insertBefore(c.headers[X],obj.headerContainer.children[L+1]),obj.colgroupContainer.insertBefore(c.colgroup[X],obj.colgroupContainer.children[L+1]),X++;for(R=0;R<c.data.length;R++)for(obj.options.data[R]=jexcel.injectArray(obj.options.data[R],f,c.data[R]),obj.records[R]=jexcel.injectArray(obj.records[R],f,c.records[R]),X=0,L=f;L<c.numOfColumns+f;L++)obj.rows[R].insertBefore(c.records[R][X],obj.rows[R].children[L+1]),X++;if(obj.options.footers)for(R=0;R<obj.options.footers.length;R++)obj.options.footers[R]=jexcel.injectArray(obj.options.footers[R],f,c.footers[R])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(R=0;R<obj.options.nestedHeaders.length;R++){if(r==1)var j=parseInt(obj.options.nestedHeaders[R][obj.options.nestedHeaders[R].length-1].colspan)-c.numOfColumns;else j=parseInt(obj.options.nestedHeaders[R][obj.options.nestedHeaders[R].length-1].colspan)+c.numOfColumns;obj.options.nestedHeaders[R][obj.options.nestedHeaders[R].length-1].colspan=j,obj.thead.children[R].children[obj.thead.children[R].children.length-1].setAttribute("colspan",j)}else j=r==1?parseInt(obj.options.nestedHeaders[0].colspan)-c.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+c.numOfColumns,obj.options.nestedHeaders[0].colspan=j,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",j);obj.updateTableReferences()},obj.undo=function(){var r=!!obj.ignoreEvents,c=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var f=[];if(obj.historyIndex>=0){var p=obj.history[obj.historyIndex--];if(p.action=="insertRow")obj.historyProcessRow(1,p);else if(p.action=="deleteRow")obj.historyProcessRow(0,p);else if(p.action=="insertColumn")obj.historyProcessColumn(1,p);else if(p.action=="deleteColumn")obj.historyProcessColumn(0,p);else if(p.action=="moveRow")obj.moveRow(p.newValue,p.oldValue);else if(p.action=="moveColumn")obj.moveColumn(p.newValue,p.oldValue);else if(p.action=="setMerge")obj.removeMerge(p.column,p.data);else if(p.action=="setStyle")obj.setStyle(p.oldValue,null,null,1);else if(p.action=="setWidth")obj.setWidth(p.column,p.oldValue);else if(p.action=="setHeight")obj.setHeight(p.row,p.oldValue);else if(p.action=="setHeader")obj.setHeader(p.column,p.oldValue);else if(p.action=="setComments")obj.setComments(p.column,p.oldValue[0],p.oldValue[1]);else if(p.action=="orderBy"){for(var L=[],R=0;R<p.rows.length;R++)L[p.rows[R]]=R;obj.updateOrderArrow(p.column,p.order?0:1),obj.updateOrder(L)}else if(p.action=="setValue"){for(var X=0;X<p.records.length;X++)f.push({x:p.records[X].x,y:p.records[X].y,newValue:p.records[X].oldValue}),p.oldStyle&&obj.resetStyle(p.oldStyle);obj.setValue(f),p.selection&&obj.updateSelectionFromCoords(p.selection[0],p.selection[1],p.selection[2],p.selection[3])}}obj.ignoreEvents=r,obj.ignoreHistory=c,obj.dispatch("onundo",el,p)},obj.redo=function(){var r=!!obj.ignoreEvents,c=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var f=obj.history[++obj.historyIndex];if(f.action=="insertRow")obj.historyProcessRow(0,f);else if(f.action=="deleteRow")obj.historyProcessRow(1,f);else if(f.action=="insertColumn")obj.historyProcessColumn(0,f);else if(f.action=="deleteColumn")obj.historyProcessColumn(1,f);else if(f.action=="moveRow")obj.moveRow(f.oldValue,f.newValue);else if(f.action=="moveColumn")obj.moveColumn(f.oldValue,f.newValue);else if(f.action=="setMerge")obj.setMerge(f.column,f.colspan,f.rowspan,1);else if(f.action=="setStyle")obj.setStyle(f.newValue,null,null,1);else if(f.action=="setWidth")obj.setWidth(f.column,f.newValue);else if(f.action=="setHeight")obj.setHeight(f.row,f.newValue);else if(f.action=="setHeader")obj.setHeader(f.column,f.newValue);else if(f.action=="setComments")obj.setComments(f.column,f.newValue[0],f.newValue[1]);else if(f.action=="orderBy")obj.updateOrderArrow(f.column,f.order),obj.updateOrder(f.rows);else if(f.action=="setValue"){obj.setValue(f.records);for(var p=0;p<f.records.length;p++)f.oldStyle&&obj.resetStyle(f.newStyle);f.selection&&obj.updateSelectionFromCoords(f.selection[0],f.selection[1],f.selection[2],f.selection[3])}}obj.ignoreEvents=r,obj.ignoreHistory=c,obj.dispatch("onredo",el,f)},obj.getDropDownValue=function(r,c){var f=[];if(obj.options.columns[r]&&obj.options.columns[r].source){for(var p=[],L=obj.options.columns[r].source,R=0;R<L.length;R++)typeof L[R]=="object"?p[L[R].id]=L[R].name:p[L[R]]=L[R];var X=Array.isArray(c)?c:(""+c).split(";");for(R=0;R<X.length;R++)typeof X[R]=="object"?f.push(p[X[R].id]):p[X[R]]&&f.push(p[X[R]])}else console.error("Invalid column");return f.length>0?f.join("; "):""},obj.parseCSV=function(r,c){(r=r.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(r.length-1)==9&&(r+="\0"),c=c||",";for(var f=[],p=!1,L=0,R=0,X=0;X<r.length;X++){var j=r[X],d=r[X+1];f[L]=f[L]||[],f[L][R]=f[L][R]||"",j=='"'&&p&&d=='"'?(f[L][R]+=j,++X):j!='"'?j!=c||p?j!="\r"||d!=`
`||p?j==`
`&&!p||j=="\r"&&!p?(++L,R=0):f[L][R]+=j:(++L,R=0,++X):++R:p=!p}return f},obj.hash=function(r){var c,f=0;if(r.length===0)return f;for(c=0;c<r.length;c++)f=(f<<5)-f+r.charCodeAt(c),f|=0;return f},obj.onafterchanges=function(r,c){obj.dispatch("onafterchanges",r,c)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(r){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(r){var c=obj.parseCSV(r,obj.options.csvDelimiter);if(obj.options.csvHeaders==1&&c.length>0)for(var f=c.shift(),p=0;p<f.length;p++)obj.options.columns[p]||(obj.options.columns[p]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),obj.options.columns[p].title===void 0&&(obj.options.columns[p].title=f[p]);obj.options.data=c,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(r){obj.options.data=r.data?r.data:r,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(r,c,f,p){var L=[];if(f==null)obj.options.allowInsertColumn==1&&L.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(c),1)}}),obj.options.allowInsertColumn==1&&L.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(c),0)}}),obj.options.allowDeleteColumn==1&&L.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(c))}}),obj.options.allowRenameColumn==1&&L.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(c)}}),obj.options.columnSorting==1&&(L.push({type:"line"}),L.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(c,0)}}),L.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(c,1)}}));else if(obj.options.allowInsertRow==1&&(L.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(f),1)}}),L.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(f))}})),obj.options.allowDeleteRow==1&&L.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(f))}}),c&&obj.options.allowComments==1){L.push({type:"line"});var R=obj.records[f][c].getAttribute("title")||"";L.push({title:R?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var X=prompt(obj.options.text.comments,R);X&&obj.setComments([c,f],X)}}),R&&L.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([c,f],"")}})}return L.push({type:"line"}),L.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&L.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(X){X&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],X)})}}),obj.options.allowExport&&L.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&L.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),L},obj.scrollControls=function(r){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),obj.options.lazyLoading!=1&&obj.options.tableOverflow!=1||obj.edition&&r.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(r){obj.options.lazyLoading==1&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var r=0;if(obj.options.freezeColumns>0)for(var c=0;c<obj.options.freezeColumns;c++)r+=parseInt(obj.options.columns[c].width);return r};var scrollLeft=0;return obj.updateFreezePosition=function(){var r=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var c=0;c<obj.options.freezeColumns;c++){c>0&&obj.options.columns[c-1].type!=="hidden"&&(r+=parseInt(obj.options.columns[c-1].width)),obj.headers[c].classList.add("jexcel_freezed"),obj.headers[c].style.left=r+"px";for(var f=0;f<obj.rows.length;f++)if(obj.rows[f]&&obj.records[f][c]){var p=scrollLeft+(c>0?obj.records[f][c-1].style.width:0)-51+"px";obj.records[f][c].classList.add("jexcel_freezed"),obj.records[f][c].style.left=p}}else for(c=0;c<obj.options.freezeColumns;c++)for(obj.headers[c].classList.remove("jexcel_freezed"),obj.headers[c].style.left="",f=0;f<obj.rows.length;f++)obj.records[f][c]&&(obj.records[f][c].classList.remove("jexcel_freezed"),obj.records[f][c].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(r){jSuites.setDictionary(r)},jexcel.setExtensions=function(r){for(var c=Object.keys(r),f=0;f<c.length;f++)typeof r[c[f]]=="function"&&(jexcel[c[f]]=r[c[f]],jexcel.license&&typeof r[c[f]].license=="function"&&r[c[f]].license(jexcel.license))},formula!==void 0&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(r){r.removeEventListener("mouseup",jexcel.mouseUpControls),r.removeEventListener("mousedown",jexcel.mouseDownControls),r.removeEventListener("mousemove",jexcel.mouseMoveControls),r.removeEventListener("mouseover",jexcel.mouseOverControls),r.removeEventListener("dblclick",jexcel.doubleClickControls),r.removeEventListener("paste",jexcel.pasteControls),r.removeEventListener("contextmenu",jexcel.contextMenuControls),r.removeEventListener("touchstart",jexcel.touchStartControls),r.removeEventListener("touchend",jexcel.touchEndControls),r.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component;return jexcel.destroy=function(r,c){if(r.jexcel){var f=r.jexcel.options.root?r.jexcel.options.root:document;r.removeEventListener("DOMMouseScroll",r.jexcel.scrollControls),r.removeEventListener("mousewheel",r.jexcel.scrollControls),r.jexcel=null,r.innerHTML="",c&&(destroyEvents(f),jexcel=null)}},jexcel.build=function(r){destroyEvents(r),r.addEventListener("mouseup",jexcel.mouseUpControls),r.addEventListener("mousedown",jexcel.mouseDownControls),r.addEventListener("mousemove",jexcel.mouseMoveControls),r.addEventListener("mouseover",jexcel.mouseOverControls),r.addEventListener("dblclick",jexcel.doubleClickControls),r.addEventListener("paste",jexcel.pasteControls),r.addEventListener("contextmenu",jexcel.contextMenuControls),r.addEventListener("touchstart",jexcel.touchStartControls),r.addEventListener("touchend",jexcel.touchEndControls),r.addEventListener("touchcancel",jexcel.touchEndControls),r.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(r){if(jexcel.current){if(jexcel.current.edition){if(r.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),r.preventDefault();else if(r.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==1||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==1||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&r.altKey){var c=jexcel.current.edition[0].children[0],f=jexcel.current.edition[0].children[0].value,p=c.selectionStart;f=f.slice(0,p)+`
`+f.slice(p),c.value=f,c.focus(),c.selectionStart=p+1,c.selectionEnd=p+1}else jexcel.current.edition[0].children[0].blur()}}if(!jexcel.current.edition&&jexcel.current.selectedCell)if(r.which==36)jexcel.current.first(r.shiftKey,r.ctrlKey),r.preventDefault();else if(r.which==35)jexcel.current.last(r.shiftKey,r.ctrlKey),r.preventDefault();else if(r.which==46)jexcel.current.options.editable==1&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(r.which==13)r.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==1&&jexcel.current.options.allowManualInsertRow==1&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),r.preventDefault();else if(!r.ctrlKey&&!r.metaKey||r.shiftKey){if(jexcel.current.selectedCell&&jexcel.current.options.editable==1){var L=jexcel.current.selectedCell[1],R=jexcel.current.selectedCell[0];jexcel.current.options.columns[R].type!="readonly"&&(r.keyCode==32?(r.preventDefault(),jexcel.current.options.columns[R].type=="checkbox"||jexcel.current.options.columns[R].type=="radio"?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[L][R],!0)):r.keyCode==113?jexcel.current.openEditor(jexcel.current.records[L][R],!1):(r.keyCode==8||r.keyCode>=48&&r.keyCode<=57||r.keyCode>=96&&r.keyCode<=111||r.keyCode>=187&&r.keyCode<=190||(String.fromCharCode(r.keyCode)==r.key||String.fromCharCode(r.keyCode).toLowerCase()==r.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(r.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[L][R],!0),jexcel.current.options.columns[R].type=="calendar"&&r.preventDefault()))}}else r.which==65?(jexcel.current.selectAll(),r.preventDefault()):r.which==83?(jexcel.current.download(),r.preventDefault()):r.which==89?(jexcel.current.redo(),r.preventDefault()):r.which==90?(jexcel.current.undo(),r.preventDefault()):r.which==67?(jexcel.current.copy(!0),r.preventDefault()):r.which==88?(jexcel.current.options.editable==1?jexcel.cutControls():jexcel.copyControls(),r.preventDefault()):r.which==86&&jexcel.pasteControls();else r.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(r.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(r){if((r=r||window.event).buttons)var c=r.buttons;else c=r.button?r.button:r.which;var f=jexcel.getElement(r.target);if(f[0]?jexcel.current!=f[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=f[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&c==1){if(r.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(r.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==1&&(jexcel.current.selectedCorner=!0);else{if(f[1]==1){if(l=r.target.getAttribute("data-x")){var p=r.target.getBoundingClientRect();if(jexcel.current.options.columnResize==1&&p.width-r.offsetX<6){jexcel.current.resizing={mousePosition:r.pageX,column:l,width:p.width},jexcel.current.headers[l].classList.add("resizing");for(var L=0;L<jexcel.current.records.length;L++)jexcel.current.records[L][l]&&jexcel.current.records[L][l].classList.add("resizing")}else if(jexcel.current.options.columnDrag==1&&p.height-r.offsetY<6)if(jexcel.current.isColMerged(l).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:r.target,column:l,destination:l},jexcel.current.headers[l].classList.add("dragging"),L=0;L<jexcel.current.records.length;L++)jexcel.current.records[L][l]&&jexcel.current.records[L][l].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(r.shiftKey||r.ctrlKey))var R=jexcel.current.selectedHeader,X=l;else jexcel.current.selectedHeader==l&&jexcel.current.options.allowRenameColumn==1&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(l)},800)),jexcel.current.selectedHeader=l,R=l,X=l;jexcel.current.updateSelectionFromCoords(R,0,X,jexcel.current.options.data.length-1)}}else if(r.target.parentNode.classList.contains("jexcel_nested")){if(r.target.getAttribute("data-column"))var j=r.target.getAttribute("data-column").split(","),d=parseInt(j[0]),h=parseInt(j[j.length-1]);else d=0,h=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(d,0,h,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(f[1]==2){var F=r.target.getAttribute("data-y");if(r.target.classList.contains("jexcel_row"))p=r.target.getBoundingClientRect(),jexcel.current.options.rowResize==1&&p.height-r.offsetY<6?(jexcel.current.resizing={element:r.target.parentNode,mousePosition:r.pageY,row:F,height:p.height},r.target.parentNode.classList.add("resizing")):jexcel.current.options.rowDrag==1&&p.width-r.offsetX<6?jexcel.current.isRowMerged(F).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==1&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:r.target.parentNode,row:F,destination:F},r.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(r.shiftKey||r.ctrlKey)?(R=jexcel.current.selectedRow,X=F):(jexcel.current.selectedRow=F,R=F,X=F),jexcel.current.updateSelectionFromCoords(0,R,jexcel.current.options.data[0].length-1,X));else if(r.target.classList.contains("jclose")&&r.target.clientWidth-r.offsetX<50&&r.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var V=function(v){var w=v.getAttribute("data-x"),b=v.getAttribute("data-y");return w&&b?[w,b]:v.parentNode?V(v.parentNode):void 0},m=V(r.target);if(m){var l=m[0];F=m[1],jexcel.current.edition&&(jexcel.current.edition[2]==l&&jexcel.current.edition[3]==F||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(r.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],l,F):jexcel.current.updateSelectionFromCoords(l,F)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;r.target.classList.contains("jexcel_page")&&(r.target.textContent=="<"?jexcel.current.page(0):r.target.textContent==">"?jexcel.current.page(r.target.getAttribute("title")-1):jexcel.current.page(r.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(r){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var c=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),f=jexcel.current.getSelectedColumns();if(f.length>1){for(var p=[],L=0;L<f.length;L++)p.push(parseInt(jexcel.current.colgroup[f[L]].getAttribute("width")));p[f.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(f,c,p)}else jexcel.current.setWidth(jexcel.current.resizing.column,c,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var R=0;R<jexcel.current.records.length;R++)jexcel.current.records[R][jexcel.current.resizing.column]&&jexcel.current.records[R][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var X=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,X,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var j=r.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),R=0;R<jexcel.current.rows.length;R++)jexcel.current.records[R][jexcel.current.dragging.column]&&jexcel.current.records[R][jexcel.current.dragging.column].classList.remove("dragging");for(L=0;L<jexcel.current.headers.length;L++)jexcel.current.headers[L].classList.remove("dragging-left"),jexcel.current.headers[L].classList.remove("dragging-right");j&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var d=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<d&&(d-=1)}else d=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,d,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(r){if((r=r||window.event).buttons)var c=r.buttons;else c=r.button?r.button:r.which;if(c||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==1){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var f=r.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+f>0){var p=jexcel.current.resizing.width+f;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",p),jexcel.current.updateCornerPosition()}}else{var L=r.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+L>0){var R=jexcel.current.resizing.height+L;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",R),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var X=r.target.getAttribute("data-x");if(X)if(jexcel.current.isColMerged(X).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var j=0;j<jexcel.current.headers.length;j++)jexcel.current.headers[j].classList.remove("dragging-left"),jexcel.current.headers[j].classList.remove("dragging-right");jexcel.current.dragging.column==X?jexcel.current.dragging.destination=parseInt(X):r.target.clientWidth/2>r.offsetX?(jexcel.current.dragging.column<X?jexcel.current.dragging.destination=parseInt(X)-1:jexcel.current.dragging.destination=parseInt(X),jexcel.current.headers[X].classList.add("dragging-left")):(jexcel.current.dragging.column<X?jexcel.current.dragging.destination=parseInt(X):jexcel.current.dragging.destination=parseInt(X)+1,jexcel.current.headers[X].classList.add("dragging-right"))}}else{var d=r.target.getAttribute("data-y");if(d)if(jexcel.current.isRowMerged(d).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var h=r.target.clientHeight/2>r.offsetY?r.target.parentNode.nextSibling:r.target.parentNode;jexcel.current.dragging.element!=h&&(r.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,h),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var F=r.target.getAttribute("data-x"),V=r.target.getAttribute("data-y"),m=r.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),r.target.parentNode.parentNode&&r.target.parentNode.parentNode.className&&(r.target.parentNode.parentNode.classList.contains("resizable")&&(r.target&&F&&!V&&m.width-(r.clientX-m.left)<6?(jexcel.current.cursor=r.target,jexcel.current.cursor.style.cursor="col-resize"):r.target&&!F&&V&&m.height-(r.clientY-m.top)<6&&(jexcel.current.cursor=r.target,jexcel.current.cursor.style.cursor="row-resize")),r.target.parentNode.parentNode.classList.contains("draggable")&&(r.target&&!F&&V&&m.width-(r.clientX-m.left)<6||r.target&&F&&!V&&m.height-(r.clientY-m.top)<6)&&(jexcel.current.cursor=r.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(r){if((r=r||window.event).buttons)var c=r.buttons;else c=r.button?r.button:r.which;if(c||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==1){var f=jexcel.getElement(r.target);if(f[0]){if(jexcel.current!=f[0].jexcel&&jexcel.current)return!1;var p=r.target.getAttribute("data-x"),L=r.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(f[1]==1&&jexcel.current.selectedHeader){p=r.target.getAttribute("data-x");var R=jexcel.current.selectedHeader,X=p;jexcel.current.updateSelectionFromCoords(R,0,X,jexcel.current.options.data.length-1)}f[1]==2&&(r.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(R=jexcel.current.selectedRow,X=L,jexcel.current.updateSelectionFromCoords(0,R,jexcel.current.options.data[0].length-1,X)):jexcel.current.edition||p&&L&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(p,L):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],p,L)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(r){if(jexcel.current)if(r.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var c=jexcel.current.highlighted[0].getAttribute("data-x"),f=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,p=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),L=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[f][c],jexcel.current.records[L][p])}}else if(r.target.classList.contains("jexcel_column_filter")){var R=r.target.getAttribute("data-x");jexcel.current.openFilter(R)}else{var X=jexcel.getElement(r.target);if(X[1]==1&&jexcel.current.options.columnSorting==1&&(R=r.target.getAttribute("data-x"))&&jexcel.current.orderBy(R),X[1]==2&&jexcel.current.options.editable==1&&!jexcel.current.edition){var j=function(h){if(h.parentNode){var F=h.getAttribute("data-x"),V=h.getAttribute("data-y");return F&&V?h:j(h.parentNode)}},d=j(r.target);d&&d.classList.contains("highlight")&&jexcel.current.openEditor(d)}}},jexcel.copyControls=function(r){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(r){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==1&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(r){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==1&&(r&&r.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],r.clipboardData.getData("text")),r.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(r){if("buttons"in(r=r||window.event)?r.buttons:r.which||r.button,jexcel.current){if(jexcel.current.edition)r.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var c=r.target.getAttribute("data-x"),f=r.target.getAttribute("data-y");if(c||f){(c<parseInt(jexcel.current.selectedCell[0])||c>parseInt(jexcel.current.selectedCell[2])||f<parseInt(jexcel.current.selectedCell[1])||f>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(c,f,c,f);var p=jexcel.current.options.contextMenu(jexcel.current,c,f,r);jexcel.current.contextMenu.contextmenu.open(r,p),r.preventDefault()}}}},jexcel.touchStartControls=function(r){var c=jexcel.getElement(r.target);if(c[0]?jexcel.current!=c[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=c[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var f=r.target.getAttribute("data-x"),p=r.target.getAttribute("data-y");f&&p&&(jexcel.current.updateSelectionFromCoords(f,p),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[f].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=r.target,jexcel.current.openEditor(r.target,!1,r)},500))}},jexcel.touchEndControls=function(r){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(r,c){var f=[];if(r.classList.contains("jexcel_tabs"))L=r.children[0],R=r.children[1];else{r.innerHTML="",r.classList.add("jexcel_tabs"),r.jexcel=[];var p=document.createElement("div"),L=r.appendChild(p),R=(p=document.createElement("div"),r.appendChild(p))}for(var X=[],j=[],d=0;d<c.length;d++){X[d]=document.createElement("div"),X[d].classList.add("jexcel_tab");var h=jexcel(X[d],c[d]);R.appendChild(X[d]),f[d]=r.jexcel.push(h),j[d]=document.createElement("div"),j[d].classList.add("jexcel_tab_link"),j[d].setAttribute("data-spreadsheet",r.jexcel.length-1),j[d].innerHTML=c[d].sheetName,j[d].onclick=function(){for(var V=0;V<L.children.length;V++)L.children[V].classList.remove("selected"),R.children[V].style.display="none";var m=this.getAttribute("data-spreadsheet");R.children[m].style.display="block",L.children[m].classList.add("selected")},L.appendChild(j[d])}for(var F=0;F<L.children.length;F++)L.children[F].classList.remove("selected"),R.children[F].style.display="none";return L.children[L.children.length-1].classList.add("selected"),R.children[L.children.length-1].style.display="block",f},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(r,c){var f,p=function(L){var R=[];return L.SheetNames.forEach(function(X){var j={rows:[],columns:[],data:[],style:{}};if(j.sheetName=X,(b=L.Sheets[X]["!cols"])&&b.length)for(var d=0;d<b.length;d++)j.columns[d]={},b[d]&&b[d].wpx&&(j.columns[d].width=b[d].wpx+"px");if((b=L.Sheets[X]["!rows"])&&b.length)for(d=0;d<b.length;d++)b[d]&&b[d].hpx&&(j.rows[d]={},j.rows[d].height=b[d].hpx+"px");if((b=L.Sheets[X]["!merges"])&&b.length>0)for(j.mergeCells=[],d=0;d<b.length;d++){var h=b[d].s.c,F=b[d].s.r,V=b[d].e.c,m=b[d].e.r,l=jexcel.getColumnNameFromId([h,F]);j.mergeCells[l]=[V-h+1,m-F+1]}var v=0,w=0,b=Object.keys(L.Sheets[X]);for(d=0;d<b.length;d++)if(b[d].substr(0,1)!="!"){var A=L.Sheets[X][b[d]],T=jexcel.getIdFromColumnName(b[d],!0);j.data[T[1]]||(j.data[T[1]]=[]),j.data[T[1]][T[0]]=A.f?"="+A.f:A.w,v<T[0]&&(v=T[0]),w<T[1]&&(w=T[1]),A.style&&Object.keys(A.style).length>0&&(j.style[b[d]]=A.style),A.s&&A.s.fgColor&&(j.style[b[d]]&&(j.style[b[d]]+=";"),j.style[b[d]]+="background-color:#"+A.s.fgColor.rgb)}for(var S=j.columns,P=0;P<=w;P++)for(d=0;d<=v;d++)j.data[P]||(j.data[P]=[]),j.data[P][d]||S<d&&(j.data[P][d]="");R.push(j)}),R};(f=new XMLHttpRequest).open("GET",r,!0),typeof Uint8Array<"u"?(f.responseType="arraybuffer",f.onload=function(L){var R=f.response,X=new Uint8Array(R),j=XLSX.read(X,{type:"array",cellFormula:!0,cellStyles:!0});c(p(j))}):(f.setRequestHeader("Accept-Charset","x-user-defined"),f.onreadystatechange=function(){if(f.readyState==4&&f.status==200){var L=convertResponseBodyToText(f.responseBody),R=XLSX.read(L,{type:"binary",cellFormula:!0,cellStyles:!0});c(p(R))}}),f.send()},jexcel.validLetter=function(r){return r.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(r,c,f){return r.slice(0,c).concat(f).concat(r.slice(c))},jexcel.getColumnName=function(r){var c="";return r>701?(c+=String.fromCharCode(64+parseInt(r/676)),c+=String.fromCharCode(64+parseInt(r%676/26))):r>25&&(c+=String.fromCharCode(64+parseInt(r/26))),c+String.fromCharCode(65+r%26)},jexcel.getIdFromColumnName=function(r,c){var f=/^[a-zA-Z]+/.exec(r);if(f){for(var p=0,L=0;L<f[0].length;L++)p+=parseInt(f[0].charCodeAt(L)-64)*Math.pow(26,f[0].length-1-L);--p<0&&(p=0);var R=parseInt(/[0-9]+$/.exec(r));R>0&&R--,r=c==1?[p,R]:p+"-"+R}return r},jexcel.getColumnNameFromId=function(r){return Array.isArray(r)||(r=r.split("-")),jexcel.getColumnName(parseInt(r[0]))+(parseInt(r[1])+1)},jexcel.getElement=function(r){var c=0,f=0;return function p(L){L.className&&L.classList.contains("jexcel_container")&&(f=L),L.tagName=="THEAD"?c=1:L.tagName=="TBODY"&&(c=2),L.parentNode&&(f||p(L.parentNode))}(r),[f,c]},jexcel.doubleDigitFormat=function(r){return(r=""+r).length==1&&(r="0"+r),r},jexcel.createFromTable=function(r,c){if(r.tagName=="TABLE"){c||(c={}),c.columns=[],c.data=[];var f=r.querySelectorAll("colgroup > col");if(f.length)for(var p=0;p<f.length;p++){if(!(L=f[p].style.width))var L=f[p].getAttribute("width");L&&(c.columns[p]||(c.columns[p]={}),c.columns[p].width=L)}var R=function(ye){var Me=ye.getBoundingClientRect(),xe=Me.width>50?Me.width:50;c.columns[p]||(c.columns[p]={}),ye.getAttribute("data-celltype")?c.columns[p].type=ye.getAttribute("data-celltype"):c.columns[p].type="text",c.columns[p].width=xe+"px",c.columns[p].title=ye.innerHTML,c.columns[p].align=ye.style.textAlign||"center",(Me=ye.getAttribute("name"))&&(c.columns[p].name=Me),(Me=ye.getAttribute("id"))&&(c.columns[p].id=Me),(Me=ye.getAttribute("data-mask"))&&(c.columns[p].mask=Me)},X=[],j=r.querySelectorAll(":scope > thead > tr");if(j.length){for(var d=0;d<j.length-1;d++){var h=[];for(p=0;p<j[d].children.length;p++){var F={title:j[d].children[p].textContent,colspan:j[d].children[p].getAttribute("colspan")||1};h.push(F)}X.push(h)}for(j=j[j.length-1].children,p=0;p<j.length;p++)R(j[p])}var V=0,m={},l={},v={},w={},b=r.querySelectorAll(":scope > tr, :scope > tbody > tr");for(d=0;d<b.length;d++)if(c.data[V]=[],c.parseTableFirstRowAsHeader!=1||j.length||d!=0){for(p=0;p<b[d].children.length;p++){if(A=b[d].children[p].getAttribute("data-formula"))A.substr(0,1)!="="&&(A="="+A);else var A=b[d].children[p].innerHTML;c.data[V].push(A);var T=jexcel.getColumnNameFromId([p,d]),S=b[d].children[p].getAttribute("class");S&&(w[T]=S);var P=parseInt(b[d].children[p].getAttribute("colspan"))||0,_=parseInt(b[d].children[p].getAttribute("rowspan"))||0;(P||_)&&(m[T]=[P||1,_||1]),b[d].children[p].style&&b[d].children[p].style.display=="none"&&(b[d].children[p].style.display="");var I=b[d].children[p].getAttribute("style");I&&(v[T]=I),b[d].children[p].classList.contains("styleBold")&&(v[T]?v[T]+="; font-weight:bold;":v[T]="font-weight:bold;")}b[d].style&&b[d].style.height&&(l[d]={height:b[d].style.height}),V++}else for(p=0;p<b[d].children.length;p++)R(b[d].children[p]);if(Object.keys(X).length>0&&(c.nestedHeaders=X),Object.keys(v).length>0&&(c.style=v),Object.keys(m).length>0&&(c.mergeCells=m),Object.keys(l).length>0&&(c.rows=l),Object.keys(w).length>0&&(c.classes=w),(b=r.querySelectorAll("tfoot tr")).length){var H=[];for(d=0;d<b.length;d++){var K=[];for(p=0;p<b[d].children.length;p++)K.push(b[d].children[p].textContent);H.push(K)}Object.keys(H).length>0&&(c.footers=H)}if(c.parseTableAutoCellType==1){var U=[];for(p=0;p<c.columns.length;p++){var ue=!0,je=!0;for(U[p]=[],d=0;d<c.data.length;d++)A=c.data[d][p],U[p][A]||(U[p][A]=0),U[p][A]++,A.length>25&&(ue=!1),A.length==10&&A.substr(4,1)=="-"&&A.substr(7,1)=="-"||(je=!1);var ce=Object.keys(U[p]).length;je?c.columns[p].type="calendar":ue==1&&ce>1&&ce<=parseInt(.1*c.data.length)&&(c.columns[p].type="dropdown",c.columns[p].source=Object.keys(U[p]))}}return c}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(r){if(this.config.root)var c=this.config.root;else c=window;var f=0,p=c.getSelection();if(p&&p.rangeCount!==0){var L=p.getRangeAt(0),R=L.cloneRange();R.selectNodeContents(r),R.setEnd(L.endContainer,L.endOffset),f=R.toString().length}return f},invert:function(r){for(var c=[],f=Object.keys(r),p=0;p<f.length;p++)c[r[f[p]]]=f[p];return c},getColumnName:function(r){var c="";return r>701?(c+=String.fromCharCode(64+parseInt(r/676)),c+=String.fromCharCode(64+parseInt(r%676/26))):r>25&&(c+=String.fromCharCode(64+parseInt(r/26))),c+String.fromCharCode(65+r%26)},getColumnNameFromCoords:function(r,c){return component.getColumnName(parseInt(r))+(parseInt(c)+1)},getCoordsFromColumnName:function(r){var c=/^[a-zA-Z]+/.exec(r);if(c){for(var f=0,p=0;p<c[0].length;p++)f+=parseInt(c[0].charCodeAt(p)-64)*Math.pow(26,c[0].length-1-p);--f<0&&(f=0);var L=parseInt(/[0-9]+$/.exec(r))||null;return L>0&&L--,[f,L]}},createFromTable:function(){},injectArray:function(r,c,f){return r.slice(0,c).concat(f).concat(r.slice(c))},parseCSV:function(r,c){c=c||",";for(var f=0,p=0,L=[[]],R=0,X=null,j=!1,d=!1,h=0;h<r.length;h++)if(L[p]||(L[p]=[]),L[p][f]||(L[p][f]=""),r[h]!="\r")if(r[h]!=`
`&&r[h]!=c||j!=0&&d!=1&&X){if(r[h]=='"'&&(j=!j),X===null){if((X=j)==1)continue}else if(X===!0&&!d&&r[h]=='"'){r[h+1]=='"'?(j=!0,L[p][f]+=r[h],h++):d=!0;continue}L[p][f]+=r[h]}else{if(X=null,j=!1,d=!1,L[p][f][0]=='"'){var F=L[p][f].trim();F[F.length-1]=='"'&&(L[p][f]=F.substr(1,F.length-2))}r[h]==`
`?(f=0,p++):++f>R&&(R=f)}for(var V=0;V<L.length;V++)for(h=0;h<=R;h++)L[V][h]===void 0&&(L[V][h]="");return L}},component),typeof jQuery<"u"&&function(r){r.fn.jspreadsheet=r.fn.jexcel=function(c){var f=r(this).get(0);return f.jexcel?Array.isArray(f.jexcel)?f.jexcel[c][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):f.jexcel[c].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(r(this).get(0),arguments[0])}}(jQuery),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __webpack_require__(r){var c=__webpack_module_cache__[r];if(c!==void 0)return c.exports;var f=__webpack_module_cache__[r]={exports:{}};return __webpack_modules__[r].call(f.exports,f,f.exports,__webpack_require__),f.exports}var __webpack_exports__=__webpack_require__(138);return __webpack_exports__}()})}(dist)),dist.exports}var distExports=requireDist();const JSpreadsheet=getDefaultExportFromCjs(distExports),style=i`
:host {
   overflow: hidden;
   display: block;
 }
  :root {
    --jexcel-border-color: #000;
  }
  .jexcel_container {
   box-sizing: border-box;
   display: inline-block;
   width: 100%;
   overscroll-behavior: contain;
   padding-right: 0.125rem;
    outline: none;
}
  .jexcel_container.fullscreen {
   position: fixed;
   left: 0px;
   top: 0px;
   z-index: 21;
   height: 100%;
   width: 100%;
}
  .jexcel_container.fullscreen .jexcel_content {
   height: 100%;
   width: 100%;
   overflow: auto;
   --tw-bg-opacity: 1;
   background-color: rgb(255 255 255 / var(--tw-bg-opacity));
}
  .jexcel_container.with-toolbar .jexcel > thead > tr > td {
   top: 42px;
}
  .jexcel_container.fullscreen.with-toolbar {
   height: calc(100% - 46px);
}
  .jexcel_content {
   position: relative;
   margin-left: 0px;
   margin-right: 0px;
   box-sizing: border-box;
   display: inline-block;
   height: auto;
   max-height: 580px;
   min-height: 200px;
   width: 100%;
   overflow: scroll;
   padding-bottom: 3px;
}
  @supports (-moz-appearance:none) {
   .jexcel_content {
      padding-right: 0.625rem;
   }
}
  .jexcel_content {
    scrollbar-width: 15px;
    scrollbar-color: #666 transparent;
  }
  .jexcel_content::-webkit-scrollbar {
   height: 15px;
   width: 15px;
}
  .jexcel_content::-webkit-scrollbar-track {
   border-radius: 100px;
    background: #eee;
}
  .jexcel_content::-webkit-scrollbar-thumb {
   border-radius: 100px;
    background: #d3d3d3;
}
  .jexcel {
   height: 100%;
   width: 100%;
   table-layout: fixed;
   --tw-border-spacing-x: 0px;
   --tw-border-spacing-y: 0px;
   border-spacing: var(--tw-border-spacing-x) var(--tw-border-spacing-y);
   white-space: nowrap;
   text-align: center;
   font-size: 0.75rem;
   --tw-shadow: 0px 4px 15px rgba(164,164,164,0.2);
   --tw-shadow-colored: 0px 4px 15px var(--tw-shadow-color);
   box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
}
  .jexcel > thead > tr {
   height: 60px;
   --tw-bg-opacity: 1;
   background-color: rgb(245 245 245 / var(--tw-bg-opacity));
   font-weight: 700;
    color: #333;
}
  .jexcel > thead > tr > td {
   position: sticky;
   top: 0px;
   z-index: 2;
   overflow: hidden;
   text-overflow: ellipsis;
   white-space: nowrap;
   border-left-width: 1px;
   border-right-width: 1px;
   border-style: solid;
   --tw-border-opacity: 1;
   border-left-color: rgb(195 198 207 / var(--tw-border-opacity));
   border-right-color: rgb(195 198 207 / var(--tw-border-opacity));
   --tw-bg-opacity: 1;
   background-color: rgb(245 245 245 / var(--tw-bg-opacity));
   padding-left: 0.5rem;
   padding-right: 0.5rem;
}

.jexcel > thead > tr > td::before {
 content: "";
  position: absolute;
  width: 100%;
  height: 100%;
  border-top: 1px solid #C3C6CF; /*  */
  border-bottom: 1px solid #C3C6CF; /*  */
  top: 0;
  left: 0;
  z-index: -1; /*  */
}
  .jexcel > thead > tr > td.dragging {
   --tw-bg-opacity: 1;
   background-color: rgb(255 255 255 / var(--tw-bg-opacity));
   opacity: 0.5;
}
  .jexcel > thead > tr > td.selected {
   --tw-bg-opacity: 1;
   background-color: rgb(220 220 220 / var(--tw-bg-opacity));
}
  .jexcel > thead > tr > td.arrow-up {
   background-position: center right 5px;
   background-repeat: no-repeat;
   padding-left: 1.5rem;
   padding-right: 1.5rem;
   text-decoration-line: underline;
    background-image: url('https://api.iconify.design/material-symbols/swap-vert.svg');
}
  .jexcel > thead > tr > td.arrow-down {
   background-position: center right 5px;
   background-repeat: no-repeat;
   padding-left: 1.5rem;
   padding-right: 1.5rem;
   text-decoration-line: underline;
    background-image: url('https://api.iconify.design/material-symbols/swap-vert.svg');
}
  .jexcel > thead > tr > td > img {
   position: relative;
   left: 15%;
   display: none;
}
  .jexcel > thead > tr > td.arrow-up > img {
   display: inline-flex;
   --tw-rotate: -180deg;
   transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));
}
  .jexcel > thead > tr > td.arrow-down > img {
   display: inline-flex;
}
  .jexcel > tbody > tr > td:first-child {
   position: relative;
   --tw-bg-opacity: 1;
   background-color: rgb(243 243 243 / var(--tw-bg-opacity));
   text-align: center;
}
  .jexcel > tbody.resizable > tr > td:first-child::before {
   position: absolute;
   left: 0px;
   bottom: 0px;
   height: 3px;
   width: 100%;
   cursor: row-resize;
   --tw-content: '\\00a0';
   content: var(--tw-content);
}
  .jexcel > tbody.draggable > tr > td:first-child::after {
   position: absolute;
   right: 0px;
   top: 0px;
   height: 100%;
   width: 3px;
   cursor: move;
   --tw-content: '\\00a0';
   content: var(--tw-content);
}
  .jexcel > tbody > tr.dragging > td {
   --tw-bg-opacity: 1;
   background-color: rgb(238 238 238 / var(--tw-bg-opacity));
   opacity: 0.5;
}
  .jexcel > tbody > tr {
   height: 50px;
   max-height: 30px;
   width: 100%;
    background: #fff;
}
  .jexcel > tbody > tr:hover {
    background: #eef0fa;
  }
  .jexcel > tbody > tr > td {
   overflow: hidden !important;
   text-overflow: ellipsis !important;
   white-space: nowrap !important;
   border-top-width: 1px;
   border-left-width: 1px;
   border-right-width: 1px;
   border-bottom-width: 1px;
   border-style: solid;
   --tw-border-opacity: 1;
   border-color: rgb(195 198 207 / var(--tw-border-opacity));
   padding: 0.5rem;
}
  .jexcel > tbody > tr > td:last-child {
   overflow: hidden;
}
  .jexcel_overflow > tbody {
   overflow: scroll;
}
  .jexcel_overflow > tbody > tr > td {
   overflow: hidden;
}
  .jexcel > tbody > tr > td > img {
   display: inline-block;
   max-width: 100px;
}
  .jexcel > tbody > tr.selected > td:first-child {
   --tw-bg-opacity: 1;
   background-color: rgb(220 220 220 / var(--tw-bg-opacity));
}
  .jexcel > tbody > tr > td > select,
  .jexcel > tbody > tr > td > input,
  .jexcel > tbody > tr > td > textarea {
   margin: 0px;
   box-sizing: border-box;
   width: 100%;
   border-radius: 0px;
   border-width: 0px;
   background-color: transparent;
   padding: 0px;
   padding-right: 0.125rem;
    outline: 0px;
}
  .jexcel > tbody > tr > td > textarea {
   resize: none;
   padding-top: 0.375rem;
}
  .jexcel > tbody > tr > td > input[type='checkbox'] {
   margin-top: 0.125rem;
   width: 0.75rem;
}
  .jexcel > tbody > tr > td > input[type='radio'] {
   margin-top: 0.125rem;
   width: 0.75rem;
}
  .jexcel > tbody > tr > td > select {
   appearance: none;
   background-image: url(data:image/svg+xml;base64,PHN2ZyBmaWxsPSdibGFjaycgaGVpZ2h0PScyNCcgdmlld0JveD0nMCAwIDI0IDI0JyB3aWR0aD0nMjQnIHhtbG5zPSdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Zyc+PHBhdGggZD0nTTcgMTBsNSA1IDUtNXonLz48cGF0aCBkPSdNMCAwaDI0djI0SDB6JyBmaWxsPSdub25lJy8+PC9zdmc+);
   background-repeat: no-repeat;
    -webkit-appearance: none;
    -moz-appearance: none;
    background-position-x: 100%;
    background-position-y: 40%;
}
  .jexcel > tbody > tr > td.jexcel_dropdown {
   overflow-x: hidden;
   text-overflow: ellipsis;
   background-image: url("data:image/svg+xml,%0A%3Csvg_xmlns='http://www.w3.org/2000/svg'_width='24'_height='24'_viewBox='0_0_24_24'%3E%3Cpath_fill='none'_d='M0_0h24v24H0V0z'/%3E%3Cpath_d='M7_10l5_5_5-5H7z'_fill='lightgray'/%3E%3C/svg%3E");
   background-position: top 50% right 5px;
   background-repeat: no-repeat;
}
  .jexcel > tbody > tr > td.jexcel_dropdown.jexcel_comments {
    background:
      url("data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3Cpath d='M7 10l5 5 5-5H7z' fill='lightgray'/%3E%3C/svg%3E")
        top 50% right 5px no-repeat,
      url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTAxLTMxVDE4OjU1OjA4WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOS0wMS0zMVQxODo1NTowOFoiIHhtcDpNb2RpZnlEYXRlPSIyMDE5LTAxLTMxVDE4OjU1OjA4WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDphMTlhZDJmOC1kMDI2LTI1NDItODhjOS1iZTRkYjkyMmQ0MmQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpkOGI5NDUyMS00ZjEwLWQ5NDktYjUwNC0wZmU1N2I3Nzk1MDEiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDplMzdjYmE1ZS1hYTMwLWNkNDUtYTAyNS1lOWYxZjk2MzUzOGUiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDplMzdjYmE1ZS1hYTMwLWNkNDUtYTAyNS1lOWYxZjk2MzUzOGUiIHN0RXZ0OndoZW49IjIwMTktMDEtMzFUMTg6NTU6MDhaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmExOWFkMmY4LWQwMjYtMjU0Mi04OGM5LWJlNGRiOTIyZDQyZCIgc3RFdnQ6d2hlbj0iMjAxOS0wMS0zMVQxODo1NTowOFoiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4En6MDAAAAX0lEQVQYlX3KOw6AIBBAwS32RpJADXfx0pTET+ERZJ8F8RODFtONsG0QAoh0CSDM82dqodaBdQXnfoLZQM7gPai+wjNNE8R4pTuAYNZSKZASqL7CMy0LxNgJp30fKYUDi3+vIqb/+rUAAAAASUVORK5CYII=')
        top right no-repeat;
  }
  .jexcel > tbody > tr > td > .color {
   margin: auto;
   height: 0.625rem;
   width: 90%;
}
  .jexcel > tbody > tr > td.highlight > a {
   cursor: pointer;
   --tw-text-opacity: 1;
   color: rgb(0 0 255 / var(--tw-text-opacity));
}
  .jexcel > tfoot > tr > td {
   box-sizing: border-box;
   cursor: pointer;
   overflow: hidden;
   border-top-width: 1px;
   border-left-width: 1px;
   border-right-width: 1px;
   border-bottom-width: 1px;
   border-style: solid;
   --tw-border-opacity: 1;
   border-color: rgb(227 226 230 / var(--tw-border-opacity));
   --tw-bg-opacity: 1;
   background-color: rgb(243 243 243 / var(--tw-bg-opacity));
   padding: 0.125rem;
}
  .jexcel .highlight {
   background-color: rgba(0,0,0,0.05);
}
  .jexcel .highlight-selected {
    /* @apply bg-[rgba(0,0,0,0.0)];*/
  }
  .jexcel .selection {
   background-color: rgba(0,0,0,0.05);
}
  .jexcel_corner {
   position: absolute;
   top: -2000px;
   left: -2000px;
   z-index: 30;
   height: 1px;
   width: 1px;
   cursor: crosshair;
   border-width: 1px;
   border-style: solid;
   --tw-border-opacity: 1;
   border-color: rgb(255 255 255 / var(--tw-border-opacity));
   --tw-bg-opacity: 1;
   background-color: rgb(0 0 0 / var(--tw-bg-opacity));
   padding: 0.125rem;
    box-sizing: initial;
}
  .jexcel .editor {
   box-sizing: border-box;
   overflow: visible;
   white-space: nowrap;
   padding: 0px;
   text-align: left;
    outline: 0px solid transparent;
}
  .jexcel .editor > input {
   padding-left: 0.25rem;
}
  .jexcel .editor .jupload {
   position: fixed;
   top: 100%;
   z-index: 40;
   margin-top: 0.125rem;
   min-height: 225px;
   width: 300px;
   -webkit-user-select: none;
      -moz-user-select: none;
           user-select: none;
   border-radius: 0.25rem;
   --tw-bg-opacity: 1;
   background-color: rgb(255 255 255 / var(--tw-bg-opacity));
   padding: 0.625rem;
   font-size: 0.875rem;
   letter-spacing: 0.2px;
   --tw-shadow: 0 8px 10px 1px rgba(0,0,0,0.14),0 3px 14px 2px rgba(0,0,0,0.12),0 5px 5px -3px rgba(0,0,0,0.2);
   --tw-shadow-colored: 0 8px 10px 1px var(--tw-shadow-color), 0 3px 14px 2px var(--tw-shadow-color), 0 5px 5px -3px var(--tw-shadow-color);
   box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
    -webkit-font-smoothing: antialiased;
    -webkit-border-radius: 4px;
    -webkit-box-shadow:
      0 8px 10px 1px rgba(0, 0, 0, 0.14),
      0 3px 14px 2px rgba(0, 0, 0, 0.12),
      0 5px 5px -3px rgba(0, 0, 0, 0.2);
}
  .jexcel .editor .jupload img {
   height: auto;
   width: 100%;
}
  .jexcel .editor .jexcel_richtext {
   position: fixed;
   top: 100%;
   z-index: 40;
   margin-top: 0.125rem;
   min-width: 280px;
   max-width: 310px;
   -webkit-user-select: none;
      -moz-user-select: none;
           user-select: none;
   --tw-bg-opacity: 1;
   background-color: rgb(255 255 255 / var(--tw-bg-opacity));
   padding: 0.625rem;
   text-align: left;
   font-size: 0.875rem;
   letter-spacing: 0.2px;
   --tw-shadow: 0 8px 10px 1px rgba(0,0,0,0.14),0 3px 14px 2px rgba(0,0,0,0.12),0 5px 5px -3px rgba(0,0,0,0.2);
   --tw-shadow-colored: 0 8px 10px 1px var(--tw-shadow-color), 0 3px 14px 2px var(--tw-shadow-color), 0 5px 5px -3px var(--tw-shadow-color);
   box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
    -webkit-font-smoothing: antialiased;
    -webkit-box-shadow:
      0 8px 10px 1px rgba(0, 0, 0, 0.14),
      0 3px 14px 2px rgba(0, 0, 0, 0.12),
      0 5px 5px -3px rgba(0, 0, 0, 0.2);
}
  .jexcel .editor .jclose:after {
   position: absolute;
   right: 0px;
   top: 0px;
   margin: 0.625rem;
   height: 1.5rem;
   width: 1.5rem;
   cursor: pointer;
   font-size: 1.75rem;
   line-height: 1.5rem;
   --tw-content: 'close';
   content: var(--tw-content);
    font-family: 'Material icons';
    text-shadow: 0px 0px 5px #fff;
}
  .jexcel,
  .jexcel td,
  .jexcel_corner {
   user-select: none;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    -webkit-user-drag: none;
    -khtml-user-drag: none;
    -moz-user-drag: none;
    -o-user-drag: none;
    user-drag: none;
}
  .jexcel_textarea {
   position: absolute;
   top: -999px;
   left: -999px;
   height: 1px;
   width: 1px;
}
  .jexcel .dragline {
   position: absolute;
}
  .jexcel .dragline div {
   position: relative;
   top: -0.375rem;
   height: 5px;
   width: 22px;
}
  @media(hover:hover) {
   .jexcel .dragline div:where(:-moz-any-link, :enabled, summary, div):hover {
      cursor: move;
   }
   .jexcel .dragline div:where(:any-link, :enabled, summary, div):hover {
      cursor: move;
   }
}
  .jexcel .onDrag {
   background-color: rgba(0,0,0,0.6);
}
  .jexcel .error {
   border-width: 1px;
   border-style: solid;
   --tw-border-opacity: 1;
   border-color: rgb(255 0 0 / var(--tw-border-opacity));
}
  .jexcel thead td.resizing {
   --tw-border-opacity: 1;
   border-right-color: rgb(255 0 0 / var(--tw-border-opacity));
    border-right-style: dotted !important;
}
  .jexcel tbody tr.resizing > td {
   --tw-border-opacity: 1;
   border-bottom-color: rgb(255 0 0 / var(--tw-border-opacity));
    border-bottom-style: dotted !important;
}
  .jexcel tbody td.resizing {
   --tw-border-opacity: 1;
   border-right-color: rgb(255 0 0 / var(--tw-border-opacity));
    border-right-style: dotted !important;
}
  .jexcel .jdropdown-header {
   height: 100%;
   width: 100%;
   border-width: 0px;
   padding: 0px;
   padding-left: 0.5rem;
    outline: none !important;
}
  .jexcel .jdropdown-container {
   margin-top: 1px;
}
  .jexcel .jdropdown-container-header {
   margin: 0px;
   height: inherit;
   padding: 0px;
}
  .jexcel .jdropdown-picker {
   height: inherit;
   width: inherit;
   border-width: 0px;
   padding: 0px;
}
  .jexcel .jexcel_comments {
   background-position: top right;
   background-repeat: no-repeat;
    background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAYAAADED76LAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTAxLTMxVDE4OjU1OjA4WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAxOS0wMS0zMVQxODo1NTowOFoiIHhtcDpNb2RpZnlEYXRlPSIyMDE5LTAxLTMxVDE4OjU1OjA4WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDphMTlhZDJmOC1kMDI2LTI1NDItODhjOS1iZTRkYjkyMmQ0MmQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpkOGI5NDUyMS00ZjEwLWQ5NDktYjUwNC0wZmU1N2I3Nzk1MDEiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDplMzdjYmE1ZS1hYTMwLWNkNDUtYTAyNS1lOWYxZjk2MzUzOGUiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDplMzdjYmE1ZS1hYTMwLWNkNDUtYTAyNS1lOWYxZjk2MzUzOGUiIHN0RXZ0OndoZW49IjIwMTktMDEtMzFUMTg6NTU6MDhaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmExOWFkMmY4LWQwMjYtMjU0Mi04OGM5LWJlNGRiOTIyZDQyZCIgc3RFdnQ6d2hlbj0iMjAxOS0wMS0zMVQxODo1NTowOFoiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4En6MDAAAAX0lEQVQYlX3KOw6AIBBAwS32RpJADXfx0pTET+ERZJ8F8RODFtONsG0QAoh0CSDM82dqodaBdQXnfoLZQM7gPai+wjNNE8R4pTuAYNZSKZASqL7CMy0LxNgJp30fKYUDi3+vIqb/+rUAAAAASUVORK5CYII=');
}
  .jexcel .sp-replacer {
   margin: 0.125rem;
   border-width: 0px;
}
  .jexcel > thead > tr.jexcel_filter > td > input {
   width: 100%;
   border-width: 0px;
    outline: none;
}
  .jexcel_about {
   float: right;
   display: none;
   padding: 0.125rem;
   font-size: 0.7em;
   text-transform: uppercase;
   letter-spacing: 1px;
}
  .jexcel_about a {
   --tw-text-opacity: 1;
   color: rgb(204 204 204 / var(--tw-text-opacity));
   text-decoration-line: none;
}
  .jexcel_about img {
   display: none;
}
  .jexcel_filter {
   margin-bottom: 0.25rem;
   display: flex;
   justify-content: space-between;
}
  .jexcel_filter > div {
   align-items: center;
   padding: 0.5rem;
}
  .jexcel_pagination {
   display: flex;
   align-items: center;
   justify-content: space-between;
}
  .jexcel_pagination > div {
   display: flex;
   padding: 0.625rem;
}
  .jexcel_pagination > div:last-child {
   padding-right: 0.625rem;
   padding-top: 0.625rem;
}
  .jexcel_pagination > div > div {
   margin-left: 0.125rem;
   box-sizing: border-box;
   height: 2.25rem;
   width: 2.25rem;
   cursor: pointer;
   border-width: 1px;
   border-style: solid;
   --tw-border-opacity: 1;
   border-color: rgb(204 204 204 / var(--tw-border-opacity));
   text-align: center;
   line-height: 34px;
}
  .jexcel_page {
   font-size: 0.8em;
}
  .jexcel_page_selected {
   --tw-bg-opacity: 1;
   background-color: rgb(243 243 243 / var(--tw-bg-opacity));
   font-family: bold;
}
  .jexcel_toolbar {
   position: sticky;
   top: 0px;
   z-index: 21;
   margin-left: 1px;
   margin-right: 0.125rem;
   margin-top: 0px;
   margin-bottom: 0.25rem;
   display: flex;
   border-width: 1px;
   border-style: solid;
   --tw-border-opacity: 1;
   border-color: rgb(204 204 204 / var(--tw-border-opacity));
   --tw-bg-opacity: 1;
   background-color: rgb(243 243 243 / var(--tw-bg-opacity));
   padding: 0.25rem;
}
  .jexcel_toolbar:empty {
   display: none;
}
  .jexcel_toolbar i.jexcel_toolbar_item {
   display: inline-block;
   height: 1.5rem;
   width: 1.5rem;
   cursor: pointer;
   padding: 0.25rem;
}
  @media(hover:hover) {
   .jexcel_toolbar i.jexcel_toolbar_item:where(:-moz-any-link, :enabled, summary, div):hover {
      --tw-bg-opacity: 1;
      background-color: rgb(221 221 221 / var(--tw-bg-opacity));
   }
   .jexcel_toolbar i.jexcel_toolbar_item:where(:any-link, :enabled, summary, div):hover {
      --tw-bg-opacity: 1;
      background-color: rgb(221 221 221 / var(--tw-bg-opacity));
   }
}
  .jexcel_toolbar select.jexcel_toolbar_item {
   margin-left: 0.125rem;
   margin-right: 0.125rem;
   display: inline-block;
   border-width: 0px;
   background-color: transparent;
   padding-right: 0.625rem;
}
  .jexcel .dragging-left {
   background-image: url("data:image/svg+xml,%3Csvg_xmlns='http://www.w3.org/2000/svg'_width='24'_height='24'_viewBox='0_0_24_24'%3E%3Cpath_d='M14_7l-5_5_5_5V7z'/%3E%3Cpath_fill='none'_d='M24_0v24H0V0h24z'/%3E%3C/svg%3E");
   background-position: top 50% left 0px;
   background-repeat: no-repeat;
}
  .jexcel .dragging-right {
   background-image: url("data:image/svg+xml,%3Csvg_xmlns='http://www.w3.org/2000/svg'_width='24'_height='24'_viewBox='0_0_24_24'%3E%3Cpath_d='M10_17l5-5-5-5v10z'/%3E%3Cpath_fill='none'_d='M0_24V0h24v24H0z'/%3E%3C/svg%3E");
   background-position: top 50% right 0px;
   background-repeat: no-repeat;
}
  .jexcel_tabs .jexcel_tab {
   display: none;
}
  .jexcel_tabs .jexcel_tab_link {
   margin-right: 5px;
   margin-bottom: 5px;
   display: inline-block;
   cursor: pointer;
   --tw-bg-opacity: 1;
   background-color: rgb(243 243 243 / var(--tw-bg-opacity));
   padding: 0.625rem;
   padding-left: 1.25rem;
   padding-right: 1.25rem;
}
  .jexcel_tabs .jexcel_tab_link.selected {
   --tw-bg-opacity: 1;
   background-color: rgb(221 221 221 / var(--tw-bg-opacity));
}
  .jexcel_hidden_index > tbody > tr > td:first-child,
  .jexcel_hidden_index > thead > tr > td:first-child,
  .jexcel_hidden_index > tfoot > tr > td:first-child,
  .jexcel_hidden_index > colgroup > col:first-child {
   display: none;
}
  .jexcel .jrating {
   display: inline-flex;
}
  .jexcel .jrating > div {
    zoom: 0.55;
  }
  /* Ctrl + Cdash line  */
  /*.jexcel .copying-top {
    @apply border-t-black border-t border-dashed;
  }
  .jexcel .copying-left {
    @apply border-l-black border-l border-dashed;
  }
  .jexcel .copying-right {
    @apply border-r-black border-r border-dashed;
  }
  .jexcel .copying-bottom {
    @apply border-b-black border-b border-dashed;
  }*/
  .jexcel .jexcel_column_filter {
   overflow: hidden;
   text-overflow: ellipsis;
   background-image: url("data:image/svg+xml,%3Csvg_xmlns='http://www.w3.org/2000/svg'_viewBox='0_0_24_24'_fill='gray'_width='18px'_height='18px'%3E%3Cpath_d='M10_18h4v-2h-4v2zM3_6v2h18V6H3zm3_7h12v-2H6v2z'/%3E%3Cpath_d='M0_0h24v24H0z'_fill='none'/%3E%3C/svg%3E");
   background-position: top 50% right 5px;
   background-repeat: no-repeat;
   padding: 0px;
   padding-left: 0.375rem;
   padding-right: 1.25rem;
}
  .jexcel thead .jexcel_freezed,
  .jexcel tfoot .jexcel_freezed {
   left: 0px;
   z-index: 3;
   --tw-shadow: 2px 0px 2px 0.2px #ccc;
   --tw-shadow-colored: 2px 0px 2px 0.2px var(--tw-shadow-color);
   box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
    -webkit-box-shadow: 2px 0px 2px 0.2px #ccc !important;
    -moz-box-shadow: 2px 0px 2px 0.2px #ccc !important;
}
  .jexcel tbody .jexcel_freezed {
   position: relative;
   --tw-bg-opacity: 1;
   background-color: rgb(255 255 255 / var(--tw-bg-opacity));
   --tw-shadow: 1px 1px 1px 1px #ccc;
   --tw-shadow-colored: 1px 1px 1px 1px var(--tw-shadow-color);
   box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
    -webkit-box-shadow: 2px 4px 4px 0.1px #ccc !important;
    -moz-box-shadow: 2px 4px 4px 0.1px #ccc !important;
}
`;var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__decorateClass=(r,c,f,p)=>{for(var L=p>1?void 0:p?__getOwnPropDesc(c,f):c,R=r.length-1,X;R>=0;R--)(X=r[R])&&(L=(p?X(c,f,L):X(L))||L);return p&&L&&__defProp(c,f,L),L};const maxCount=100,DEFAULT_HEADER_HEIGHT=60;let YgBasicTable=class extends ExtendedLitElement{constructor(){super(style.cssText),this.options={},this.spreadsheetInstance=null,this.isUpdating=!1}async waitForVisible(){return null}onHideIndex(){}setFontSize(r){var c;{const f=(c=this==null?void 0:this.shadowRoot)==null?void 0:c.querySelector(".jexcel");if(f){const p=(()=>{switch(r){case"medium":return"14px";case"large":return"16px";default:return"14px"}})();f.style.fontSize=p}}}async getSpreadsheetInstance(){if(this.isUpdating){let r=0;await new Promise(c=>{const f=setInterval(()=>{if(r>=maxCount)throw new Error("timeout");this.isUpdating?(clearInterval(f),c()):r++},100)})}return this.spreadsheetInstance}connectedCallback(){super.connectedCallback(),this.setupDocumentClickListener()}disconnectedCallback(){super.disconnectedCallback(),this.removeDocumentClickListener()}setupDocumentClickListener(){this.documentClickListener=r=>{const c=r.target,f=this.tagName.toLowerCase();console.log({tagName:f}),console.log({isContains:this==null?void 0:this.contains(c),target:c}),this!=null&&this.contains(c)||this.spreadsheetInstance&&typeof this.spreadsheetInstance.resetSelection=="function"&&this.spreadsheetInstance.resetSelection()},document.addEventListener("click",this.documentClickListener)}removeDocumentClickListener(){this.documentClickListener&&(document.removeEventListener("click",this.documentClickListener),this.documentClickListener=void 0)}updated(r){super.updated(r),r.has("options")&&(this.isUpdating=!0,this.initializeSpreadsheet())}applyCustomOptions(){var c,f,p;const r=(f=(c=this.options)==null?void 0:c.custom)==null?void 0:f.headerHeight;if(r){const L=(p=this==null?void 0:this.shadowRoot)==null?void 0:p.querySelectorAll(".jexcel > thead > tr");L!=null&&L[0]&&L.forEach(R=>{R.style.height=`${r}px`})}}fixedNestedHeader(){var c,f,p,L;if(!((c=this.options.nestedHeaders)!=null&&c[0]))return;const r=(f=this==null?void 0:this.shadowRoot)==null?void 0:f.querySelectorAll(".jexcel > thead > tr");if(r!=null&&r[0]){const R=((L=(p=this.options)==null?void 0:p.custom)==null?void 0:L.headerHeight)||DEFAULT_HEADER_HEIGHT;r.forEach((X,j)=>{X.querySelectorAll("td").forEach((h,F)=>{j!==0&&(h.style.top=`${R*j}px`)})})}}wrapHideIndexMethod(){if(!this.spreadsheetInstance)return;const r=this.spreadsheetInstance.hideIndex;typeof r=="function"&&(this.spreadsheetInstance.hideIndex=()=>{r.call(this.spreadsheetInstance),this.onHideIndex()})}initializeSpreadsheet(){var c;const r=(c=this==null?void 0:this.shadowRoot)==null?void 0:c.getElementById("spreadsheet");r&&(this.spreadsheetInstance&&this.spreadsheetInstance.destroy(),this.spreadsheetInstance=JSpreadsheet(r,{contextMenu:!1,editable:!1,defaultRowHeight:48,...this.options,root:this==null?void 0:this.shadowRoot}),this.wrapHideIndexMethod(),this.applyCustomOptions(),this.fixedNestedHeader())}get updateComplete(){return this.isUpdating=!1,super.updateComplete}render(){var r;return x$1`
      <div
        id="spreadsheet"
        style="${((r=this.options)==null?void 0:r.tableHeight)==="100%"&&"height: 100%; overflow: hidden; scrollbar-width: none; -ms-overflow-style: none;"}"
      >
        ${!this.isUpdating||STORYBOOK?"":x$1`
              <div role="status" class="w-full h-full animate-pulse">
                <div
                  class="h-10 bg-gray-200 rounded dark:bg-gray-700 w-full mb-4"
                ></div>
                <div
                  class="h-10 bg-gray-200 rounded dark:bg-gray-700 w-full mb-4"
                ></div>
                <div
                  class="h-10 bg-gray-200 rounded dark:bg-gray-700 w-full mb-4"
                ></div>
                <div
                  class="h-10 bg-gray-200 rounded dark:bg-gray-700 w-full mb-4"
                ></div>
                <div
                  class="h-10 bg-gray-200 rounded dark:bg-gray-700 w-full mb-4"
                ></div>
              </div>
            `}
      </div>
    `}};__decorateClass([n({type:Object})],YgBasicTable.prototype,"options",2);YgBasicTable=__decorateClass([t("yg-basic-table")],YgBasicTable);export{YgBasicTable as Y};
