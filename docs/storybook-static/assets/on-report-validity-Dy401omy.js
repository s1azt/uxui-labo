import"./lit-element-C4bBeaiV.js";import{i as h}from"./element-internals-CBp_Vcyn.js";/**
 * @license
 * Copyright 2023 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const f=Symbol("onReportValidity"),l=Symbol("privateCleanupFormListeners"),d=Symbol("privateDoNotReportInvalid"),u=Symbol("privateIsSelfReportingValidity"),c=Symbol("privateCallOnReportValidity");function v(e){var r,i,s;class n extends e{constructor(...t){super(...t),this[s]=new AbortController,this[i]=!1,this[r]=!1,this.addEventListener("invalid",o=>{this[d]||!o.isTrusted||this.addEventListener("invalid",()=>{this[c](o)},{once:!0})},{capture:!0})}checkValidity(){this[d]=!0;const t=super.checkValidity();return this[d]=!1,t}reportValidity(){this[u]=!0;const t=super.reportValidity();return t&&this[c](null),this[u]=!1,t}[(s=l,i=d,r=u,c)](t){const o=t==null?void 0:t.defaultPrevented;o||(this[f](t),!(!o&&(t==null?void 0:t.defaultPrevented)))||(this[u]||y(this[h].form,this))&&this.focus()}[f](t){throw new Error("Implement [onReportValidity]")}formAssociatedCallback(t){super.formAssociatedCallback&&super.formAssociatedCallback(t),this[l].abort(),t&&(this[l]=new AbortController,m(this,t,()=>{this[c](null)},this[l].signal))}}return n}function m(e,r,i,s){const n=b(r);let a=!1,t,o=!1;n.addEventListener("before",()=>{o=!0,t=new AbortController,a=!1,e.addEventListener("invalid",()=>{a=!0},{signal:t.signal})},{signal:s}),n.addEventListener("after",()=>{o=!1,t==null||t.abort(),!a&&i()},{signal:s}),r.addEventListener("submit",()=>{o||i()},{signal:s})}const p=new WeakMap;function b(e){if(!p.has(e)){const r=new EventTarget;p.set(e,r);for(const i of["reportValidity","requestSubmit"]){const s=e[i];e[i]=function(){r.dispatchEvent(new Event("before"));const n=Reflect.apply(s,this,arguments);return r.dispatchEvent(new Event("after")),n}}}return p.get(e)}function y(e,r){if(!e)return!0;let i;for(const s of e.elements)if(s.matches(":invalid")){i=s;break}return i===r}export{v as m,f as o};
